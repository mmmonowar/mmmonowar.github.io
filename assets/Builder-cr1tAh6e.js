import{c as ke,r as P,B as de,i as fr,e as pr,g as Le,b as $e,j as e,X as Ye,S as wt,Y as ua,L as Cr,R as bt,a as ha,T as _t,d as fa,G as pa,M as ma,n as Tt,f as mr,h as gr,C as ga,A as Ze,m as Ee,k as kt,l as ba,o as br,p as xa,q as xr,s as Ft,t as ya,u as $t,v as va,w as wa,x as ka,y as ja,z as Ve,D as Ir,E as Fe,F as lt,H as Sa,I as _a,J as Na,K as Ca,N as Ia,O as Aa,P as yr,Q as Ot,U as Ea,V as vr,W as Ra,Z as za,_ as Ta,$ as Oa}from"./index-NW-pZK92.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],La=ke("beaker",Da);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ht=ke("circle-alert",Ua);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xt=ke("circle-check-big",Ma);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Fa=ke("circle-check",Pa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ba=ke("circle",$a);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ga=ke("copy",Ha);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],wr=ke("database",Wa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Dt=ke("download",Ya);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Za=ke("external-link",Va);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Xa=ke("file-down",Ka);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],qa=ke("folder-open",Ja);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],en=ke("grid-3x3",Qa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],rn=ke("image",tn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],nn=ke("list",an);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],on=ke("map-pin",sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ar=ke("minus",ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Er=ke("palette",cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],un=ke("panels-top-left",dn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xe=ke("plus",hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],pn=ke("rectangle-horizontal",fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],gn=ke("save",mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rr=ke("settings",bn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],zr=ke("share-2",xn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],yt=ke("sparkles",yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Tr=ke("square",vn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],kn=ke("sun",wn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Or=ke("triangle-alert",jn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],_n=ke("type",Sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ut=ke("upload",Nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],In=ke("user",Cn),An=({profile:$,addBlock:B,editingBlock:t,updateBlock:v,onDelete:y,closeEdit:l,isOpen:n})=>{var H,L,Z,F;const[s,i]=P.useState(!1),[u,m]=P.useState(null),h=R=>{var k;const X=(k=R.target.files)==null?void 0:k[0];if(X&&t){const U=new FileReader;U.onloadend=()=>{v({...t,imageUrl:U.result})},U.readAsDataURL(X)}},g=(t==null?void 0:t.type)===de.SOCIAL&&!!(t.channelId&&t.channelId.length>0),o=(t==null?void 0:t.type)===de.SOCIAL?t.socialPlatform??fr(t.content)??"x":void 0,p=(t==null?void 0:t.type)===de.SOCIAL?t.socialHandle??pr(o,t.content)??"":"",c=Le(o),f=$e(o,p),d=async()=>{var X;const R=t==null?void 0:t.channelId;if(R){i(!0),m(null);try{const k=`https://www.youtube.com/feeds/videos.xml?channel_id=${R}`,U=`https://api.allorigins.win/raw?url=${encodeURIComponent(k)}`,a=await fetch(U);if(!a.ok)throw new Error("Network error");const _=await a.text(),C=new DOMParser().parseFromString(_,"text/xml"),re=Array.from(C.querySelectorAll("entry")),G=(X=C.querySelector("author > name"))==null?void 0:X.textContent;if(re.length>0&&t){const q=re.slice(0,4).map(T=>{var ee,ue;const ae=((ee=T.getElementsByTagName("yt:videoId")[0])==null?void 0:ee.textContent)||"",ne=((ue=T.getElementsByTagName("title")[0])==null?void 0:ue.textContent)||"";return{id:ae,title:ne,thumbnail:`https://img.youtube.com/vi/${ae}/mqdefault.jpg`}}),z=q[0];v({...t,youtubeVideoId:z.id,youtubeVideos:q,content:`https://www.youtube.com/watch?v=${z.id}`,title:G||t.title,subtext:z.title,channelTitle:G||""})}else m("No videos found.")}catch(k){console.error(k),m("Failed to fetch. Check ID.")}finally{i(!1)}}},x=(R,X,k,U)=>{var q,z;if(!t)return{};const a=(q=Le(R))==null?void 0:q.label,_=(z=Le(k))==null?void 0:z.label,S=mr(R,X),C=mr(k,U),re=!t.title||t.title==="Social"||a&&t.title===a?_??t.title:t.title,G=(!t.subtext||S&&t.subtext===S)&&C||t.subtext;return{title:re,subtext:G}},j=R=>{var q,z;if(!t||t.type!==de.SOCIAL)return;const X=o,k=p,U=(q=Le(X))==null?void 0:q.kind,a=(z=Le(R))==null?void 0:z.kind,S=Tt(R,U!==a?"":k),C=$e(R,S),{title:re,subtext:G}=x(X,k,R,S);v({...t,socialPlatform:R,socialHandle:S,content:C,title:re,subtext:G,channelId:void 0,youtubeVideoId:void 0,youtubeVideos:void 0,youtubeMode:void 0,channelTitle:void 0})},I=R=>{if(!t||t.type!==de.SOCIAL)return;if(/^https?:\/\//i.test(R.trim())){const S=fr(R)??"custom",C=pr(S,R),re=Tt(S,C??R),G=C?$e(S,re):$e("custom",R),{title:q,subtext:z}=x(o,p,S,re);v({...t,socialPlatform:S,socialHandle:re,content:G,title:q,subtext:z,channelId:void 0,youtubeVideoId:void 0,youtubeVideos:void 0,youtubeMode:void 0,channelTitle:void 0});return}const X=o??"x",k=Tt(X,R),U=$e(X,k),{title:a,subtext:_}=x(X,p,X,k);v({...t,socialPlatform:X,socialHandle:k,content:U,title:a,subtext:_,channelId:void 0,youtubeVideoId:void 0,youtubeVideos:void 0,youtubeMode:void 0,channelTitle:void 0})},N=R=>t?t.customBackground?t.customBackground===R.hex:t.color===R.bg:!1;return e.jsxs("aside",{role:"complementary","aria-label":"Block editor sidebar",className:`fixed right-0 top-0 h-screen w-full md:w-[400px] bg-white z-50 shadow-xl transform transition-transform duration-500 ease-[cubic-bezier(0.25,1,0.5,1)] flex flex-col border-l border-gray-200
	        ${n?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-white sticky top-0 z-20",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-base text-gray-900 tracking-tight",children:t?"Edit Block":"Edit"}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:t?"Customize your block":"Build your layout"})]}),e.jsx("button",{type:"button","aria-label":"Close sidebar",onClick:l,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors text-gray-400 hover:text-gray-600",children:e.jsx(Ye,{size:18})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-7 no-scrollbar pb-20",children:t?e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"space-y-5",children:[t.type!==de.SPACER&&t.type!==de.SOCIAL_ICON&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"block-title-input",className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Title"}),e.jsx("input",{id:"block-title-input",type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium",value:t.title||"",onChange:R=>v({...t,title:R.target.value}),placeholder:"Label your block"})]}),t.type===de.SOCIAL_ICON&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1.5",children:"Platform"}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5 max-h-40 overflow-y-auto",children:wt.map(R=>{const X=R.id===t.socialPlatform,k=R.brandIcon,U=R.icon;return e.jsxs("button",{type:"button",onClick:()=>v({...t,socialPlatform:R.id}),className:`p-1.5 rounded-lg border transition-all flex flex-col items-center gap-0.5 ${X?"bg-violet-600 text-white border-violet-600 shadow-sm":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,title:R.label,children:[k?e.jsx("span",{style:{color:X?"#ffffff":R.brandColor},children:e.jsx(k,{size:14})}):e.jsx("span",{className:X?"text-white":"text-gray-500",children:e.jsx(U,{size:14})}),e.jsx("span",{className:"text-[8px] font-medium leading-tight truncate w-full text-center",children:R.label})]},R.id)})})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"social-icon-handle-input",className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1",children:((H=Le(t.socialPlatform))==null?void 0:H.kind)==="url"?"URL":"Handle"}),e.jsx("input",{id:"social-icon-handle-input",type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded-lg px-2.5 py-2 text-sm focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 focus:outline-none transition-all font-medium text-gray-600",value:t.socialHandle||"",onChange:R=>v({...t,socialHandle:R.target.value}),placeholder:((L=Le(t.socialPlatform))==null?void 0:L.placeholder)??"yourhandle"})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1.5",children:"Icon Style"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button","aria-label":"Set icon color to brand color","aria-pressed":t.textColor==="text-brand",onClick:()=>v({...t,textColor:"text-brand"}),className:`flex-1 py-2 px-3 rounded-lg border text-xs font-semibold transition-all flex items-center justify-center gap-2 ${!t.textColor||t.textColor==="text-brand"?"bg-violet-600 text-white border-violet-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{background:((Z=Le(t.socialPlatform))==null?void 0:Z.brandColor)||"#6366f1"}}),"Color"]}),e.jsxs("button",{type:"button","aria-label":"Set icon color to Grey","aria-pressed":t.textColor==="text-gray-700",onClick:()=>v({...t,textColor:"text-gray-700"}),className:`flex-1 py-2 px-3 rounded-lg border text-xs font-semibold transition-all flex items-center justify-center gap-2 ${t.textColor==="text-gray-700"?"bg-gray-800 text-white border-gray-800":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-gray-500"}),"Grey"]}),e.jsxs("button",{type:"button","aria-label":"Set icon color to Black","aria-pressed":t.textColor==="text-black",onClick:()=>v({...t,textColor:"text-black"}),className:`flex-1 py-2 px-3 rounded-lg border text-xs font-semibold transition-all flex items-center justify-center gap-2 ${t.textColor==="text-black"?"bg-black text-white border-black":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-black"}),"Black"]})]})]}),t.socialHandle&&$e(t.socialPlatform,t.socialHandle)&&e.jsxs("div",{className:"bg-violet-50 border border-violet-200 rounded-lg p-2",children:[e.jsx("p",{className:"text-[9px] font-bold text-violet-400 uppercase tracking-wider mb-0.5",children:"Preview"}),e.jsx("a",{href:$e(t.socialPlatform,t.socialHandle),target:"_blank",rel:"noreferrer",className:"text-[11px] font-medium text-violet-700 hover:text-violet-900 break-all underline",children:$e(t.socialPlatform,t.socialHandle)})]})]}),t.type===de.SOCIAL&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-1 bg-gray-100 rounded-xl flex",children:[e.jsx("button",{type:"button","aria-pressed":!g,className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all ${g?"text-gray-500 hover:text-gray-900":"bg-white shadow text-gray-900"}`,onClick:()=>v({...t,channelId:void 0,youtubeVideoId:void 0,youtubeVideos:void 0,youtubeMode:void 0,channelTitle:void 0}),children:"Platforms"}),e.jsxs("button",{type:"button","aria-pressed":g,className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1 ${g?"bg-red-500 shadow text-white":"text-gray-500 hover:text-red-600"}`,onClick:()=>v({...t,socialPlatform:"youtube",channelId:t.channelId||"UCRlsJWh1XwmNGxZPFgJ0Zlw",youtubeMode:t.youtubeMode||"single"}),children:[e.jsx(ua,{size:14})," YouTube"]})]}),!g&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Platform"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:wt.map(R=>{const X=R.id===o;return e.jsxs("button",{type:"button","aria-label":R.label,"aria-pressed":X,onClick:()=>j(R.id),className:`p-3 rounded-2xl border text-left transition-all flex items-center gap-2 ${X?"bg-gray-900 text-white border-gray-900 shadow-md":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,title:R.label,children:[e.jsx(R.icon,{size:16,className:X?"text-white":"text-gray-500"}),e.jsx("span",{className:"text-[11px] font-semibold leading-tight truncate",children:R.label})]},R.id)})})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"social-block-handle-input",className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:(c==null?void 0:c.kind)==="url"?"URL":"Username / Handle"}),e.jsx("input",{id:"social-block-handle-input",type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium text-gray-600",value:p,onChange:R=>I(R.target.value),placeholder:(c==null?void 0:c.placeholder)??"yourhandle"})]}),f&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Resolved Link"}),e.jsx("a",{href:f,target:"_blank",rel:"noreferrer",className:"text-xs font-semibold text-gray-700 hover:text-black break-all underline",children:f})]}),e.jsx("div",{children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Icon Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button","aria-pressed":t.textColor==="text-brand",onClick:()=>v({...t,textColor:"text-brand"}),className:`flex-1 py-2 px-3 rounded-lg border text-xs font-semibold transition-all flex items-center justify-center gap-2 ${t.textColor==="text-brand"?"bg-violet-600 text-white border-violet-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{background:((F=Le(t.socialPlatform))==null?void 0:F.brandColor)||"#6366f1"}}),"Color"]}),e.jsxs("button",{type:"button","aria-pressed":t.textColor===void 0,onClick:()=>v({...t,textColor:void 0}),className:`flex-1 py-2 px-3 rounded-lg border text-xs font-semibold transition-all flex items-center justify-center gap-2 ${!t.textColor||t.textColor==="text-black"?"bg-gray-800 text-white border-gray-800":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-gray-600"}),"Default"]})]})]})})]})]}),g&&e.jsxs("div",{className:"p-5 bg-red-50 rounded-2xl border border-red-100 space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"youtube-channel-id-input",className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 flex justify-between",children:["Channel ID",e.jsxs("a",{href:"https://commentpicker.com/youtube-channel-id.php",target:"_blank",rel:"noreferrer",className:"text-[10px] text-red-500 underline flex items-center",children:["Find ID ",e.jsx(Za,{size:8,className:"ml-1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"youtube-channel-id-input",type:"text",className:"w-full bg-white border border-gray-200 rounded-xl p-3 focus:ring-2 focus:ring-red-500/20 focus:outline-none text-sm placeholder-gray-400 font-mono",value:t.channelId||"",onChange:R=>v({...t,channelId:R.target.value}),placeholder:"UC..."}),e.jsx("button",{type:"button","aria-label":"Fetch latest videos",onClick:d,disabled:s||!t.channelId,className:"bg-red-500 text-white px-4 rounded-xl font-bold text-xs hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center min-w-[44px]",title:"Fetch latest videos",children:s?e.jsx(Cr,{size:18,className:"animate-spin"}):e.jsx(bt,{size:18})})]}),u&&e.jsx("p",{className:"text-red-500 text-xs mt-2 font-medium",children:u})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Video Layout"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{type:"button","aria-pressed":t.youtubeMode==="single",onClick:()=>v({...t,youtubeMode:"single",colSpan:3,rowSpan:3}),className:`p-2 rounded-xl text-xs font-medium border flex flex-col items-center justify-center gap-2 h-20 transition-all ${t.youtubeMode==="single"||!t.youtubeMode?"bg-red-500 text-white border-red-500 shadow-md ring-2 ring-red-200":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(Tr,{size:20})," Single"]}),e.jsxs("button",{type:"button","aria-pressed":t.youtubeMode==="grid",onClick:()=>v({...t,youtubeMode:"grid",colSpan:6,rowSpan:6}),className:`p-2 rounded-xl text-xs font-medium border flex flex-col items-center justify-center gap-2 h-20 transition-all ${t.youtubeMode==="grid"?"bg-red-500 text-white border-red-500 shadow-md ring-2 ring-red-200":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(en,{size:20})," Grid"]}),e.jsxs("button",{type:"button","aria-pressed":t.youtubeMode==="list",onClick:()=>v({...t,youtubeMode:"list",colSpan:6,rowSpan:6}),className:`p-2 rounded-xl text-xs font-medium border flex flex-col items-center justify-center gap-2 h-20 transition-all ${t.youtubeMode==="list"?"bg-red-500 text-white border-red-500 shadow-md ring-2 ring-red-200":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx(nn,{size:20})," List"]})]})]})]}),(t.type===de.LINK||t.type===de.MEDIA||t.type===de.MAP)&&e.jsxs("div",{children:[(t.type===de.MEDIA||t.type===de.LINK)&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"block-img-upload",className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:["Upload Image"," ",t.type===de.LINK?"(Optional Background)":""]}),e.jsxs("label",{htmlFor:"block-img-upload",className:"relative group cursor-pointer border-2 border-dashed border-gray-300 rounded-xl p-4 hover:border-black transition-colors block","aria-label":"Upload block image",children:[e.jsx("input",{id:"block-img-upload",type:"file",className:"sr-only",accept:"image/*",onChange:h}),e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-500",children:[e.jsx(ut,{size:20}),e.jsx("span",{className:"text-xs",children:"Click to upload"})]}),t.imageUrl&&e.jsx("div",{className:"mt-2 text-[10px] text-green-600 font-medium text-center",children:"Image Selected"})]})]}),e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:t.type===de.MEDIA?"Media URL / Path":t.type===de.MAP?"Address / City":"Destination URL"}),e.jsx("input",{type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-mono text-xs text-gray-600",value:t.type===de.MEDIA?t.imageUrl||"":t.content||"",onChange:R=>{t.type===de.MEDIA?v({...t,imageUrl:R.target.value}):v({...t,content:R.target.value})},placeholder:t.type===de.MEDIA?"/images/photo.jpg, video.mp4 or URL":"https://..."}),t.type===de.MEDIA&&e.jsx("p",{className:"text-[10px] text-gray-400 mt-1.5",children:"Supports images, GIFs, and videos (.mp4, .webm, .mov)"})]}),(t.type===de.TEXT||t.type===de.LINK||t.type===de.SOCIAL)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:t.type===de.TEXT?"Description":"Subtitle / Details"}),e.jsx("textarea",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium text-gray-600 h-28 resize-none",value:t.type===de.TEXT?t.content||"":t.subtext||"",onChange:R=>{t.type===de.TEXT?v({...t,content:R.target.value}):v({...t,subtext:R.target.value})}})]})]}),t.type!==de.SPACER&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(Er,{size:14})," Background"]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("fieldset",{children:[e.jsx("legend",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1.5",children:"Solid Colors"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:ha.filter(R=>R.type==="solid").map(R=>{const X=N(R);return e.jsx("button",{type:"button","aria-label":`Set background color to ${R.name}`,"aria-pressed":X,onClick:()=>v({...t,color:R.bg,textColor:R.text,customBackground:void 0}),className:`h-10 rounded-full border shadow-sm transition-all transform active:scale-95 ${R.bg} ${X?"ring-2 ring-offset-2 ring-gray-900 scale-110":"hover:scale-105"} flex items-center justify-center`,title:R.name,children:X&&e.jsx(Fa,{size:16,className:R.text==="text-white"?"text-white":"text-black"})},R.name)})})]})})]}),e.jsx("div",{className:"pt-6 border-t border-gray-100",children:e.jsxs("button",{type:"button","aria-label":`Remove block ${t.title}`,onClick:()=>y(t.id),className:"w-full py-3 text-red-500 font-medium hover:bg-red-50 rounded-xl transition-colors flex items-center justify-center gap-2",children:[e.jsx(_t,{size:18})," Remove Block"]})})]}):e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-5 bg-gray-900 rounded-full"}),e.jsx("h3",{className:"text-base font-bold text-gray-900",children:"Design"})]}),e.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-2xl",children:e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Use ",e.jsx("span",{className:"font-semibold",children:"Settings"})," to configure profile, branding, analytics and deploy defaults. Click a block to edit its content, size and colors."]})})]}),e.jsxs("section",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-5 bg-gray-900 rounded-full"}),e.jsx("h3",{className:"text-base font-bold text-gray-900",children:"Add Content"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{type:de.LINK,label:"Link",icon:fa,color:"bg-blue-600"},{type:de.SOCIAL,label:"Social",icon:pa,color:"bg-violet-600"},{type:de.MEDIA,label:"Media",icon:rn,color:"bg-pink-600"},{type:de.TEXT,label:"Note",icon:_n,color:"bg-emerald-600"},{type:de.MAP,label:"Map",icon:on,color:"bg-amber-500"},{type:de.SPACER,label:"Spacer",icon:ma,color:"bg-gray-600"}].map(R=>e.jsxs("button",{type:"button","aria-label":`Add ${R.label} Block`,onClick:()=>B(R.type),className:"flex flex-col items-center gap-2 p-4 bg-white border border-gray-100 rounded-2xl hover:border-gray-200 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl ${R.color} text-white flex items-center justify-center shadow-sm transition-colors`,children:e.jsx(R.icon,{size:18})}),e.jsx("span",{className:"text-xs font-semibold text-gray-600",children:R.label})]},R.type))})]})]})}),$.showBranding!==!1&&e.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:e.jsx("p",{className:"text-xs text-center text-gray-400 font-medium",children:"OpenBento • Open Source"})})]})},En=({activeBentoId:$,activeBentoName:B,onBentoChange:t})=>{const[v,y]=P.useState(!1),[l,n]=P.useState([]),[s,i]=P.useState(!1),[u,m]=P.useState(""),h=P.useRef(null),g=P.useRef(null);P.useEffect(()=>{v&&n(gr())},[v]),P.useEffect(()=>{s&&g.current&&g.current.focus()},[s]),P.useEffect(()=>{const d=x=>{h.current&&!h.current.contains(x.target)&&(y(!1),i(!1),m(""))};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const o=()=>{if(u.trim()){const d=br(u.trim());t(d),i(!1),m(""),y(!1)}},p=d=>{d.key==="Enter"?o():d.key==="Escape"&&(i(!1),m(""))},c=(d,x)=>{d.stopPropagation();const j=l.find(H=>H.id===x);if(!j||!window.confirm(`Delete "${j.name}"? This cannot be undone.`))return;ba(x);const N=gr();if(n(N),x===$&&N.length>0)t(N[0]);else if(N.length===0){const H=br("My Bento");t(H),y(!1)}},f=d=>new Date(d).toLocaleDateString("en-US",{day:"numeric",month:"short"});return e.jsxs("div",{ref:h,className:"relative",children:[e.jsxs("button",{type:"button","aria-label":"Open bento projects menu","aria-expanded":v,"aria-haspopup":"menu",onClick:()=>y(!v),className:"flex items-center gap-2 px-3 py-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors text-sm font-medium text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(qa,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"max-w-[120px] truncate",children:B}),e.jsx(ga,{size:16,className:`text-gray-400 transition-transform duration-200 ${v?"rotate-180":""}`})]}),e.jsx(Ze,{children:v&&e.jsxs(Ee.div,{role:"menu","aria-label":"Bento projects menu",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.15},className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden z-50",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 bg-gray-50",children:e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"My Bentos"})}),e.jsx("div",{className:"max-h-[240px] overflow-y-auto",children:l.length===0?e.jsx("div",{className:"px-4 py-6 text-center text-gray-400 text-sm",children:"No bentos yet"}):l.map(d=>e.jsxs("div",{className:`group w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-50 transition-colors ${d.id===$?"bg-blue-50":""}`,children:[e.jsxs("button",{type:"button",role:"menuitem","aria-label":`Switch to ${d.name} project`,"aria-current":d.id===$?"true":void 0,onClick:()=>{t(d),y(!1)},className:"flex-1 flex items-center gap-3 text-left min-w-0 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-lg",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold shrink-0 ${d.id===$?"bg-blue-500 text-white":"bg-gray-100 text-gray-600"}`,children:d.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${d.id===$?"text-blue-600":"text-gray-900"}`,children:d.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Updated ",f(d.updatedAt)]})]}),d.id===$&&e.jsx(kt,{size:16,className:"text-blue-500 shrink-0"})]}),e.jsx("button",{type:"button","aria-label":`Delete ${d.name} project`,onClick:x=>c(x,d.id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg opacity-0 group-hover:opacity-100 focus:opacity-100 transition-all shrink-0 focus:outline-none focus:ring-2 focus:ring-red-500",title:"Delete bento",children:e.jsx(_t,{size:14})})]},d.id))}),e.jsx("div",{className:"border-t border-gray-100",children:s?e.jsxs("div",{className:"p-3",children:[e.jsx("input",{ref:g,type:"text","aria-label":"New bento project name",value:u,onChange:d=>m(d.target.value),onKeyDown:p,placeholder:"Bento name...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{type:"button","aria-label":"Create new bento project",onClick:o,disabled:!u.trim(),className:"flex-1 px-3 py-1.5 bg-blue-500 text-white text-sm font-medium rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Create"}),e.jsx("button",{type:"button","aria-label":"Cancel creating new bento",onClick:()=>{i(!1),m("")},className:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"})]})]}):e.jsxs("button",{type:"button",role:"menuitem","aria-label":"Create new bento project",onClick:()=>i(!0),className:"w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-50 transition-colors text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-900 flex items-center justify-center",children:e.jsx(Xe,{size:16,className:"text-white"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"New Bento"})]})})]})})]})},He=320,rt=512,pt=1,mt=3,at=.05,ct=($,B,t)=>Math.min(t,Math.max(B,$)),Dr=({isOpen:$,src:B,title:t,onCancel:v,onConfirm:y})=>{const l=P.useRef(null),n=P.useRef(null),s=P.useRef(null),i=P.useRef(null),u=P.useRef(null),[m,h]=P.useState(1),[g,o]=P.useState({x:0,y:0}),[p,c]=P.useState(null),[f,d]=P.useState(null);P.useEffect(()=>{$&&(h(1),o({x:0,y:0}),c(null),d(null),l.current=null,s.current=null,i.current=null,u.current=null)},[$,B]),P.useEffect(()=>{if(!$||!B)return;let a=!1;const _=new Image,S=()=>{a||(l.current=_,c({w:_.naturalWidth,h:_.naturalHeight}))};return _.onload=S,_.onerror=()=>{a||d("Failed to load this image. Try another file.")},_.src=B,typeof _.decode=="function"&&_.decode().then(S).catch(()=>{}),()=>{a=!0}},[$,B]);const j=P.useMemo(()=>p?Math.max(He/p.w,He/p.h):1,[p])*m,I=P.useMemo(()=>p?{w:p.w*j,h:p.h*j}:{w:0,h:0},[p,j]),N=P.useCallback(a=>{if(!p)return{x:0,y:0};const _=Math.max(0,(I.w-He)/2),S=Math.max(0,(I.h-He)/2);return{x:ct(a.x,-_,_),y:ct(a.y,-S,S)}},[I.w,I.h,p]);P.useEffect(()=>{p&&o(a=>N(a))},[p,m,N]),P.useEffect(()=>{if(!$||!p)return;const a=_=>{const S=_.shiftKey?24:10;if(_.key==="ArrowLeft"){_.preventDefault(),o(C=>N({x:C.x-S,y:C.y}));return}if(_.key==="ArrowRight"){_.preventDefault(),o(C=>N({x:C.x+S,y:C.y}));return}if(_.key==="ArrowUp"){_.preventDefault(),o(C=>N({x:C.x,y:C.y-S}));return}if(_.key==="ArrowDown"){_.preventDefault(),o(C=>N({x:C.x,y:C.y+S}));return}if(_.key==="+"||_.key==="="){_.preventDefault(),h(C=>ct(Math.round((C+at)*100)/100,pt,mt));return}if(_.key==="-"||_.key==="_"){_.preventDefault(),h(C=>ct(Math.round((C-at)*100)/100,pt,mt));return}_.key==="0"&&(_.preventDefault(),h(1),o({x:0,y:0}))};return window.addEventListener("keydown",a,{passive:!1}),()=>window.removeEventListener("keydown",a)},[N,$,p]);const H=a=>{if(!p)return;a.preventDefault(),a.currentTarget.setPointerCapture(a.pointerId),s.current={pointerId:a.pointerId,startX:a.clientX,startY:a.clientY,originX:g.x,originY:g.y}},L=a=>{const _=s.current;if(!_||_.pointerId!==a.pointerId)return;a.preventDefault();const S=a.clientX-_.startX,C=a.clientY-_.startY;o(N({x:_.originX+S,y:_.originY+C}))},Z=a=>{const _=s.current;!_||_.pointerId!==a.pointerId||(s.current=null)},F=a=>{s.current||p&&(a.preventDefault(),i.current={startX:a.clientX,startY:a.clientY,originX:g.x,originY:g.y})},R=a=>{if(s.current||!p)return;const _=a.changedTouches[0];_&&(a.preventDefault(),u.current={id:_.identifier,startX:_.clientX,startY:_.clientY,originX:g.x,originY:g.y})};P.useEffect(()=>{if(!$)return;const a=re=>{const G=i.current;G&&o(N({x:G.originX+(re.clientX-G.startX),y:G.originY+(re.clientY-G.startY)}))},_=()=>{i.current=null},S=re=>{const G=u.current;if(!G)return;const q=Array.from(re.changedTouches).find(z=>z.identifier===G.id);q&&(re.preventDefault(),o(N({x:G.originX+(q.clientX-G.startX),y:G.originY+(q.clientY-G.startY)})))},C=re=>{const G=u.current;!G||!Array.from(re.changedTouches).some(z=>z.identifier===G.id)||(u.current=null)};return window.addEventListener("mousemove",a),window.addEventListener("mouseup",_),window.addEventListener("touchmove",S,{passive:!1}),window.addEventListener("touchend",C),window.addEventListener("touchcancel",C),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",_),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",C),window.removeEventListener("touchcancel",C)}},[N,$]);const X=a=>{h(_=>ct(Math.round((_+a)*100)/100,pt,mt))},k=a=>{a.preventDefault();const _=a.deltaY>0?-at:at;X(_)},U=()=>{const a=l.current||n.current;if(!a||!p)return;const _=document.createElement("canvas");_.width=rt,_.height=rt;const S=_.getContext("2d");if(!S)return;const C=He/2-I.w/2+g.x,re=He/2-I.h/2+g.y,G=-C/j,q=-re/j,z=He/j,T=He/j;S.fillStyle="#ffffff",S.fillRect(0,0,rt,rt),S.imageSmoothingEnabled=!0,S.imageSmoothingQuality="high",S.drawImage(a,G,q,z,T,0,0,rt,rt);const ae=_.toDataURL("image/jpeg",.92);y(ae)};return typeof document>"u"?null:xa.createPortal(e.jsx(Ze,{children:$&&e.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[90] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs(Ee.div,{initial:{scale:.95,opacity:0,y:16},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:16},className:"bg-white rounded-3xl shadow-2xl max-w-xl w-full overflow-hidden ring-1 ring-gray-900/5",role:"dialog","aria-modal":"true","aria-label":t||"Crop image",children:[e.jsxs("div",{className:"p-6 pb-4 flex justify-between items-start border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t||"Crop photo"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Drag to position, use zoom to crop."})]}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors","aria-label":"Close crop",children:e.jsx(Ye,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsx("div",{className:"flex items-start justify-center",children:e.jsx("div",{className:"relative bg-gray-100 border border-gray-200 rounded-3xl overflow-hidden cursor-grab active:cursor-grabbing",style:{width:He,height:He,touchAction:"none"},onPointerDown:H,onPointerMove:L,onPointerUp:Z,onPointerCancel:Z,onMouseDown:F,onTouchStart:R,onWheel:k,onDoubleClick:()=>{h(1),o({x:0,y:0})},children:f?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-6 text-center text-sm text-red-700",children:f}):p?e.jsx("img",{ref:n,src:B,alt:"Crop source",draggable:!1,className:"absolute left-1/2 top-1/2 select-none pointer-events-none",style:{width:`${I.w}px`,height:`${I.h}px`,maxWidth:"none",maxHeight:"none",transform:`translate(-50%, -50%) translate(${g.x}px, ${g.y}px)`,transformOrigin:"center"}}):e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-6 text-center text-sm text-gray-500",children:"Loading…"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Zoom"}),e.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[Math.round(m*100),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>X(-at),className:"w-10 h-10 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 transition-colors flex items-center justify-center text-gray-700","aria-label":"Zoom out",children:e.jsx(Ar,{size:16})}),e.jsx("input",{type:"range",min:pt,max:mt,step:.01,value:m,onChange:a=>h(Number(a.target.value)),className:"flex-1"}),e.jsx("button",{type:"button",onClick:()=>X(at),className:"w-10 h-10 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 transition-colors flex items-center justify-center text-gray-700","aria-label":"Zoom in",children:e.jsx(Xe,{size:16})})]}),e.jsx("p",{className:"text-[11px] text-gray-400",children:"Tip: drag to move · double-click to reset · arrows to nudge (Shift for faster)"})]})]}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:v,className:"w-full sm:flex-1 py-3.5 bg-white text-gray-900 rounded-2xl font-bold border border-gray-200 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:U,disabled:!p||!!f,className:"w-full sm:flex-1 py-3.5 bg-gray-900 text-white rounded-2xl font-bold hover:bg-black transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:"Use photo"})]})})]})})}),document.body)},Rn=({isOpen:$,onClose:B,profile:t,setProfile:v,bentoName:y,onBentoNameChange:l,blocks:n,onBlocksChange:s})=>{var ye,xe,Se,Te,Ae,r,W,M,w,b,A,V,K,D,Q,oe,te,ce;const i=P.useRef(null),[u,m]=P.useState(null),[h,g]=P.useState("general"),[o,p]=P.useState(!1),[c,f]=P.useState("instagram"),[d,x]=P.useState(""),[j,I]=P.useState(""),[N,H]=P.useState(null),[L,Z]=P.useState(""),[F,R]=P.useState(""),[X,k]=P.useState(""),[U,a]=P.useState(!1),[_,S]=P.useState(null),[C,re]=P.useState(null);P.useEffect(()=>{$&&h==="analytics"&&fetch("/__openbento/config").then(O=>O.json()).then(O=>{var J;O.ok&&O.config&&(re(O.config),Z(O.config.projectUrl||""),k(O.config.anonKey||""),O.config.projectUrl&&!((J=t.analytics)!=null&&J.supabaseUrl)&&v({...t,analytics:{...t.analytics,enabled:!0,supabaseUrl:O.config.projectUrl,anonKey:O.config.anonKey}}))}).catch(()=>{})},[$,h,t,v]);const G=async()=>{a(!0),S(null);try{const J=await(await fetch("/__openbento/supabase/simple-setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectUrl:L,dbPassword:F,anonKey:X})})).json();J.ok?(S({ok:!0,message:"Database setup complete!",logs:J.logs}),re(J.config),R(""),v({...t,analytics:{enabled:!0,supabaseUrl:L,anonKey:X}})):S({ok:!1,message:J.error||"Setup failed",logs:J.logs})}catch(O){S({ok:!1,message:"Network error: "+O.message})}finally{a(!1)}},q=t.socialAccounts||[];P.useEffect(()=>{$&&h==="json"&&(I(JSON.stringify({name:y||"My Bento",profile:t,blocks:n||[]},null,2)),H(null))},[$,h,t,n,y]);const z=()=>{if(!d.trim())return;const O=q.some(J=>J.platform===c);v(O?{...t,socialAccounts:q.map(J=>J.platform===c?{...J,handle:d.trim()}:J)}:{...t,socialAccounts:[...q,{platform:c,handle:d.trim()}]}),x(""),p(!1)},T=O=>{v({...t,socialAccounts:q.filter(J=>J.platform!==O)})},ae=(O,J)=>{v({...t,socialAccounts:q.map(be=>be.platform===O?{...be,handle:J}:be)})},ne=(O,J)=>{const be=J?parseInt(J.replace(/\D/g,""),10):void 0;v({...t,socialAccounts:q.map(Ne=>Ne.platform===O?{...Ne,followerCount:be}:Ne)})},ee=O=>{var Ne;const J=(Ne=O.target.files)==null?void 0:Ne[0];if(!J)return;const be=new FileReader;be.onloadend=()=>{const ze=typeof be.result=="string"?be.result:null;ze&&m(ze)},be.readAsDataURL(J);try{O.target.value=""}catch{}},ue=()=>v({...t,avatarUrl:xr}),Ce=()=>{try{const O=JSON.parse(j);if(!O.profile||!Array.isArray(O.blocks)){H('Invalid structure: must have "profile" and "blocks"');return}O.name&&l&&l(O.name),v(O.profile),s&&s(O.blocks),H(null)}catch(O){H(`JSON Parse Error: ${O.message}`)}},he=[{id:"general",label:"General",icon:e.jsx(In,{size:16})},{id:"social",label:"Social",icon:e.jsx(zr,{size:16})},{id:"seo",label:"SEO & Social Sharing",icon:e.jsx(ya,{size:16})},{id:"analytics",label:"Analytics",icon:e.jsx($t,{size:16})},{id:"json",label:"Raw JSON",icon:e.jsx(va,{size:16})}];return e.jsx(Ze,{children:$&&e.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:[e.jsxs(Ee.div,{initial:{scale:.95,opacity:0,y:16},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:16},className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden ring-1 ring-gray-900/5",role:"dialog","aria-modal":"true","aria-label":"Settings",children:[e.jsxs("div",{className:"p-6 pb-4 flex justify-between items-start border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-9 h-9 bg-gray-900 rounded-full flex items-center justify-center text-white mb-3",children:e.jsx(Rr,{size:18})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Profile, social accounts, and configuration."})]}),e.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors","aria-label":"Close settings",children:e.jsx(Ye,{size:20})})]}),e.jsx("div",{className:"px-6 pt-4 flex gap-1 border-b border-gray-100",children:he.map(O=>e.jsxs("button",{type:"button",role:"tab","aria-selected":h===O.id,"aria-controls":`${O.id}-panel`,onClick:()=>g(O.id),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium rounded-t-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${h===O.id?"bg-gray-100 text-gray-900 border-b-2 border-gray-900 -mb-[2px]":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[O.icon,O.label]},O.id))}),e.jsxs("div",{className:"p-6 pt-4 space-y-6 max-h-[60vh] overflow-y-auto",children:[h==="general"&&e.jsxs(e.Fragment,{children:[l&&e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Bento"}),e.jsxs("div",{className:"p-3 bg-white border border-gray-200 rounded-xl",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1.5",children:"Project Name"}),e.jsx("input",{type:"text","aria-label":"Project name",value:y||"",onChange:O=>l(O.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm font-medium text-gray-800 focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 focus:outline-none transition-all",placeholder:"My Bento"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1.5",children:"Used as filename when exporting JSON"})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Profile"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"shrink-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden bg-gray-100 ring-2 ring-white shadow-lg",children:e.jsx("img",{src:t.avatarUrl||xr,alt:"Avatar",className:"w-full h-full object-cover"})}),e.jsx("input",{ref:i,type:"file",className:"hidden",accept:"image/*",onChange:ee}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("button",{type:"button","aria-label":"Upload avatar image",onClick:()=>{var O;return(O=i.current)==null?void 0:O.click()},className:"px-3 py-2 rounded-xl bg-white border border-gray-200 text-xs font-bold text-gray-700 hover:bg-gray-50 transition-colors inline-flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(ut,{size:14}),"Upload"]}),e.jsx("button",{type:"button","aria-label":"Reset avatar to default",onClick:ue,className:"px-3 py-2 rounded-xl bg-gray-50 border border-gray-200 text-xs font-bold text-gray-700 hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Reset"})]})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Name"}),e.jsx("input",{type:"text","aria-label":"Your name",value:t.name,onChange:O=>v({...t,name:O.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-semibold text-gray-800",placeholder:"Your name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Avatar URL"}),e.jsx("input",{type:"text","aria-label":"Avatar URL",value:t.avatarUrl||"",onChange:O=>v({...t,avatarUrl:O.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-mono text-xs text-gray-700",placeholder:"/images/avatar.jpg or https://..."}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Enter a path or URL instead of uploading to avoid base64 encoding"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Bio"}),e.jsx("textarea",{"aria-label":"Bio",value:t.bio,onChange:O=>v({...t,bio:O.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium text-gray-700 h-24 resize-none",placeholder:"A short bio…"})]})]})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Branding"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-white border border-gray-200 rounded-xl",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Show OpenBento credit"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Displays the OpenBento footer in the builder and export."})]}),e.jsx("button",{type:"button",onClick:()=>v({...t,showBranding:t.showBranding===!1}),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors ${t.showBranding!==!1?"bg-gray-900":"bg-gray-200"}`,"aria-pressed":t.showBranding!==!1,"aria-label":"Toggle OpenBento branding",children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${t.showBranding!==!1?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-white border border-gray-200 rounded-xl",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Social icons in header"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Display your social icons under your name and bio."})]}),e.jsx("button",{type:"button",onClick:()=>v({...t,showSocialInHeader:!t.showSocialInHeader}),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors ${t.showSocialInHeader?"bg-gray-900":"bg-gray-200"}`,"aria-pressed":t.showSocialInHeader,"aria-label":"Toggle social icons in header",children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${t.showSocialInHeader?"translate-x-6":"translate-x-1"}`})})]}),t.showSocialInHeader&&e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-white border border-gray-200 rounded-xl ml-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Show follower count"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Display follower numbers next to icons (e.g., 220k)."})]}),e.jsx("button",{type:"button",onClick:()=>v({...t,showFollowerCount:!t.showFollowerCount}),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors ${t.showFollowerCount?"bg-gray-900":"bg-gray-200"}`,"aria-pressed":t.showFollowerCount,"aria-label":"Toggle follower count",children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${t.showFollowerCount?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Background"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Background Color"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"color","aria-label":"Background color picker",value:t.backgroundColor||"#F7F7F7",onChange:O=>v({...t,backgroundColor:O.target.value,backgroundImage:void 0}),className:"w-12 h-12 rounded-xl border-2 border-gray-200 cursor-pointer hover:border-violet-400 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Open color picker"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400 font-mono",children:"#"}),e.jsx("input",{type:"text","aria-label":"Background color hex code",value:(t.backgroundColor||"#F7F7F7").replace("#",""),onChange:O=>{const J=O.target.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);J.length>=3&&v({...t,backgroundColor:`#${J}`,backgroundImage:void 0})},placeholder:"F7F7F7",className:"flex-1 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-mono uppercase focus:ring-2 focus:ring-violet-500 focus:border-transparent focus:outline-none",maxLength:6})]})}),e.jsx("div",{className:"w-12 h-12 rounded-xl border-2 border-gray-200 shadow-inner",style:{backgroundColor:t.backgroundColor||"#F7F7F7"},title:t.backgroundColor||"#F7F7F7"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["#F7F7F7","#ffffff","#f0f0f0","#e5e5e5","#1a1a1a","#0a0a0a","#1e293b","#0f172a","#fef3c7","#dbeafe","#dcfce7","#fce7f3"].map(O=>e.jsx("button",{type:"button","aria-label":`Set background color to ${O}`,"aria-pressed":t.backgroundColor===O&&!t.backgroundImage,onClick:()=>v({...t,backgroundColor:O,backgroundImage:void 0}),className:`w-7 h-7 rounded-lg border-2 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 ${t.backgroundColor===O&&!t.backgroundImage?"border-violet-500 scale-110 shadow-md":"border-gray-200 hover:border-gray-400"}`,style:{backgroundColor:O},title:O},O))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Background Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text","aria-label":"Background image URL",value:t.backgroundImage||"",onChange:O=>v({...t,backgroundImage:O.target.value||void 0}),placeholder:"https://example.com/image.jpg",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent focus:outline-none"}),e.jsxs("label",{className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg cursor-pointer transition-colors focus-within:ring-2 focus-within:ring-blue-500","aria-label":"Upload background image",children:[e.jsx(ut,{size:16,className:"text-gray-600"}),e.jsx("input",{type:"file",accept:"image/*","aria-label":"Upload background image file",className:"hidden",onChange:O=>{var be;const J=(be=O.target.files)==null?void 0:be[0];if(J){const Ne=new FileReader;Ne.onload=()=>{v({...t,backgroundImage:Ne.result})},Ne.readAsDataURL(J)}}})]}),t.backgroundImage&&e.jsx("button",{type:"button","aria-label":"Remove background image",onClick:()=>v({...t,backgroundImage:void 0}),className:"px-3 py-2 bg-red-50 hover:bg-red-100 rounded-lg text-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500",title:"Remove background image",children:e.jsx(Ye,{size:16})})]}),t.backgroundImage&&e.jsx("div",{className:"relative w-full h-24 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:t.backgroundImage,alt:"Background preview",className:"w-full h-full object-cover"})})]}),t.backgroundImage&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Blur Amount"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[t.backgroundBlur||0,"px"]})]}),e.jsx("input",{type:"range","aria-label":`Background blur amount: ${t.backgroundBlur||0} pixels`,min:"0",max:"20",value:t.backgroundBlur||0,onChange:O=>v({...t,backgroundBlur:parseInt(O.target.value)}),className:"w-full accent-violet-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),h==="social"&&e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Social Accounts"}),e.jsxs("button",{type:"button","aria-label":"Add social account",onClick:()=>{const O=wt.filter(J=>!q.some(be=>be.platform===J.id));O.length>0&&f(O[0].id),p(!0)},className:"flex items-center gap-1 text-xs font-semibold text-violet-600 hover:text-violet-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 rounded",children:[e.jsx(Xe,{size:14}),"Add"]})]}),e.jsxs("div",{className:"space-y-2",children:[q.length===0&&!o&&e.jsx("p",{className:"text-sm text-gray-400 text-center py-4 bg-gray-50 rounded-xl border border-dashed border-gray-200",children:"No social accounts configured yet"}),q.map(O=>{const J=Le(O.platform);if(!J)return null;const be=J.brandIcon,Ne=J.icon,ze=$e(O.platform,O.handle);return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-200 rounded-xl group",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-gray-100 flex items-center justify-center shrink-0",children:be?e.jsx("span",{style:{color:J.brandColor},children:e.jsx(be,{size:18})}):e.jsx("span",{className:"text-gray-600",children:e.jsx(Ne,{size:18})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:J.label}),e.jsx("input",{type:"text","aria-label":`${J.label} handle`,value:O.handle,onChange:Be=>ae(O.platform,Be.target.value),placeholder:J.placeholder,className:"w-full text-xs text-gray-500 bg-transparent border-none p-0 focus:outline-none focus:ring-0"})]}),e.jsxs("div",{className:"shrink-0 w-20",children:[e.jsx("input",{type:"text","aria-label":`${J.label} follower count`,value:O.followerCount||"",onChange:Be=>ne(O.platform,Be.target.value),placeholder:"Followers",className:"w-full text-xs text-gray-500 bg-gray-50 border border-gray-200 rounded-lg px-2 py-1 text-right focus:outline-none focus:ring-1 focus:ring-violet-500"}),O.followerCount&&e.jsx("p",{className:"text-[9px] text-gray-400 text-right mt-0.5",children:Ft(O.followerCount)})]}),ze&&e.jsx("a",{href:ze,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-gray-400 hover:text-violet-600 truncate max-w-[120px]",title:ze,children:"Preview"}),e.jsx("button",{type:"button",onClick:()=>T(O.platform),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg opacity-0 group-hover:opacity-100 transition-all","aria-label":`Remove ${J.label}`,children:e.jsx(_t,{size:14})})]},O.platform)}),o&&e.jsxs("div",{className:"p-3 bg-violet-50 border border-violet-200 rounded-xl space-y-3",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("select",{"aria-label":"Select social platform",value:c,onChange:O=>f(O.target.value),className:"flex-1 bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm font-medium text-gray-800 focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 focus:outline-none",children:wt.filter(O=>!q.some(J=>J.platform===O.id)).map(O=>e.jsx("option",{value:O.id,children:O.label},O.id))})}),e.jsx("input",{type:"text","aria-label":"Social account handle",value:d,onChange:O=>x(O.target.value),placeholder:((ye=Le(c))==null?void 0:ye.placeholder)||"yourhandle",className:"w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 focus:outline-none",onKeyDown:O=>O.key==="Enter"&&z(),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button","aria-label":"Cancel adding social account",onClick:()=>{p(!1),x("")},className:"flex-1 py-2 bg-white border border-gray-200 text-gray-600 rounded-lg text-sm font-semibold hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{type:"button","aria-label":"Add social account",onClick:z,disabled:!d.trim(),className:"flex-1 py-2 bg-violet-600 text-white rounded-lg text-sm font-semibold hover:bg-violet-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Add Account"})]})]})]})]}),h==="seo"&&e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"OpenGraph & Social Sharing"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Configure how your page appears when shared on social media platforms."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"og-title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{id:"og-title",type:"text",value:((xe=t.openGraph)==null?void 0:xe.title)||"",onChange:O=>v({...t,openGraph:{...t.openGraph,title:O.target.value}}),placeholder:t.name||"Your page title",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Leave empty to use your profile name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"og-description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"og-description",value:((Se=t.openGraph)==null?void 0:Se.description)||"",onChange:O=>{const J=O.target.value.slice(0,200);v({...t,openGraph:{...t.openGraph,description:J}})},placeholder:"A brief description of your page...",rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-400",children:[((Ae=(Te=t.openGraph)==null?void 0:Te.description)==null?void 0:Ae.length)||0,"/200 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"og-image",className:"block text-sm font-medium text-gray-700",children:"Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"og-image",type:"url",value:(W=(r=t.openGraph)==null?void 0:r.image)!=null&&W.startsWith("data:")?"":((M=t.openGraph)==null?void 0:M.image)||"",onChange:O=>v({...t,openGraph:{...t.openGraph,image:O.target.value}}),placeholder:"https://example.com/image.png",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("label",{className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg cursor-pointer transition-colors flex items-center gap-2 text-sm font-medium text-gray-700",title:"Upload image",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Upload"}),e.jsx("input",{type:"file",accept:"image/*","aria-label":"Upload OpenGraph image",className:"hidden",onChange:O=>{var be;const J=(be=O.target.files)==null?void 0:be[0];if(J){const Ne=new FileReader;Ne.onload=()=>{v({...t,openGraph:{...t.openGraph,image:Ne.result}})},Ne.readAsDataURL(J)}}})]}),((w=t.openGraph)==null?void 0:w.image)&&e.jsx("button",{type:"button","aria-label":"Remove image",onClick:()=>v({...t,openGraph:{...t.openGraph,image:void 0}}),className:"px-3 py-2 bg-red-50 hover:bg-red-100 rounded-lg text-red-600 transition-colors",title:"Remove image",children:e.jsx(Ye,{size:16})})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Recommended size: 1200x630 pixels"}),((b=t.openGraph)==null?void 0:b.image)&&e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded-lg",children:e.jsx("img",{src:t.openGraph.image,alt:"OG Preview",className:"w-full max-w-xs h-auto rounded border border-gray-200",onError:O=>{O.target.style.display="none"}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"og-site-name",className:"block text-sm font-medium text-gray-700",children:"Site Name"}),e.jsx("input",{id:"og-site-name",type:"text",value:((A=t.openGraph)==null?void 0:A.siteName)||"",onChange:O=>v({...t,openGraph:{...t.openGraph,siteName:O.target.value}}),placeholder:"My Bento",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Twitter / X"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("label",{htmlFor:"twitter-handle",className:"block text-sm font-medium text-gray-700",children:"Twitter Handle"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 border border-r-0 border-gray-200 rounded-l-lg bg-gray-50 text-gray-500 text-sm",children:"@"}),e.jsx("input",{id:"twitter-handle",type:"text",value:((V=t.openGraph)==null?void 0:V.twitterHandle)||"",onChange:O=>{const J=O.target.value.replace(/^@/,"");v({...t,openGraph:{...t.openGraph,twitterHandle:J}})},placeholder:"username",className:"flex-1 px-3 py-2 border border-gray-200 rounded-r-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"twitter-card-type",className:"block text-sm font-medium text-gray-700",children:"Card Type"}),e.jsxs("select",{id:"twitter-card-type",value:((K=t.openGraph)==null?void 0:K.twitterCardType)||"summary_large_image",onChange:O=>v({...t,openGraph:{...t.openGraph,twitterCardType:O.target.value}}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"summary_large_image",children:"Large Image Card"}),e.jsx("option",{value:"summary",children:"Summary Card"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Large image cards show a bigger preview image"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Preview"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"How your link will appear when shared on social media"}),e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden bg-white max-w-md",children:[e.jsx("div",{className:"w-full bg-gray-100 flex items-center justify-center",style:{aspectRatio:"1200/630"},children:(D=t.openGraph)!=null&&D.image?e.jsx("img",{src:t.openGraph.image,alt:"Preview",className:"w-full h-full object-cover",onError:O=>{O.target.style.display="none"}}):e.jsx("div",{className:"text-gray-400 text-sm",children:"No image set"})}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:((Q=t.openGraph)==null?void 0:Q.siteName)||"yourdomain.com"}),e.jsx("p",{className:"font-semibold text-gray-900 text-sm leading-tight mb-1 line-clamp-1",children:((oe=t.openGraph)==null?void 0:oe.title)||t.name||"Page Title"}),e.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:((te=t.openGraph)==null?void 0:te.description)||"Your page description will appear here..."})]})]})]})]}),h==="analytics"&&e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Supabase Analytics"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track page views and clicks on your exported bento. This requires a Supabase project."})]}),(C==null?void 0:C.projectUrl)&&e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl flex items-center gap-3",children:[e.jsx(xt,{size:20,className:"text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Analytics configured"}),e.jsx("p",{className:"text-xs text-green-600",children:C.projectUrl})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl space-y-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(wr,{size:16}),"Setup Instructions"]}),e.jsxs("ol",{className:"text-xs text-gray-600 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Create a Supabase project at"," ",e.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",className:"text-violet-600 underline",children:"supabase.com"})]}),e.jsx("li",{children:"Copy your Project URL (e.g., https://xxx.supabase.co)"}),e.jsx("li",{children:"Copy your Database Password (from project creation)"}),e.jsx("li",{children:"Copy your Publishable Key (Settings → API → anon public)"}),e.jsx("li",{children:'Fill the form below and click "Setup Database"'})]}),e.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"⚠️ This setup only works in dev mode. Credentials are stored locally and never committed."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"Supabase Project URL"}),e.jsx("input",{type:"text","aria-label":"Supabase project URL",value:L,onChange:O=>Z(O.target.value),placeholder:"https://xxxxx.supabase.co",className:"w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent focus:bg-white transition-all focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"Database Password"}),e.jsx("input",{type:"password","aria-label":"Supabase database password",value:F,onChange:O=>R(O.target.value),placeholder:"Your Supabase DB password",className:"w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent focus:bg-white transition-all focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Used only for setup, not stored."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1.5",children:"Publishable Key (anon public)"}),e.jsx("input",{type:"text","aria-label":"Supabase publishable key",value:X,onChange:O=>k(O.target.value),placeholder:"eyJhbGciOiJIUzI1NiIs...",className:"w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent focus:bg-white transition-all font-mono text-xs focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Safe to use in client-side code. Never use the secret/service_role key here."})]}),e.jsxs("button",{type:"button","aria-label":"Save analytics configuration",onClick:()=>{!L||!X||fetch("/__openbento/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectUrl:L,anonKey:X,savedAt:new Date().toISOString()})}).then(()=>{re({projectUrl:L,anonKey:X}),v({...t,analytics:{enabled:!0,supabaseUrl:L,anonKey:X}}),S({ok:!0,message:"Config saved!"})})},disabled:!L||!X,className:"w-full py-3 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx(xt,{size:18}),"Save Config"]}),e.jsx("button",{type:"button","aria-label":"Setup analytics database",onClick:G,disabled:U||!L||!F,className:"w-full py-2.5 bg-violet-100 text-violet-700 rounded-xl font-semibold hover:bg-violet-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:U?e.jsxs(e.Fragment,{children:[e.jsx(Cr,{size:16,className:"animate-spin"}),"Setting up..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wr,{size:16}),"Setup Database (first time only)"]})}),e.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Only needed once to create the analytics table"})]}),_&&e.jsxs("div",{className:`p-4 rounded-xl ${_.ok?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.ok?e.jsx(xt,{size:18,className:"text-green-600"}):e.jsx(Ht,{size:18,className:"text-red-600"}),e.jsx("span",{className:`text-sm font-medium ${_.ok?"text-green-800":"text-red-800"}`,children:_.message})]}),_.logs&&e.jsx("div",{className:"mt-2 p-2 bg-black/5 rounded text-xs font-mono text-gray-600 max-h-32 overflow-auto",children:_.logs.map((O,J)=>e.jsx("div",{children:O},J))})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable Analytics on Export"}),e.jsx("input",{type:"checkbox","aria-label":"Enable analytics on export",checked:((ce=t.analytics)==null?void 0:ce.enabled)||!1,onChange:O=>{var J,be;return v({...t,analytics:{...t.analytics,enabled:O.target.checked,supabaseUrl:L||((J=t.analytics)==null?void 0:J.supabaseUrl),anonKey:X||((be=t.analytics)==null?void 0:be.anonKey)}})},className:"w-5 h-5 rounded text-violet-600 border-gray-300 focus:ring-violet-500"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"When enabled, your exported page will track views and clicks."})]})]}),h==="json"&&e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Raw Configuration"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Edit the JSON directly. Be careful!"})]}),e.jsx("button",{type:"button","aria-label":"Apply JSON changes",onClick:Ce,className:"px-4 py-2 bg-violet-600 text-white rounded-lg text-xs font-semibold hover:bg-violet-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Apply Changes"})]}),N&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600",children:N}),e.jsx("textarea",{"aria-label":"Raw JSON configuration",value:j,onChange:O=>I(O.target.value),className:"w-full h-[400px] bg-gray-900 text-green-400 font-mono text-xs p-4 rounded-xl border-0 focus:ring-2 focus:ring-violet-500 focus:outline-none resize-none",spellCheck:!1}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:"Structure:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-gray-500",children:[e.jsxs("li",{children:[e.jsx("code",{children:"name"}),": Bento project name"]}),e.jsxs("li",{children:[e.jsx("code",{children:"profile"}),": User profile (name, bio, avatarUrl, etc.)"]}),e.jsxs("li",{children:[e.jsx("code",{children:"blocks"}),": Array of blocks with gridColumn, gridRow, colSpan, rowSpan"]})]})]})]})]}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-100",children:e.jsx("button",{type:"button","aria-label":"Close settings modal",onClick:B,className:"w-full py-3 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Close"})})]}),e.jsx(Dr,{isOpen:!!u,src:u||"",title:"Crop profile photo",onCancel:()=>m(null),onConfirm:O=>{v(J=>({...J,avatarUrl:O})),m(null)}})]})})};function zn($){const[B,t]=P.useState($),[v,y]=P.useState([]),[l,n]=P.useState([]),s=P.useCallback(()=>{if(v.length===0)return;const h=v[v.length-1],g=v.slice(0,v.length-1);n([B,...l]),y(g),t(h)},[v,B,l]),i=P.useCallback(()=>{if(l.length===0)return;const h=l[0],g=l.slice(1);y([...v,B]),n(g),t(h)},[l,B,v]),u=P.useCallback(h=>{JSON.stringify(h)!==JSON.stringify(B)&&(y(g=>[...g,B].slice(-50)),t(h),n([]))},[B]),m=P.useCallback(h=>{t(h),y([]),n([])},[]);return{state:B,set:u,undo:s,redo:i,reset:m,canUndo:v.length>0,canRedo:l.length>0}}function Tn($){const B=Date.now(),t=Math.floor((B-$)/1e3);if(t<5)return"Just now";if(t<60)return`${t}s ago`;const v=Math.floor(t/60);if(v<60)return`${v}m ago`;const y=Math.floor(v/60);return y<24?`${y}h ago`:`${Math.floor(y/24)}d ago`}function On(){const[$,B]=P.useState("idle"),[t,v]=P.useState(null),[y,l]=P.useState(""),n=P.useRef(null);P.useEffect(()=>{if(!t)return;const h=()=>{l(Tn(t))};h();const g=setInterval(h,1e4);return()=>clearInterval(g)},[t]),P.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]);const s=P.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),B("saving")},[]),i=P.useCallback(()=>{B("saved"),v(Date.now()),n.current=setTimeout(()=>{B("idle")},1500)},[]),u=P.useCallback(()=>{B("error"),n.current=setTimeout(()=>{B("idle")},3e3)},[]),m=P.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null),B("idle")},[]);return{status:$,lastSavedAt:t,timeAgo:y,setSaving:s,setSaved:i,setError:u,setIdle:m}}const Dn={shape:"circle",shadow:!0,border:!0,borderColor:"#ffffff",borderWidth:3},Ln=({isOpen:$,onClose:B,avatarUrl:t,style:v,onStyleChange:y})=>{const l={...Dn,...v},n=u=>{const m=["w-24","h-24","object-cover","transition-all","duration-200"];return u.shape==="circle"?m.push("rounded-full"):u.shape==="rounded"?m.push("rounded-2xl"):m.push("rounded-none"),u.shadow&&m.push("shadow-xl"),m.join(" ")},s=u=>{const m={};return u.border&&(m.border=`${u.borderWidth||3}px solid ${u.borderColor||"#ffffff"}`),m},i=u=>{y({...l,...u})};return e.jsx(Ze,{children:$&&e.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[80] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:B,children:e.jsxs(Ee.div,{initial:{scale:.95,opacity:0,y:16},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:16},onClick:u=>u.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-5 pb-4 flex justify-between items-start border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Photo Style"}),e.jsx("p",{className:"text-gray-500 text-sm mt-0.5",children:"Customize appearance"})]}),e.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors",children:e.jsx(Ye,{size:18})})]}),e.jsx("div",{className:"p-6 bg-gray-50 flex justify-center",children:e.jsx("div",{className:"relative",children:e.jsx("img",{src:t,alt:"Preview",className:n(l),style:s(l)})})}),e.jsxs("div",{className:"p-5 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Shape"}),e.jsx("div",{className:"flex gap-2",children:[{value:"circle",icon:Ba,label:"Circle"},{value:"rounded",icon:pn,label:"Rounded"},{value:"square",icon:Tr,label:"Square"}].map(({value:u,icon:m,label:h})=>e.jsxs("button",{onClick:()=>i({shape:u}),className:`flex-1 flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all ${l.shape===u?"border-violet-500 bg-violet-50 text-violet-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[e.jsx(m,{size:20}),e.jsx("span",{className:"text-xs font-semibold",children:h})]},u))})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(kn,{size:18,className:"text-gray-500"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Drop shadow"})]}),e.jsx("button",{onClick:()=>i({shadow:!l.shadow}),className:`relative w-11 h-6 rounded-full transition-colors ${l.shadow?"bg-violet-500":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform shadow-sm ${l.shadow?"translate-x-5":""}`})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ar,{size:18,className:"text-gray-500"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Border"})]}),e.jsx("button",{onClick:()=>i({border:!l.border}),className:`relative w-11 h-6 rounded-full transition-colors ${l.border?"bg-violet-500":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform shadow-sm ${l.border?"translate-x-5":""}`})})]}),l.border&&e.jsx(Ee.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"pl-4 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 w-16",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:["#ffffff","#000000","#6366f1","#ec4899","#10b981","#f59e0b"].map(u=>e.jsx("button",{onClick:()=>i({borderColor:u}),className:`w-7 h-7 rounded-full border-2 transition-all ${l.borderColor===u?"ring-2 ring-violet-500 ring-offset-2":"border-gray-200"}`,style:{backgroundColor:u}},u))})]})})]})]}),e.jsx("div",{className:"p-5 pt-3 border-t border-gray-100",children:e.jsx("button",{onClick:B,className:"w-full py-2.5 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors",children:"Apply"})})]})})})},Lt=[{value:"modern",label:"Modern",description:"Clean & contemporary"},{value:"minimalist",label:"Minimalist",description:"Simple & refined"},{value:"colorful",label:"Colorful",description:"Vibrant & dynamic"},{value:"dark",label:"Dark",description:"Elegant dark mode"},{value:"professional",label:"Professional",description:"Corporate & serious"},{value:"playful",label:"Playful",description:"Creative & fun"}],Un=({isOpen:$,onClose:B,onBentoImported:t})=>{const[v,y]=P.useState("prompt"),[l,n]=P.useState(""),[s,i]=P.useState(""),[u,m]=P.useState([""]),[h,g]=P.useState("modern"),[o,p]=P.useState(""),[c,f]=P.useState(!1),[d,x]=P.useState(""),[j,I]=P.useState(null),[N,H]=P.useState(!1),L=()=>{y("prompt"),n(""),i(""),m([""]),g("modern"),p(""),x(""),I(null),H(!1),f(!1),B()},Z=()=>{m([...u,""])},F=S=>{m(u.filter((C,re)=>re!==S))},R=(S,C)=>{const re=[...u];re[S]=C,m(re)},X=P.useMemo(()=>{var re,G;const S=[];l.trim()&&S.push(`- Name/Username: ${l.trim()}`),s.trim()&&S.push(`- Bio: ${s.trim()}`);const C=u.filter(q=>q.trim());return C.length>0&&S.push(`- Social networks:
${C.map(q=>`  • ${q}`).join(`
`)}`),S.push(`- Desired visual style: ${((re=Lt.find(q=>q.value===h))==null?void 0:re.label)||h}`),o.trim()&&S.push(`- Specific request: ${o.trim()}`),`I want to create a Bento-style "link-in-bio" page with OpenBento.

${S.length>0?`## My information
${S.join(`
`)}
`:""}
## Your task

Generate a valid JSON to configure my Bento page. The JSON must follow EXACTLY this format:

\`\`\`json
{
  "name": "Bento Name",
  "profile": {
    "name": "My Name",
    "bio": "My bio in 1-2 lines",
    "avatarUrl": "",
    "theme": "light",
    "primaryColor": "blue",
    "showBranding": true,
    "showSocialInHeader": true,
    "showFollowerCount": true,
    "backgroundColor": "#f5f5f5",
    "socialAccounts": [
      { "platform": "instagram", "handle": "myhandle", "followerCount": 15000 },
      { "platform": "youtube", "handle": "mychannel", "followerCount": 50000 },
      { "platform": "github", "handle": "myusername" }
    ]
  },
  "blocks": [
    {
      "id": "block_1",
      "type": "BLOCK_TYPE",
      "title": "Title",
      "subtext": "Subtitle",
      "content": "URL or text",
      "colSpan": 3,
      "rowSpan": 3,
      "gridColumn": 1,
      "gridRow": 1,
      "color": "bg-gray-900",
      "textColor": "text-white"
    }
  ]
}
\`\`\`

---

## PROFILE OPTIONS (displayed in header, under avatar)

### Social accounts under avatar
Use \`socialAccounts\` array to display social icons with follower counts under the avatar:
- \`platform\`: one of the supported platforms (see list below)
- \`handle\`: username without @ (e.g., "johndoe" not "@johndoe")
- \`followerCount\`: optional number (e.g., 15000 displays as "15k", 1500000 as "1.5M")

### Header display options
- \`showSocialInHeader\`: true = show social icons row under name/bio
- \`showFollowerCount\`: true = show follower count next to each social icon

### Theme & background
- \`theme\`: "light" or "dark"
- \`backgroundColor\`: CSS color (hex like "#f5f5f5", or named color)
- \`primaryColor\`: accent color name (blue, violet, pink, amber, emerald, etc.)

---

## BLOCK TYPES (displayed in the grid)

### LINK - Clickable link block
\`\`\`json
{ "type": "LINK", "title": "My Website", "subtext": "Visit my portfolio", "content": "https://example.com", "colSpan": 3, "rowSpan": 3 }
\`\`\`

### TEXT - Text/note block
\`\`\`json
{ "type": "TEXT", "title": "Hello!", "content": "Welcome to my page. I'm a developer passionate about open source.", "colSpan": 3, "rowSpan": 3 }
\`\`\`

### SOCIAL - Large social block with branding
\`\`\`json
{ "type": "SOCIAL", "title": "Follow me", "subtext": "@myhandle", "socialPlatform": "instagram", "socialHandle": "myhandle", "colSpan": 3, "rowSpan": 3 }
\`\`\`
Note: Use this for featured social networks you want to highlight in the grid.

### SOCIAL_ICON - Small icon-only social block (1x1 cell)
\`\`\`json
{ "type": "SOCIAL_ICON", "socialPlatform": "github", "socialHandle": "myusername", "colSpan": 1, "rowSpan": 1 }
\`\`\`
Note: Perfect for a row of small social icons. Use colSpan: 1, rowSpan: 1.

### MEDIA - Image/GIF block
\`\`\`json
{ "type": "MEDIA", "title": "My photo", "imageUrl": "https://example.com/image.jpg", "colSpan": 3, "rowSpan": 3 }
\`\`\`

### MAP - Google Maps location
\`\`\`json
{ "type": "MAP", "title": "Paris, France", "content": "Paris, France", "colSpan": 3, "rowSpan": 3 }
\`\`\`

### SPACER - Empty spacing block
\`\`\`json
{ "type": "SPACER", "colSpan": 3, "rowSpan": 1 }
\`\`\`

---

## SUPPORTED SOCIAL PLATFORMS

x, instagram, tiktok, youtube, github, gitlab, linkedin, facebook, twitch, dribbble, medium, devto, reddit, pinterest, threads, bluesky, mastodon, substack, patreon, kofi, buymeacoffee, snapchat, discord, telegram, whatsapp, spotify, website, custom

---

## GRID SYSTEM

- Grid is 9 columns wide (gridColumn: 1-9)
- Rows start at 1 and extend as needed (gridRow: 1, 2, 3...)
- colSpan: block width (1-9 cells)
- rowSpan: block height (1-50 cells)
- Common sizes: 3x3 (standard), 6x3 (wide), 3x6 (tall), 9x3 (full width), 1x1 (icon)
- BLOCKS MUST NOT OVERLAP!

---

## VISUAL STYLE GUIDE

**The user selected: ${((G=Lt.find(q=>q.value===h))==null?void 0:G.label)||h}**

Apply these style guidelines:

${h==="modern"?`### Modern Style
- Theme: "light"
- Clean, contemporary look with subtle contrasts
- Primary colors: violet, indigo, blue
- Backgrounds: bg-white, bg-gray-100 for light blocks, bg-gray-900 for accent
- Use subtle gradients: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
- Rounded corners, subtle shadows`:""}
${h==="minimalist"?`### Minimalist Style
- Theme: "light"
- Simple, clean, lots of whitespace
- Primary colors: gray, slate
- Backgrounds: mostly bg-white, bg-gray-50, with one or two bg-gray-900 accents
- Avoid gradients, keep it simple
- Muted, neutral palette`:""}
${h==="colorful"?`### Colorful Style
- Theme: "light"
- Vibrant, playful, dynamic
- Mix multiple colors: pink, violet, cyan, amber, emerald
- Backgrounds: bg-pink-500, bg-violet-500, bg-cyan-500, bg-amber-500
- Use bold gradients: "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
- High contrast, energetic feel`:""}
${h==="dark"?`### Dark Style
- Theme: "dark"
- Elegant dark mode
- backgroundColor: "#0f0f0f" or "#1a1a2e"
- Primary colors: violet, purple, cyan for accents on dark
- Backgrounds: bg-gray-900, bg-slate-800, bg-gray-800
- Text: text-white, text-gray-100
- Use glowing gradients: "linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)"`:""}
${h==="professional"?`### Professional Style
- Theme: "light"
- Corporate, serious, trustworthy
- Primary colors: blue, slate, gray
- Backgrounds: bg-blue-500, bg-slate-800, bg-white
- Clean lines, no playful elements
- Conservative color choices`:""}
${h==="playful"?`### Playful Style
- Theme: "light"
- Fun, creative, quirky
- Primary colors: pink, amber, cyan, violet
- Backgrounds: bg-pink-500, bg-amber-100, bg-cyan-500
- Use fun gradients: "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)"
- Mix colors freely, be creative!`:""}

---

## COLORS (Tailwind classes)

### Backgrounds
bg-gray-900, bg-gray-800, bg-slate-800, bg-white, bg-gray-100
bg-violet-500, bg-purple-500, bg-indigo-500, bg-blue-500, bg-cyan-500
bg-emerald-500, bg-teal-500, bg-green-500
bg-pink-500, bg-rose-500, bg-red-500
bg-amber-100, bg-amber-500, bg-orange-500, bg-yellow-500

### Custom gradients (use customBackground instead of color)
"customBackground": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"

### Text colors
text-white, text-black, text-gray-900, text-gray-100, text-gray-700

---

## IMAGES & MEDIA

You can include images in the Bento:

### Avatar image (profile.avatarUrl)
- Search for the user's profile picture on their social networks
- Or suggest a placeholder: "" (user can add later)

### MEDIA blocks (imageUrl)
- Search for relevant images the user might want to showcase
- Look for: profile photos, portfolio images, brand logos
- Use direct image URLs (must end in .jpg, .png, .gif, .webp or be a valid image URL)
- Example sources: user's website, social media posts, portfolio

### Background image (profile.backgroundImage)
- Optional: suggest a background pattern or image
- Can be a subtle texture or gradient image

**If you find relevant images during your search, include them! If not, leave imageUrl/avatarUrl empty.**

---

## IMPORTANT RULES

1. Place social networks in TWO ways:
   - In \`profile.socialAccounts\` array: shows icons with follower counts UNDER the avatar
   - As SOCIAL or SOCIAL_ICON blocks: shows them IN the grid with custom styling

2. For a complete page, include:
   - Profile with socialAccounts (for header icons)
   - A TEXT block for introduction
   - SOCIAL blocks for featured platforms
   - LINK blocks for important links
   - Optionally: MAP, MEDIA blocks

3. Make sure blocks don't overlap (check gridColumn + colSpan doesn't exceed 9)

4. Use followerCount as raw numbers: 15000, 1500000 (app formats them as 15k, 1.5M)

---

## ⚠️ DATA VERIFICATION (CRITICAL)

**BEFORE generating the JSON, you MUST verify the data:**

### If you have internet access:
1. **Search broadly for the user** - Google their name/username to find all their profiles
2. **Visit their social profiles** to verify handles and get follower counts
3. **Look for their profile pictures** - find a good avatar image URL
4. **Find relevant images** for MEDIA blocks (portfolio, photos, etc.)
5. **Check their website** for additional links, bio info, and images
6. **Verify all URLs** are valid and point to real content
7. Use REAL, VERIFIED data in the JSON

### Expand your search:
- Search "[username] social media" to find all profiles
- Search "[username] portfolio" or "[username] website" for images
- Look at their Twitter/X, Instagram, LinkedIn for profile photos
- Check if they have a YouTube banner, Twitch panels, etc.

### If you DON'T have internet access:
1. **ASK the user to confirm** before generating the JSON:
   - "What is your exact Instagram handle?"
   - "How many followers do you have on YouTube?"
   - "Do you have a profile picture URL I can use?"
   - "Any images you'd like to include in MEDIA blocks?"
2. **List all uncertain data** and request confirmation
3. **Don't guess or make up** follower counts, handles, or image URLs
4. Wait for user confirmation before providing the final JSON

### Data to verify:
- [ ] Social media handles (exact spelling)
- [ ] Follower/subscriber counts (approximate is OK, but ask if unsure)
- [ ] Website URLs (must be valid)
- [ ] YouTube channel ID (if using YouTube blocks)
- [ ] Location for MAP blocks
- [ ] Profile picture / avatar URL
- [ ] Images for MEDIA blocks (if any)

**DO NOT INVENT DATA. When in doubt, ASK!**
**DO include images if you find them during your search!**

---

## OUTPUT FORMAT

If all data is verified → Reply ONLY with the JSON, no explanation, directly parseable.

If data needs confirmation → First ask your questions, then provide the JSON after user confirms.`},[l,s,u,h,o]),k=async()=>{try{await navigator.clipboard.writeText(X),f(!0),setTimeout(()=>f(!1),2e3)}catch(S){console.error("Failed to copy:",S)}},U=()=>{var S,C,re,G,q,z,T;if(I(null),H(!1),!d.trim()){I("Please paste the JSON generated by the AI");return}try{let ae=JSON.parse(d.trim());if(typeof ae=="string"&&(ae=JSON.parse(ae)),!ae.profile&&!ae.blocks){I('Invalid JSON: missing "profile" or "blocks"');return}const ne={id:`ai_${Date.now()}`,name:ae.name||l||"My AI Bento",version:"1.0",profile:{name:((S=ae.profile)==null?void 0:S.name)||l||"My Bento",bio:((C=ae.profile)==null?void 0:C.bio)||s||"",avatarUrl:((re=ae.profile)==null?void 0:re.avatarUrl)||"",theme:((G=ae.profile)==null?void 0:G.theme)||"light",primaryColor:((q=ae.profile)==null?void 0:q.primaryColor)||"blue",showBranding:((z=ae.profile)==null?void 0:z.showBranding)??!0,analytics:{enabled:!1,supabaseUrl:""},socialAccounts:((T=ae.profile)==null?void 0:T.socialAccounts)||[]},blocks:(ae.blocks||[]).map((ue,Ce)=>({id:ue.id||`block_${Ce+1}`,type:ue.type||"TEXT",title:ue.title||"",subtext:ue.subtext||"",content:ue.content||"",colSpan:ue.colSpan||3,rowSpan:ue.rowSpan||3,gridColumn:ue.gridColumn||1,gridRow:ue.gridRow||1,color:ue.color||"bg-gray-900",textColor:ue.textColor||"text-white",socialPlatform:ue.socialPlatform,socialHandle:ue.socialHandle,imageUrl:ue.imageUrl}))},ee=ja(ne);H(!0),setTimeout(()=>{t(ee),L()},1e3)}catch(ae){const ne=ae instanceof Error?ae.message:"Unknown error";I(`Invalid JSON: ${ne}`)}},a=S=>{let C=S.trim();return C.startsWith("```json")?C=C.slice(7):C.startsWith("```")&&(C=C.slice(3)),C.endsWith("```")&&(C=C.slice(0,-3)),C.trim()},_=S=>{x(a(S)),I(null)};return e.jsx(Ze,{children:$&&e.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[80] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:L,children:e.jsxs(Ee.div,{initial:{scale:.95,opacity:0,y:16},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:16},onClick:S=>S.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-5 pb-4 flex justify-between items-start border-b border-gray-100 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx(yt,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:v==="prompt"?"Generate with AI":"Import result"}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-amber-100 text-amber-700 border border-amber-200",children:[e.jsx(La,{size:12}),"Experimental"]})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-0.5",children:v==="prompt"?"Step 1/2 - Customize and copy the prompt":"Step 2/2 - Paste the generated JSON"})]})]}),e.jsx("button",{onClick:L,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors",children:e.jsx(Ye,{size:18})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:v==="prompt"?e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-violet-50 rounded-xl border border-violet-100",children:[e.jsx(yt,{size:18,className:"text-violet-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-violet-700",children:[e.jsx("p",{className:"font-medium",children:"Use your favorite AI!"}),e.jsx("p",{className:"text-violet-600 mt-0.5",children:"This feature works with any AI chat: ChatGPT, Claude, Gemini, Mistral, Llama, or any other. Copy the prompt and paste it into your preferred AI assistant."})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fill in your information to customize the prompt. The AI will use this data to create your Bento."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Name / Username"}),e.jsx("input",{type:"text",value:l,onChange:S=>n(S.target.value),placeholder:"John Doe",className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Bio / Description"}),e.jsx("textarea",{value:s,onChange:S=>i(S.target.value),placeholder:"Passionate web developer, content creator...",rows:2,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Social network URLs"}),e.jsxs("div",{className:"space-y-2",children:[u.map((S,C)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:S,onChange:re=>R(C,re.target.value),placeholder:"https://instagram.com/myusername",className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent"}),u.length>1&&e.jsx("button",{onClick:()=>F(C),className:"p-2.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-xl transition-colors",children:e.jsx(_t,{size:18})})]},C)),e.jsxs("button",{onClick:Z,className:"flex items-center gap-2 text-sm text-violet-600 hover:text-violet-700 font-medium",children:[e.jsx(Xe,{size:16}),"Add a network"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Visual style"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Lt.map(S=>e.jsxs("button",{onClick:()=>g(S.value),className:`p-3 rounded-xl border-2 text-left transition-all ${h===S.value?"border-violet-500 bg-violet-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:S.label}),e.jsx("div",{className:"text-xs text-gray-500",children:S.description})]},S.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Specific request (optional)"}),e.jsx("textarea",{value:o,onChange:S=>p(S.target.value),placeholder:"E.g.: I'd like to highlight my YouTube channel, add a map of my city...",rows:3,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent resize-none"})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Generated prompt"}),e.jsx("button",{onClick:k,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${c?"bg-green-100 text-green-700":"bg-violet-100 text-violet-700 hover:bg-violet-200"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(kt,{size:14}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ga,{size:14}),"Copy"]})})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 max-h-48 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:X})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Copy this prompt and paste it into ChatGPT, Claude, or your favorite AI."})]})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-50 rounded-xl border border-amber-200",children:[e.jsx(Or,{size:20,className:"text-amber-500 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800",children:"Warning: This will replace ALL your data"}),e.jsxs("p",{className:"text-sm text-amber-700 mt-1",children:["Importing this JSON will create a ",e.jsx("strong",{children:"new Bento"})," and replace your current work. Make sure to export/save your current Bento first if you want to keep it."]})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Paste here the JSON generated by the AI. It will be automatically imported to create your Bento."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"AI-generated JSON"}),e.jsx("textarea",{value:d,onChange:S=>_(S.target.value),placeholder:'{"name": "My Bento", "profile": {...}, "blocks": [...]}',rows:15,className:`w-full px-4 py-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent resize-none font-mono text-sm ${j?"border-red-300 bg-red-50":N?"border-green-300 bg-green-50":"border-gray-200"}`})]}),j&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-xl border border-red-200",children:[e.jsx(Ht,{size:20,className:"text-red-500 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-red-700",children:"Validation error"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:j})]})]}),N&&e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-green-50 rounded-xl border border-green-200",children:[e.jsx(xt,{size:20,className:"text-green-500 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-700",children:"Import successful!"}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Your Bento has been created. Redirecting..."})]})]})]})}),e.jsx("div",{className:"p-5 pt-3 border-t border-gray-100 shrink-0",children:e.jsxs("div",{className:"flex gap-3",children:[v==="import"&&e.jsxs("button",{onClick:()=>y("prompt"),className:"flex-1 py-2.5 border border-gray-200 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(wa,{size:18}),"Back"]}),v==="prompt"?e.jsxs("button",{onClick:()=>y("import"),className:"flex-1 py-2.5 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors flex items-center justify-center gap-2",children:["I have my JSON",e.jsx(ka,{size:18})]}):e.jsxs("button",{onClick:U,disabled:N,className:"flex-1 py-2.5 bg-violet-600 text-white rounded-xl font-bold hover:bg-violet-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(yt,{size:18}),"Import my Bento"]})]})})]})})})};function gt($){throw new Error('Could not dynamically require "'+$+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ut={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var kr;function Mn(){return kr||(kr=1,(function($,B){(function(t){$.exports=t()})(function(){return(function t(v,y,l){function n(u,m){if(!y[u]){if(!v[u]){var h=typeof gt=="function"&&gt;if(!m&&h)return h(u,!0);if(s)return s(u,!0);var g=new Error("Cannot find module '"+u+"'");throw g.code="MODULE_NOT_FOUND",g}var o=y[u]={exports:{}};v[u][0].call(o.exports,function(p){var c=v[u][1][p];return n(c||p)},o,o.exports,t,v,y,l)}return y[u].exports}for(var s=typeof gt=="function"&&gt,i=0;i<l.length;i++)n(l[i]);return n})({1:[function(t,v,y){var l=t("./utils"),n=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";y.encode=function(i){for(var u,m,h,g,o,p,c,f=[],d=0,x=i.length,j=x,I=l.getTypeOf(i)!=="string";d<i.length;)j=x-d,h=I?(u=i[d++],m=d<x?i[d++]:0,d<x?i[d++]:0):(u=i.charCodeAt(d++),m=d<x?i.charCodeAt(d++):0,d<x?i.charCodeAt(d++):0),g=u>>2,o=(3&u)<<4|m>>4,p=1<j?(15&m)<<2|h>>6:64,c=2<j?63&h:64,f.push(s.charAt(g)+s.charAt(o)+s.charAt(p)+s.charAt(c));return f.join("")},y.decode=function(i){var u,m,h,g,o,p,c=0,f=0,d="data:";if(i.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var x,j=3*(i=i.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(i.charAt(i.length-1)===s.charAt(64)&&j--,i.charAt(i.length-2)===s.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=n.uint8array?new Uint8Array(0|j):new Array(0|j);c<i.length;)u=s.indexOf(i.charAt(c++))<<2|(g=s.indexOf(i.charAt(c++)))>>4,m=(15&g)<<4|(o=s.indexOf(i.charAt(c++)))>>2,h=(3&o)<<6|(p=s.indexOf(i.charAt(c++))),x[f++]=u,o!==64&&(x[f++]=m),p!==64&&(x[f++]=h);return x}},{"./support":30,"./utils":32}],2:[function(t,v,y){var l=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),i=t("./stream/DataLengthProbe");function u(m,h,g,o,p){this.compressedSize=m,this.uncompressedSize=h,this.crc32=g,this.compression=o,this.compressedContent=p}u.prototype={getContentWorker:function(){var m=new n(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),h=this;return m.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new n(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(m,h,g){return m.pipe(new s).pipe(new i("uncompressedSize")).pipe(h.compressWorker(g)).pipe(new i("compressedSize")).withStreamInfo("compression",h)},v.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,v,y){var l=t("./stream/GenericWorker");y.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},y.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,v,y){var l=t("./utils"),n=(function(){for(var s,i=[],u=0;u<256;u++){s=u;for(var m=0;m<8;m++)s=1&s?3988292384^s>>>1:s>>>1;i[u]=s}return i})();v.exports=function(s,i){return s!==void 0&&s.length?l.getTypeOf(s)!=="string"?(function(u,m,h,g){var o=n,p=g+h;u^=-1;for(var c=g;c<p;c++)u=u>>>8^o[255&(u^m[c])];return-1^u})(0|i,s,s.length,0):(function(u,m,h,g){var o=n,p=g+h;u^=-1;for(var c=g;c<p;c++)u=u>>>8^o[255&(u^m.charCodeAt(c))];return-1^u})(0|i,s,s.length,0):0}},{"./utils":32}],5:[function(t,v,y){y.base64=!1,y.binary=!1,y.dir=!1,y.createFolders=!0,y.date=null,y.compression=null,y.compressionOptions=null,y.comment=null,y.unixPermissions=null,y.dosPermissions=null},{}],6:[function(t,v,y){var l=null;l=typeof Promise<"u"?Promise:t("lie"),v.exports={Promise:l}},{lie:37}],7:[function(t,v,y){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=t("pako"),s=t("./utils"),i=t("./stream/GenericWorker"),u=l?"uint8array":"array";function m(h,g){i.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=g,this.meta={}}y.magic="\b\0",s.inherits(m,i),m.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,h.data),!1)},m.prototype.flush=function(){i.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(g){h.push({data:g,meta:h.meta})}},y.compressWorker=function(h){return new m("Deflate",h)},y.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,v,y){function l(o,p){var c,f="";for(c=0;c<p;c++)f+=String.fromCharCode(255&o),o>>>=8;return f}function n(o,p,c,f,d,x){var j,I,N=o.file,H=o.compression,L=x!==u.utf8encode,Z=s.transformTo("string",x(N.name)),F=s.transformTo("string",u.utf8encode(N.name)),R=N.comment,X=s.transformTo("string",x(R)),k=s.transformTo("string",u.utf8encode(R)),U=F.length!==N.name.length,a=k.length!==R.length,_="",S="",C="",re=N.dir,G=N.date,q={crc32:0,compressedSize:0,uncompressedSize:0};p&&!c||(q.crc32=o.crc32,q.compressedSize=o.compressedSize,q.uncompressedSize=o.uncompressedSize);var z=0;p&&(z|=8),L||!U&&!a||(z|=2048);var T=0,ae=0;re&&(T|=16),d==="UNIX"?(ae=798,T|=(function(ee,ue){var Ce=ee;return ee||(Ce=ue?16893:33204),(65535&Ce)<<16})(N.unixPermissions,re)):(ae=20,T|=(function(ee){return 63&(ee||0)})(N.dosPermissions)),j=G.getUTCHours(),j<<=6,j|=G.getUTCMinutes(),j<<=5,j|=G.getUTCSeconds()/2,I=G.getUTCFullYear()-1980,I<<=4,I|=G.getUTCMonth()+1,I<<=5,I|=G.getUTCDate(),U&&(S=l(1,1)+l(m(Z),4)+F,_+="up"+l(S.length,2)+S),a&&(C=l(1,1)+l(m(X),4)+k,_+="uc"+l(C.length,2)+C);var ne="";return ne+=`
\0`,ne+=l(z,2),ne+=H.magic,ne+=l(j,2),ne+=l(I,2),ne+=l(q.crc32,4),ne+=l(q.compressedSize,4),ne+=l(q.uncompressedSize,4),ne+=l(Z.length,2),ne+=l(_.length,2),{fileRecord:h.LOCAL_FILE_HEADER+ne+Z+_,dirRecord:h.CENTRAL_FILE_HEADER+l(ae,2)+ne+l(X.length,2)+"\0\0\0\0"+l(T,4)+l(f,4)+Z+_+X}}var s=t("../utils"),i=t("../stream/GenericWorker"),u=t("../utf8"),m=t("../crc32"),h=t("../signature");function g(o,p,c,f){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=c,this.encodeFileName=f,this.streamFiles=o,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(g,i),g.prototype.push=function(o){var p=o.meta.percent||0,c=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(o):(this.bytesWritten+=o.data.length,i.prototype.push.call(this,{data:o.data,meta:{currentFile:this.currentFile,percent:c?(p+100*(c-f-1))/c:100}}))},g.prototype.openedSource=function(o){this.currentSourceOffset=this.bytesWritten,this.currentFile=o.file.name;var p=this.streamFiles&&!o.file.dir;if(p){var c=n(o,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(o){this.accumulate=!1;var p=this.streamFiles&&!o.file.dir,c=n(o,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),p)this.push({data:(function(f){return h.DATA_DESCRIPTOR+l(f.crc32,4)+l(f.compressedSize,4)+l(f.uncompressedSize,4)})(o),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var o=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var c=this.bytesWritten-o,f=(function(d,x,j,I,N){var H=s.transformTo("string",N(I));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(d,2)+l(d,2)+l(x,4)+l(j,4)+l(H.length,2)+H})(this.dirRecords.length,c,o,this.zipComment,this.encodeFileName);this.push({data:f,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(o){this._sources.push(o);var p=this;return o.on("data",function(c){p.processChunk(c)}),o.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),o.on("error",function(c){p.error(c)}),this},g.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(o){var p=this._sources;if(!i.prototype.error.call(this,o))return!1;for(var c=0;c<p.length;c++)try{p[c].error(o)}catch{}return!0},g.prototype.lock=function(){i.prototype.lock.call(this);for(var o=this._sources,p=0;p<o.length;p++)o[p].lock()},v.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,v,y){var l=t("../compressions"),n=t("./ZipFileWorker");y.generateWorker=function(s,i,u){var m=new n(i.streamFiles,u,i.platform,i.encodeFileName),h=0;try{s.forEach(function(g,o){h++;var p=(function(x,j){var I=x||j,N=l[I];if(!N)throw new Error(I+" is not a valid compression method !");return N})(o.options.compression,i.compression),c=o.options.compressionOptions||i.compressionOptions||{},f=o.dir,d=o.date;o._compressWorker(p,c).withStreamInfo("file",{name:g,dir:f,date:d,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(m)}),m.entriesCount=h}catch(g){m.error(g)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,v,y){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new l;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(n,s){return new l().loadAsync(n,s)},l.external=t("./external"),v.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,v,y){var l=t("./utils"),n=t("./external"),s=t("./utf8"),i=t("./zipEntries"),u=t("./stream/Crc32Probe"),m=t("./nodejsUtils");function h(g){return new n.Promise(function(o,p){var c=g.decompressed.getContentWorker().pipe(new u);c.on("error",function(f){p(f)}).on("end",function(){c.streamInfo.crc32!==g.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):o()}).resume()})}v.exports=function(g,o){var p=this;return o=l.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),m.isNode&&m.isStream(g)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",g,!0,o.optimizedBinaryString,o.base64).then(function(c){var f=new i(o);return f.load(c),f}).then(function(c){var f=[n.Promise.resolve(c)],d=c.files;if(o.checkCRC32)for(var x=0;x<d.length;x++)f.push(h(d[x]));return n.Promise.all(f)}).then(function(c){for(var f=c.shift(),d=f.files,x=0;x<d.length;x++){var j=d[x],I=j.fileNameStr,N=l.resolve(j.fileNameStr);p.file(N,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:o.createFolders}),j.dir||(p.file(N).unsafeOriginalName=I)}return f.zipComment.length&&(p.comment=f.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,v,y){var l=t("../utils"),n=t("../stream/GenericWorker");function s(i,u){n.call(this,"Nodejs stream input adapter for "+i),this._upstreamEnded=!1,this._bindStream(u)}l.inherits(s,n),s.prototype._bindStream=function(i){var u=this;(this._stream=i).pause(),i.on("data",function(m){u.push({data:m,meta:{percent:0}})}).on("error",function(m){u.isPaused?this.generatedError=m:u.error(m)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,v,y){var l=t("readable-stream").Readable;function n(s,i,u){l.call(this,i),this._helper=s;var m=this;s.on("data",function(h,g){m.push(h)||m._helper.pause(),u&&u(g)}).on("error",function(h){m.emit("error",h)}).on("end",function(){m.push(null)})}t("../utils").inherits(n,l),n.prototype._read=function(){this._helper.resume()},v.exports=n},{"../utils":32,"readable-stream":16}],14:[function(t,v,y){v.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,n);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,n)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var n=new Buffer(l);return n.fill(0),n},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,v,y){function l(N,H,L){var Z,F=s.getTypeOf(H),R=s.extend(L||{},m);R.date=R.date||new Date,R.compression!==null&&(R.compression=R.compression.toUpperCase()),typeof R.unixPermissions=="string"&&(R.unixPermissions=parseInt(R.unixPermissions,8)),R.unixPermissions&&16384&R.unixPermissions&&(R.dir=!0),R.dosPermissions&&16&R.dosPermissions&&(R.dir=!0),R.dir&&(N=d(N)),R.createFolders&&(Z=f(N))&&x.call(this,Z,!0);var X=F==="string"&&R.binary===!1&&R.base64===!1;L&&L.binary!==void 0||(R.binary=!X),(H instanceof h&&H.uncompressedSize===0||R.dir||!H||H.length===0)&&(R.base64=!1,R.binary=!0,H="",R.compression="STORE",F="string");var k=null;k=H instanceof h||H instanceof i?H:p.isNode&&p.isStream(H)?new c(N,H):s.prepareContent(N,H,R.binary,R.optimizedBinaryString,R.base64);var U=new g(N,k,R);this.files[N]=U}var n=t("./utf8"),s=t("./utils"),i=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),m=t("./defaults"),h=t("./compressedObject"),g=t("./zipObject"),o=t("./generate"),p=t("./nodejsUtils"),c=t("./nodejs/NodejsStreamInputAdapter"),f=function(N){N.slice(-1)==="/"&&(N=N.substring(0,N.length-1));var H=N.lastIndexOf("/");return 0<H?N.substring(0,H):""},d=function(N){return N.slice(-1)!=="/"&&(N+="/"),N},x=function(N,H){return H=H!==void 0?H:m.createFolders,N=d(N),this.files[N]||l.call(this,N,null,{dir:!0,createFolders:H}),this.files[N]};function j(N){return Object.prototype.toString.call(N)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(N){var H,L,Z;for(H in this.files)Z=this.files[H],(L=H.slice(this.root.length,H.length))&&H.slice(0,this.root.length)===this.root&&N(L,Z)},filter:function(N){var H=[];return this.forEach(function(L,Z){N(L,Z)&&H.push(Z)}),H},file:function(N,H,L){if(arguments.length!==1)return N=this.root+N,l.call(this,N,H,L),this;if(j(N)){var Z=N;return this.filter(function(R,X){return!X.dir&&Z.test(R)})}var F=this.files[this.root+N];return F&&!F.dir?F:null},folder:function(N){if(!N)return this;if(j(N))return this.filter(function(F,R){return R.dir&&N.test(F)});var H=this.root+N,L=x.call(this,H),Z=this.clone();return Z.root=L.name,Z},remove:function(N){N=this.root+N;var H=this.files[N];if(H||(N.slice(-1)!=="/"&&(N+="/"),H=this.files[N]),H&&!H.dir)delete this.files[N];else for(var L=this.filter(function(F,R){return R.name.slice(0,N.length)===N}),Z=0;Z<L.length;Z++)delete this.files[L[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(N){var H,L={};try{if((L=s.extend(N||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");s.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var Z=L.comment||this.comment||"";H=o.generateWorker(this,L,Z)}catch(F){(H=new i("error")).error(F)}return new u(H,L.type||"string",L.mimeType)},generateAsync:function(N,H){return this.generateInternalStream(N).accumulate(H)},generateNodeStream:function(N,H){return(N=N||{}).type||(N.type="nodebuffer"),this.generateInternalStream(N).toNodejsStream(H)}};v.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,v,y){v.exports=t("stream")},{stream:void 0}],17:[function(t,v,y){var l=t("./DataReader");function n(s){l.call(this,s);for(var i=0;i<this.data.length;i++)s[i]=255&s[i]}t("../utils").inherits(n,l),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var i=s.charCodeAt(0),u=s.charCodeAt(1),m=s.charCodeAt(2),h=s.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===i&&this.data[g+1]===u&&this.data[g+2]===m&&this.data[g+3]===h)return g-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var i=s.charCodeAt(0),u=s.charCodeAt(1),m=s.charCodeAt(2),h=s.charCodeAt(3),g=this.readData(4);return i===g[0]&&u===g[1]&&m===g[2]&&h===g[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},v.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,v,y){var l=t("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var i,u=0;for(this.checkOffset(s),i=this.index+s-1;i>=this.index;i--)u=(u<<8)+this.byteAt(i);return this.index+=s,u},readString:function(s){return l.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},v.exports=n},{"../utils":32}],19:[function(t,v,y){var l=t("./Uint8ArrayReader");function n(s){l.call(this,s)}t("../utils").inherits(n,l),n.prototype.readData=function(s){this.checkOffset(s);var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},v.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,v,y){var l=t("./DataReader");function n(s){l.call(this,s)}t("../utils").inherits(n,l),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var i=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},v.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,v,y){var l=t("./ArrayReader");function n(s){l.call(this,s)}t("../utils").inherits(n,l),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var i=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,i},v.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,v,y){var l=t("../utils"),n=t("../support"),s=t("./ArrayReader"),i=t("./StringReader"),u=t("./NodeBufferReader"),m=t("./Uint8ArrayReader");v.exports=function(h){var g=l.getTypeOf(h);return l.checkSupport(g),g!=="string"||n.uint8array?g==="nodebuffer"?new u(h):n.uint8array?new m(l.transformTo("uint8array",h)):new s(l.transformTo("array",h)):new i(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,v,y){y.LOCAL_FILE_HEADER="PK",y.CENTRAL_FILE_HEADER="PK",y.CENTRAL_DIRECTORY_END="PK",y.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",y.ZIP64_CENTRAL_DIRECTORY_END="PK",y.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,v,y){var l=t("./GenericWorker"),n=t("../utils");function s(i){l.call(this,"ConvertWorker to "+i),this.destType=i}n.inherits(s,l),s.prototype.processChunk=function(i){this.push({data:n.transformTo(this.destType,i.data),meta:i.meta})},v.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,v,y){var l=t("./GenericWorker"),n=t("../crc32");function s(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,l),s.prototype.processChunk=function(i){this.streamInfo.crc32=n(i.data,this.streamInfo.crc32||0),this.push(i)},v.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,v,y){var l=t("../utils"),n=t("./GenericWorker");function s(i){n.call(this,"DataLengthProbe for "+i),this.propName=i,this.withStreamInfo(i,0)}l.inherits(s,n),s.prototype.processChunk=function(i){if(i){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+i.data.length}n.prototype.processChunk.call(this,i)},v.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,v,y){var l=t("../utils"),n=t("./GenericWorker");function s(i){n.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,i.then(function(m){u.dataIsReady=!0,u.data=m,u.max=m&&m.length||0,u.type=l.getTypeOf(m),u.isPaused||u._tickAndRepeat()},function(m){u.error(m)})}l.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var i=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":i=this.data.substring(this.index,u);break;case"uint8array":i=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":i=this.data.slice(this.index,u)}return this.index=u,this.push({data:i,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,v,y){function l(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var i=0;i<this._listeners[n].length;i++)this._listeners[n][i].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(i){s.processChunk(i)}),n.on("end",function(){s.end()}),n.on("error",function(i){s.error(i)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},v.exports=l},{}],29:[function(t,v,y){var l=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),i=t("../base64"),u=t("../support"),m=t("../external"),h=null;if(u.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(p,c){return new m.Promise(function(f,d){var x=[],j=p._internalType,I=p._outputType,N=p._mimeType;p.on("data",function(H,L){x.push(H),c&&c(L)}).on("error",function(H){x=[],d(H)}).on("end",function(){try{var H=(function(L,Z,F){switch(L){case"blob":return l.newBlob(l.transformTo("arraybuffer",Z),F);case"base64":return i.encode(Z);default:return l.transformTo(L,Z)}})(I,(function(L,Z){var F,R=0,X=null,k=0;for(F=0;F<Z.length;F++)k+=Z[F].length;switch(L){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(X=new Uint8Array(k),F=0;F<Z.length;F++)X.set(Z[F],R),R+=Z[F].length;return X;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+L+"'")}})(j,x),N);f(H)}catch(L){d(L)}x=[]}).resume()})}function o(p,c,f){var d=c;switch(c){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=c,this._mimeType=f,l.checkSupport(d),this._worker=p.pipe(new n(d)),p.lock()}catch(x){this._worker=new s("error"),this._worker.error(x)}}o.prototype={accumulate:function(p){return g(this,p)},on:function(p,c){var f=this;return p==="data"?this._worker.on(p,function(d){c.call(f,d.data,d.meta)}):this._worker.on(p,function(){l.delay(c,arguments,f)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},p)}},v.exports=o},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,v,y){if(y.base64=!0,y.array=!0,y.string=!0,y.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",y.nodebuffer=typeof Buffer<"u",y.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")y.blob=!1;else{var l=new ArrayBuffer(0);try{y.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(l),y.blob=n.getBlob("application/zip").size===0}catch{y.blob=!1}}}try{y.nodestream=!!t("readable-stream").Readable}catch{y.nodestream=!1}},{"readable-stream":16}],31:[function(t,v,y){for(var l=t("./utils"),n=t("./support"),s=t("./nodejsUtils"),i=t("./stream/GenericWorker"),u=new Array(256),m=0;m<256;m++)u[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;u[254]=u[254]=1;function h(){i.call(this,"utf-8 decode"),this.leftOver=null}function g(){i.call(this,"utf-8 encode")}y.utf8encode=function(o){return n.nodebuffer?s.newBufferFrom(o,"utf-8"):(function(p){var c,f,d,x,j,I=p.length,N=0;for(x=0;x<I;x++)(64512&(f=p.charCodeAt(x)))==55296&&x+1<I&&(64512&(d=p.charCodeAt(x+1)))==56320&&(f=65536+(f-55296<<10)+(d-56320),x++),N+=f<128?1:f<2048?2:f<65536?3:4;for(c=n.uint8array?new Uint8Array(N):new Array(N),x=j=0;j<N;x++)(64512&(f=p.charCodeAt(x)))==55296&&x+1<I&&(64512&(d=p.charCodeAt(x+1)))==56320&&(f=65536+(f-55296<<10)+(d-56320),x++),f<128?c[j++]=f:(f<2048?c[j++]=192|f>>>6:(f<65536?c[j++]=224|f>>>12:(c[j++]=240|f>>>18,c[j++]=128|f>>>12&63),c[j++]=128|f>>>6&63),c[j++]=128|63&f);return c})(o)},y.utf8decode=function(o){return n.nodebuffer?l.transformTo("nodebuffer",o).toString("utf-8"):(function(p){var c,f,d,x,j=p.length,I=new Array(2*j);for(c=f=0;c<j;)if((d=p[c++])<128)I[f++]=d;else if(4<(x=u[d]))I[f++]=65533,c+=x-1;else{for(d&=x===2?31:x===3?15:7;1<x&&c<j;)d=d<<6|63&p[c++],x--;1<x?I[f++]=65533:d<65536?I[f++]=d:(d-=65536,I[f++]=55296|d>>10&1023,I[f++]=56320|1023&d)}return I.length!==f&&(I.subarray?I=I.subarray(0,f):I.length=f),l.applyFromCharCode(I)})(o=l.transformTo(n.uint8array?"uint8array":"array",o))},l.inherits(h,i),h.prototype.processChunk=function(o){var p=l.transformTo(n.uint8array?"uint8array":"array",o.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var c=p;(p=new Uint8Array(c.length+this.leftOver.length)).set(this.leftOver,0),p.set(c,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var f=(function(x,j){var I;for((j=j||x.length)>x.length&&(j=x.length),I=j-1;0<=I&&(192&x[I])==128;)I--;return I<0||I===0?j:I+u[x[I]]>j?I:j})(p),d=p;f!==p.length&&(n.uint8array?(d=p.subarray(0,f),this.leftOver=p.subarray(f,p.length)):(d=p.slice(0,f),this.leftOver=p.slice(f,p.length))),this.push({data:y.utf8decode(d),meta:o.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:y.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},y.Utf8DecodeWorker=h,l.inherits(g,i),g.prototype.processChunk=function(o){this.push({data:y.utf8encode(o.data),meta:o.meta})},y.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,v,y){var l=t("./support"),n=t("./base64"),s=t("./nodejsUtils"),i=t("./external");function u(c){return c}function m(c,f){for(var d=0;d<c.length;++d)f[d]=255&c.charCodeAt(d);return f}t("setimmediate"),y.newBlob=function(c,f){y.checkSupport("blob");try{return new Blob([c],{type:f})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(c),d.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(c,f,d){var x=[],j=0,I=c.length;if(I<=d)return String.fromCharCode.apply(null,c);for(;j<I;)f==="array"||f==="nodebuffer"?x.push(String.fromCharCode.apply(null,c.slice(j,Math.min(j+d,I)))):x.push(String.fromCharCode.apply(null,c.subarray(j,Math.min(j+d,I)))),j+=d;return x.join("")},stringifyByChar:function(c){for(var f="",d=0;d<c.length;d++)f+=String.fromCharCode(c[d]);return f},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}})()}};function g(c){var f=65536,d=y.getTypeOf(c),x=!0;if(d==="uint8array"?x=h.applyCanBeUsed.uint8array:d==="nodebuffer"&&(x=h.applyCanBeUsed.nodebuffer),x)for(;1<f;)try{return h.stringifyByChunk(c,d,f)}catch{f=Math.floor(f/2)}return h.stringifyByChar(c)}function o(c,f){for(var d=0;d<c.length;d++)f[d]=c[d];return f}y.applyFromCharCode=g;var p={};p.string={string:u,array:function(c){return m(c,new Array(c.length))},arraybuffer:function(c){return p.string.uint8array(c).buffer},uint8array:function(c){return m(c,new Uint8Array(c.length))},nodebuffer:function(c){return m(c,s.allocBuffer(c.length))}},p.array={string:g,array:u,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(c)}},p.arraybuffer={string:function(c){return g(new Uint8Array(c))},array:function(c){return o(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:u,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(new Uint8Array(c))}},p.uint8array={string:g,array:function(c){return o(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:u,nodebuffer:function(c){return s.newBufferFrom(c)}},p.nodebuffer={string:g,array:function(c){return o(c,new Array(c.length))},arraybuffer:function(c){return p.nodebuffer.uint8array(c).buffer},uint8array:function(c){return o(c,new Uint8Array(c.length))},nodebuffer:u},y.transformTo=function(c,f){if(f=f||"",!c)return f;y.checkSupport(c);var d=y.getTypeOf(f);return p[d][c](f)},y.resolve=function(c){for(var f=c.split("/"),d=[],x=0;x<f.length;x++){var j=f[x];j==="."||j===""&&x!==0&&x!==f.length-1||(j===".."?d.pop():d.push(j))}return d.join("/")},y.getTypeOf=function(c){return typeof c=="string"?"string":Object.prototype.toString.call(c)==="[object Array]"?"array":l.nodebuffer&&s.isBuffer(c)?"nodebuffer":l.uint8array&&c instanceof Uint8Array?"uint8array":l.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},y.checkSupport=function(c){if(!l[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},y.MAX_VALUE_16BITS=65535,y.MAX_VALUE_32BITS=-1,y.pretty=function(c){var f,d,x="";for(d=0;d<(c||"").length;d++)x+="\\x"+((f=c.charCodeAt(d))<16?"0":"")+f.toString(16).toUpperCase();return x},y.delay=function(c,f,d){setImmediate(function(){c.apply(d||null,f||[])})},y.inherits=function(c,f){function d(){}d.prototype=f.prototype,c.prototype=new d},y.extend=function(){var c,f,d={};for(c=0;c<arguments.length;c++)for(f in arguments[c])Object.prototype.hasOwnProperty.call(arguments[c],f)&&d[f]===void 0&&(d[f]=arguments[c][f]);return d},y.prepareContent=function(c,f,d,x,j){return i.Promise.resolve(f).then(function(I){return l.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new i.Promise(function(N,H){var L=new FileReader;L.onload=function(Z){N(Z.target.result)},L.onerror=function(Z){H(Z.target.error)},L.readAsArrayBuffer(I)}):I}).then(function(I){var N=y.getTypeOf(I);return N?(N==="arraybuffer"?I=y.transformTo("uint8array",I):N==="string"&&(j?I=n.decode(I):d&&x!==!0&&(I=(function(H){return m(H,l.uint8array?new Uint8Array(H.length):new Array(H.length))})(I))),I):i.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,v,y){var l=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),i=t("./zipEntry"),u=t("./support");function m(h){this.files=[],this.loadOptions=h}m.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(g)+", expected "+n.pretty(h)+")")}},isSignature:function(h,g){var o=this.reader.index;this.reader.setIndex(h);var p=this.reader.readString(4)===g;return this.reader.setIndex(o),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),g=u.uint8array?"uint8array":"array",o=n.transformTo(g,h);this.zipComment=this.loadOptions.decodeFileName(o)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,g,o,p=this.zip64EndOfCentralSize-44;0<p;)h=this.reader.readInt(2),g=this.reader.readInt(4),o=this.reader.readData(g),this.zip64ExtensibleData[h]={id:h,length:g,value:o}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,g;for(h=0;h<this.files.length;h++)g=this.files[h],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(h=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var g=h;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var o=this.centralDirOffset+this.centralDirSize;this.zip64&&(o+=20,o+=12+this.zip64EndOfCentralSize);var p=g-o;if(0<p)this.isSignature(g,s.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(h){this.reader=l(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,v,y){var l=t("./reader/readerFor"),n=t("./utils"),s=t("./compressedObject"),i=t("./crc32"),u=t("./utf8"),m=t("./compressions"),h=t("./support");function g(o,p){this.options=o,this.loadOptions=p}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(o){var p,c;if(o.skip(22),this.fileNameLength=o.readInt(2),c=o.readInt(2),this.fileName=o.readData(this.fileNameLength),o.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=(function(f){for(var d in m)if(Object.prototype.hasOwnProperty.call(m,d)&&m[d].magic===f)return m[d];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,p,o.readData(this.compressedSize))},readCentralPart:function(o){this.versionMadeBy=o.readInt(2),o.skip(2),this.bitFlag=o.readInt(2),this.compressionMethod=o.readString(2),this.date=o.readDate(),this.crc32=o.readInt(4),this.compressedSize=o.readInt(4),this.uncompressedSize=o.readInt(4);var p=o.readInt(2);if(this.extraFieldsLength=o.readInt(2),this.fileCommentLength=o.readInt(2),this.diskNumberStart=o.readInt(2),this.internalFileAttributes=o.readInt(2),this.externalFileAttributes=o.readInt(4),this.localHeaderOffset=o.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");o.skip(p),this.readExtraFields(o),this.parseZIP64ExtraField(o),this.fileComment=o.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var o=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),o==0&&(this.dosPermissions=63&this.externalFileAttributes),o==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var o=l(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=o.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=o.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=o.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=o.readInt(4))}},readExtraFields:function(o){var p,c,f,d=o.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});o.index+4<d;)p=o.readInt(2),c=o.readInt(2),f=o.readData(c),this.extraFields[p]={id:p,length:c,value:f};o.setIndex(d)},handleUTF8:function(){var o=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var c=n.transformTo(o,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var f=this.findExtraFieldUnicodeComment();if(f!==null)this.fileCommentStr=f;else{var d=n.transformTo(o,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var o=this.extraFields[28789];if(o){var p=l(o.value);return p.readInt(1)!==1||i(this.fileName)!==p.readInt(4)?null:u.utf8decode(p.readData(o.length-5))}return null},findExtraFieldUnicodeComment:function(){var o=this.extraFields[25461];if(o){var p=l(o.value);return p.readInt(1)!==1||i(this.fileComment)!==p.readInt(4)?null:u.utf8decode(p.readData(o.length-5))}return null}},v.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,v,y){function l(p,c,f){this.name=p,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=c,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),i=t("./utf8"),u=t("./compressedObject"),m=t("./stream/GenericWorker");l.prototype={internalStream:function(p){var c=null,f="string";try{if(!p)throw new Error("No output type specified.");var d=(f=p.toLowerCase())==="string"||f==="text";f!=="binarystring"&&f!=="text"||(f="string"),c=this._decompressWorker();var x=!this._dataBinary;x&&!d&&(c=c.pipe(new i.Utf8EncodeWorker)),!x&&d&&(c=c.pipe(new i.Utf8DecodeWorker))}catch(j){(c=new m("error")).error(j)}return new n(c,f,"")},async:function(p,c){return this.internalStream(p).accumulate(c)},nodeStream:function(p,c){return this.internalStream(p||"nodebuffer").toNodejsStream(c)},_compressWorker:function(p,c){if(this._data instanceof u&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new i.Utf8EncodeWorker)),u.createWorkerFrom(f,p,c)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof m?this._data:new s(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},o=0;o<h.length;o++)l.prototype[h[o]]=g;v.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,v,y){(function(l){var n,s,i=l.MutationObserver||l.WebKitMutationObserver;if(i){var u=0,m=new i(p),h=l.document.createTextNode("");m.observe(h,{characterData:!0}),n=function(){h.data=u=++u%2}}else if(l.setImmediate||l.MessageChannel===void 0)n="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var c=l.document.createElement("script");c.onreadystatechange=function(){p(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},l.document.documentElement.appendChild(c)}:function(){setTimeout(p,0)};else{var g=new l.MessageChannel;g.port1.onmessage=p,n=function(){g.port2.postMessage(0)}}var o=[];function p(){var c,f;s=!0;for(var d=o.length;d;){for(f=o,o=[],c=-1;++c<d;)f[c]();d=o.length}s=!1}v.exports=function(c){o.push(c)!==1||s||n()}}).call(this,typeof Ve<"u"?Ve:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,v,y){var l=t("immediate");function n(){}var s={},i=["REJECTED"],u=["FULFILLED"],m=["PENDING"];function h(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,d!==n&&c(this,d)}function g(d,x,j){this.promise=d,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function o(d,x,j){l(function(){var I;try{I=x(j)}catch(N){return s.reject(d,N)}I===d?s.reject(d,new TypeError("Cannot resolve promise with itself")):s.resolve(d,I)})}function p(d){var x=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof x=="function")return function(){x.apply(d,arguments)}}function c(d,x){var j=!1;function I(L){j||(j=!0,s.reject(d,L))}function N(L){j||(j=!0,s.resolve(d,L))}var H=f(function(){x(N,I)});H.status==="error"&&I(H.value)}function f(d,x){var j={};try{j.value=d(x),j.status="success"}catch(I){j.status="error",j.value=I}return j}(v.exports=h).prototype.finally=function(d){if(typeof d!="function")return this;var x=this.constructor;return this.then(function(j){return x.resolve(d()).then(function(){return j})},function(j){return x.resolve(d()).then(function(){throw j})})},h.prototype.catch=function(d){return this.then(null,d)},h.prototype.then=function(d,x){if(typeof d!="function"&&this.state===u||typeof x!="function"&&this.state===i)return this;var j=new this.constructor(n);return this.state!==m?o(j,this.state===u?d:x,this.outcome):this.queue.push(new g(j,d,x)),j},g.prototype.callFulfilled=function(d){s.resolve(this.promise,d)},g.prototype.otherCallFulfilled=function(d){o(this.promise,this.onFulfilled,d)},g.prototype.callRejected=function(d){s.reject(this.promise,d)},g.prototype.otherCallRejected=function(d){o(this.promise,this.onRejected,d)},s.resolve=function(d,x){var j=f(p,x);if(j.status==="error")return s.reject(d,j.value);var I=j.value;if(I)c(d,I);else{d.state=u,d.outcome=x;for(var N=-1,H=d.queue.length;++N<H;)d.queue[N].callFulfilled(x)}return d},s.reject=function(d,x){d.state=i,d.outcome=x;for(var j=-1,I=d.queue.length;++j<I;)d.queue[j].callRejected(x);return d},h.resolve=function(d){return d instanceof this?d:s.resolve(new this(n),d)},h.reject=function(d){var x=new this(n);return s.reject(x,d)},h.all=function(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=d.length,I=!1;if(!j)return this.resolve([]);for(var N=new Array(j),H=0,L=-1,Z=new this(n);++L<j;)F(d[L],L);return Z;function F(R,X){x.resolve(R).then(function(k){N[X]=k,++H!==j||I||(I=!0,s.resolve(Z,N))},function(k){I||(I=!0,s.reject(Z,k))})}},h.race=function(d){var x=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=d.length,I=!1;if(!j)return this.resolve([]);for(var N=-1,H=new this(n);++N<j;)L=d[N],x.resolve(L).then(function(Z){I||(I=!0,s.resolve(H,Z))},function(Z){I||(I=!0,s.reject(H,Z))});var L;return H}},{immediate:36}],38:[function(t,v,y){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),v.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,v,y){var l=t("./zlib/deflate"),n=t("./utils/common"),s=t("./utils/strings"),i=t("./zlib/messages"),u=t("./zlib/zstream"),m=Object.prototype.toString,h=0,g=-1,o=0,p=8;function c(d){if(!(this instanceof c))return new c(d);this.options=n.assign({level:g,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:o,to:""},d||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var j=l.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(j!==h)throw new Error(i[j]);if(x.header&&l.deflateSetHeader(this.strm,x.header),x.dictionary){var I;if(I=typeof x.dictionary=="string"?s.string2buf(x.dictionary):m.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(j=l.deflateSetDictionary(this.strm,I))!==h)throw new Error(i[j]);this._dict_set=!0}}function f(d,x){var j=new c(x);if(j.push(d,!0),j.err)throw j.msg||i[j.err];return j.result}c.prototype.push=function(d,x){var j,I,N=this.strm,H=this.options.chunkSize;if(this.ended)return!1;I=x===~~x?x:x===!0?4:0,typeof d=="string"?N.input=s.string2buf(d):m.call(d)==="[object ArrayBuffer]"?N.input=new Uint8Array(d):N.input=d,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new n.Buf8(H),N.next_out=0,N.avail_out=H),(j=l.deflate(N,I))!==1&&j!==h)return this.onEnd(j),!(this.ended=!0);N.avail_out!==0&&(N.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(N.output,N.next_out))):this.onData(n.shrinkBuf(N.output,N.next_out)))}while((0<N.avail_in||N.avail_out===0)&&j!==1);return I===4?(j=l.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===h):I!==2||(this.onEnd(h),!(N.avail_out=0))},c.prototype.onData=function(d){this.chunks.push(d)},c.prototype.onEnd=function(d){d===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},y.Deflate=c,y.deflate=f,y.deflateRaw=function(d,x){return(x=x||{}).raw=!0,f(d,x)},y.gzip=function(d,x){return(x=x||{}).gzip=!0,f(d,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,v,y){var l=t("./zlib/inflate"),n=t("./utils/common"),s=t("./utils/strings"),i=t("./zlib/constants"),u=t("./zlib/messages"),m=t("./zlib/zstream"),h=t("./zlib/gzheader"),g=Object.prototype.toString;function o(c){if(!(this instanceof o))return new o(c);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},c||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,f.windowBits===0&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||c&&c.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&(15&f.windowBits)==0&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var d=l.inflateInit2(this.strm,f.windowBits);if(d!==i.Z_OK)throw new Error(u[d]);this.header=new h,l.inflateGetHeader(this.strm,this.header)}function p(c,f){var d=new o(f);if(d.push(c,!0),d.err)throw d.msg||u[d.err];return d.result}o.prototype.push=function(c,f){var d,x,j,I,N,H,L=this.strm,Z=this.options.chunkSize,F=this.options.dictionary,R=!1;if(this.ended)return!1;x=f===~~f?f:f===!0?i.Z_FINISH:i.Z_NO_FLUSH,typeof c=="string"?L.input=s.binstring2buf(c):g.call(c)==="[object ArrayBuffer]"?L.input=new Uint8Array(c):L.input=c,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new n.Buf8(Z),L.next_out=0,L.avail_out=Z),(d=l.inflate(L,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&F&&(H=typeof F=="string"?s.string2buf(F):g.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,d=l.inflateSetDictionary(this.strm,H)),d===i.Z_BUF_ERROR&&R===!0&&(d=i.Z_OK,R=!1),d!==i.Z_STREAM_END&&d!==i.Z_OK)return this.onEnd(d),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&d!==i.Z_STREAM_END&&(L.avail_in!==0||x!==i.Z_FINISH&&x!==i.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=s.utf8border(L.output,L.next_out),I=L.next_out-j,N=s.buf2string(L.output,j),L.next_out=I,L.avail_out=Z-I,I&&n.arraySet(L.output,L.output,j,I,0),this.onData(N)):this.onData(n.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(R=!0)}while((0<L.avail_in||L.avail_out===0)&&d!==i.Z_STREAM_END);return d===i.Z_STREAM_END&&(x=i.Z_FINISH),x===i.Z_FINISH?(d=l.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===i.Z_OK):x!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(L.avail_out=0))},o.prototype.onData=function(c){this.chunks.push(c)},o.prototype.onEnd=function(c){c===i.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},y.Inflate=o,y.inflate=p,y.inflateRaw=function(c,f){return(f=f||{}).raw=!0,p(c,f)},y.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,v,y){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";y.assign=function(i){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var m=u.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var h in m)m.hasOwnProperty(h)&&(i[h]=m[h])}}return i},y.shrinkBuf=function(i,u){return i.length===u?i:i.subarray?i.subarray(0,u):(i.length=u,i)};var n={arraySet:function(i,u,m,h,g){if(u.subarray&&i.subarray)i.set(u.subarray(m,m+h),g);else for(var o=0;o<h;o++)i[g+o]=u[m+o]},flattenChunks:function(i){var u,m,h,g,o,p;for(u=h=0,m=i.length;u<m;u++)h+=i[u].length;for(p=new Uint8Array(h),u=g=0,m=i.length;u<m;u++)o=i[u],p.set(o,g),g+=o.length;return p}},s={arraySet:function(i,u,m,h,g){for(var o=0;o<h;o++)i[g+o]=u[m+o]},flattenChunks:function(i){return[].concat.apply([],i)}};y.setTyped=function(i){i?(y.Buf8=Uint8Array,y.Buf16=Uint16Array,y.Buf32=Int32Array,y.assign(y,n)):(y.Buf8=Array,y.Buf16=Array,y.Buf32=Array,y.assign(y,s))},y.setTyped(l)},{}],42:[function(t,v,y){var l=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var i=new l.Buf8(256),u=0;u<256;u++)i[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function m(h,g){if(g<65537&&(h.subarray&&s||!h.subarray&&n))return String.fromCharCode.apply(null,l.shrinkBuf(h,g));for(var o="",p=0;p<g;p++)o+=String.fromCharCode(h[p]);return o}i[254]=i[254]=1,y.string2buf=function(h){var g,o,p,c,f,d=h.length,x=0;for(c=0;c<d;c++)(64512&(o=h.charCodeAt(c)))==55296&&c+1<d&&(64512&(p=h.charCodeAt(c+1)))==56320&&(o=65536+(o-55296<<10)+(p-56320),c++),x+=o<128?1:o<2048?2:o<65536?3:4;for(g=new l.Buf8(x),c=f=0;f<x;c++)(64512&(o=h.charCodeAt(c)))==55296&&c+1<d&&(64512&(p=h.charCodeAt(c+1)))==56320&&(o=65536+(o-55296<<10)+(p-56320),c++),o<128?g[f++]=o:(o<2048?g[f++]=192|o>>>6:(o<65536?g[f++]=224|o>>>12:(g[f++]=240|o>>>18,g[f++]=128|o>>>12&63),g[f++]=128|o>>>6&63),g[f++]=128|63&o);return g},y.buf2binstring=function(h){return m(h,h.length)},y.binstring2buf=function(h){for(var g=new l.Buf8(h.length),o=0,p=g.length;o<p;o++)g[o]=h.charCodeAt(o);return g},y.buf2string=function(h,g){var o,p,c,f,d=g||h.length,x=new Array(2*d);for(o=p=0;o<d;)if((c=h[o++])<128)x[p++]=c;else if(4<(f=i[c]))x[p++]=65533,o+=f-1;else{for(c&=f===2?31:f===3?15:7;1<f&&o<d;)c=c<<6|63&h[o++],f--;1<f?x[p++]=65533:c<65536?x[p++]=c:(c-=65536,x[p++]=55296|c>>10&1023,x[p++]=56320|1023&c)}return m(x,p)},y.utf8border=function(h,g){var o;for((g=g||h.length)>h.length&&(g=h.length),o=g-1;0<=o&&(192&h[o])==128;)o--;return o<0||o===0?g:o+i[h[o]]>g?o:g}},{"./common":41}],43:[function(t,v,y){v.exports=function(l,n,s,i){for(var u=65535&l|0,m=l>>>16&65535|0,h=0;s!==0;){for(s-=h=2e3<s?2e3:s;m=m+(u=u+n[i++]|0)|0,--h;);u%=65521,m%=65521}return u|m<<16|0}},{}],44:[function(t,v,y){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,v,y){var l=(function(){for(var n,s=[],i=0;i<256;i++){n=i;for(var u=0;u<8;u++)n=1&n?3988292384^n>>>1:n>>>1;s[i]=n}return s})();v.exports=function(n,s,i,u){var m=l,h=u+i;n^=-1;for(var g=u;g<h;g++)n=n>>>8^m[255&(n^s[g])];return-1^n}},{}],46:[function(t,v,y){var l,n=t("../utils/common"),s=t("./trees"),i=t("./adler32"),u=t("./crc32"),m=t("./messages"),h=0,g=4,o=0,p=-2,c=-1,f=4,d=2,x=8,j=9,I=286,N=30,H=19,L=2*I+1,Z=15,F=3,R=258,X=R+F+1,k=42,U=113,a=1,_=2,S=3,C=4;function re(r,W){return r.msg=m[W],W}function G(r){return(r<<1)-(4<r?9:0)}function q(r){for(var W=r.length;0<=--W;)r[W]=0}function z(r){var W=r.state,M=W.pending;M>r.avail_out&&(M=r.avail_out),M!==0&&(n.arraySet(r.output,W.pending_buf,W.pending_out,M,r.next_out),r.next_out+=M,W.pending_out+=M,r.total_out+=M,r.avail_out-=M,W.pending-=M,W.pending===0&&(W.pending_out=0))}function T(r,W){s._tr_flush_block(r,0<=r.block_start?r.block_start:-1,r.strstart-r.block_start,W),r.block_start=r.strstart,z(r.strm)}function ae(r,W){r.pending_buf[r.pending++]=W}function ne(r,W){r.pending_buf[r.pending++]=W>>>8&255,r.pending_buf[r.pending++]=255&W}function ee(r,W){var M,w,b=r.max_chain_length,A=r.strstart,V=r.prev_length,K=r.nice_match,D=r.strstart>r.w_size-X?r.strstart-(r.w_size-X):0,Q=r.window,oe=r.w_mask,te=r.prev,ce=r.strstart+R,O=Q[A+V-1],J=Q[A+V];r.prev_length>=r.good_match&&(b>>=2),K>r.lookahead&&(K=r.lookahead);do if(Q[(M=W)+V]===J&&Q[M+V-1]===O&&Q[M]===Q[A]&&Q[++M]===Q[A+1]){A+=2,M++;do;while(Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&Q[++A]===Q[++M]&&A<ce);if(w=R-(ce-A),A=ce-R,V<w){if(r.match_start=W,K<=(V=w))break;O=Q[A+V-1],J=Q[A+V]}}while((W=te[W&oe])>D&&--b!=0);return V<=r.lookahead?V:r.lookahead}function ue(r){var W,M,w,b,A,V,K,D,Q,oe,te=r.w_size;do{if(b=r.window_size-r.lookahead-r.strstart,r.strstart>=te+(te-X)){for(n.arraySet(r.window,r.window,te,te,0),r.match_start-=te,r.strstart-=te,r.block_start-=te,W=M=r.hash_size;w=r.head[--W],r.head[W]=te<=w?w-te:0,--M;);for(W=M=te;w=r.prev[--W],r.prev[W]=te<=w?w-te:0,--M;);b+=te}if(r.strm.avail_in===0)break;if(V=r.strm,K=r.window,D=r.strstart+r.lookahead,Q=b,oe=void 0,oe=V.avail_in,Q<oe&&(oe=Q),M=oe===0?0:(V.avail_in-=oe,n.arraySet(K,V.input,V.next_in,oe,D),V.state.wrap===1?V.adler=i(V.adler,K,oe,D):V.state.wrap===2&&(V.adler=u(V.adler,K,oe,D)),V.next_in+=oe,V.total_in+=oe,oe),r.lookahead+=M,r.lookahead+r.insert>=F)for(A=r.strstart-r.insert,r.ins_h=r.window[A],r.ins_h=(r.ins_h<<r.hash_shift^r.window[A+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[A+F-1])&r.hash_mask,r.prev[A&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=A,A++,r.insert--,!(r.lookahead+r.insert<F)););}while(r.lookahead<X&&r.strm.avail_in!==0)}function Ce(r,W){for(var M,w;;){if(r.lookahead<X){if(ue(r),r.lookahead<X&&W===h)return a;if(r.lookahead===0)break}if(M=0,r.lookahead>=F&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+F-1])&r.hash_mask,M=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),M!==0&&r.strstart-M<=r.w_size-X&&(r.match_length=ee(r,M)),r.match_length>=F)if(w=s._tr_tally(r,r.strstart-r.match_start,r.match_length-F),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=F){for(r.match_length--;r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+F-1])&r.hash_mask,M=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart,--r.match_length!=0;);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else w=s._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(w&&(T(r,!1),r.strm.avail_out===0))return a}return r.insert=r.strstart<F-1?r.strstart:F-1,W===g?(T(r,!0),r.strm.avail_out===0?S:C):r.last_lit&&(T(r,!1),r.strm.avail_out===0)?a:_}function he(r,W){for(var M,w,b;;){if(r.lookahead<X){if(ue(r),r.lookahead<X&&W===h)return a;if(r.lookahead===0)break}if(M=0,r.lookahead>=F&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+F-1])&r.hash_mask,M=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=F-1,M!==0&&r.prev_length<r.max_lazy_match&&r.strstart-M<=r.w_size-X&&(r.match_length=ee(r,M),r.match_length<=5&&(r.strategy===1||r.match_length===F&&4096<r.strstart-r.match_start)&&(r.match_length=F-1)),r.prev_length>=F&&r.match_length<=r.prev_length){for(b=r.strstart+r.lookahead-F,w=s._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-F),r.lookahead-=r.prev_length-1,r.prev_length-=2;++r.strstart<=b&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+F-1])&r.hash_mask,M=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),--r.prev_length!=0;);if(r.match_available=0,r.match_length=F-1,r.strstart++,w&&(T(r,!1),r.strm.avail_out===0))return a}else if(r.match_available){if((w=s._tr_tally(r,0,r.window[r.strstart-1]))&&T(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return a}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(w=s._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<F-1?r.strstart:F-1,W===g?(T(r,!0),r.strm.avail_out===0?S:C):r.last_lit&&(T(r,!1),r.strm.avail_out===0)?a:_}function ye(r,W,M,w,b){this.good_length=r,this.max_lazy=W,this.nice_length=M,this.max_chain=w,this.func=b}function xe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*L),this.dyn_dtree=new n.Buf16(2*(2*N+1)),this.bl_tree=new n.Buf16(2*(2*H+1)),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(Z+1),this.heap=new n.Buf16(2*I+1),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*I+1),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(r){var W;return r&&r.state?(r.total_in=r.total_out=0,r.data_type=d,(W=r.state).pending=0,W.pending_out=0,W.wrap<0&&(W.wrap=-W.wrap),W.status=W.wrap?k:U,r.adler=W.wrap===2?0:1,W.last_flush=h,s._tr_init(W),o):re(r,p)}function Te(r){var W=Se(r);return W===o&&(function(M){M.window_size=2*M.w_size,q(M.head),M.max_lazy_match=l[M.level].max_lazy,M.good_match=l[M.level].good_length,M.nice_match=l[M.level].nice_length,M.max_chain_length=l[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=F-1,M.match_available=0,M.ins_h=0})(r.state),W}function Ae(r,W,M,w,b,A){if(!r)return p;var V=1;if(W===c&&(W=6),w<0?(V=0,w=-w):15<w&&(V=2,w-=16),b<1||j<b||M!==x||w<8||15<w||W<0||9<W||A<0||f<A)return re(r,p);w===8&&(w=9);var K=new xe;return(r.state=K).strm=r,K.wrap=V,K.gzhead=null,K.w_bits=w,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=b+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+F-1)/F),K.window=new n.Buf8(2*K.w_size),K.head=new n.Buf16(K.hash_size),K.prev=new n.Buf16(K.w_size),K.lit_bufsize=1<<b+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new n.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=W,K.strategy=A,K.method=M,Te(r)}l=[new ye(0,0,0,0,function(r,W){var M=65535;for(M>r.pending_buf_size-5&&(M=r.pending_buf_size-5);;){if(r.lookahead<=1){if(ue(r),r.lookahead===0&&W===h)return a;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var w=r.block_start+M;if((r.strstart===0||r.strstart>=w)&&(r.lookahead=r.strstart-w,r.strstart=w,T(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-X&&(T(r,!1),r.strm.avail_out===0))return a}return r.insert=0,W===g?(T(r,!0),r.strm.avail_out===0?S:C):(r.strstart>r.block_start&&(T(r,!1),r.strm.avail_out),a)}),new ye(4,4,8,4,Ce),new ye(4,5,16,8,Ce),new ye(4,6,32,32,Ce),new ye(4,4,16,16,he),new ye(8,16,32,32,he),new ye(8,16,128,128,he),new ye(8,32,128,256,he),new ye(32,128,258,1024,he),new ye(32,258,258,4096,he)],y.deflateInit=function(r,W){return Ae(r,W,x,15,8,0)},y.deflateInit2=Ae,y.deflateReset=Te,y.deflateResetKeep=Se,y.deflateSetHeader=function(r,W){return r&&r.state?r.state.wrap!==2?p:(r.state.gzhead=W,o):p},y.deflate=function(r,W){var M,w,b,A;if(!r||!r.state||5<W||W<0)return r?re(r,p):p;if(w=r.state,!r.output||!r.input&&r.avail_in!==0||w.status===666&&W!==g)return re(r,r.avail_out===0?-5:p);if(w.strm=r,M=w.last_flush,w.last_flush=W,w.status===k)if(w.wrap===2)r.adler=0,ae(w,31),ae(w,139),ae(w,8),w.gzhead?(ae(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),ae(w,255&w.gzhead.time),ae(w,w.gzhead.time>>8&255),ae(w,w.gzhead.time>>16&255),ae(w,w.gzhead.time>>24&255),ae(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),ae(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(ae(w,255&w.gzhead.extra.length),ae(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(r.adler=u(r.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(ae(w,0),ae(w,0),ae(w,0),ae(w,0),ae(w,0),ae(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),ae(w,3),w.status=U);else{var V=x+(w.w_bits-8<<4)<<8;V|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(V|=32),V+=31-V%31,w.status=U,ne(w,V),w.strstart!==0&&(ne(w,r.adler>>>16),ne(w,65535&r.adler)),r.adler=1}if(w.status===69)if(w.gzhead.extra){for(b=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),z(r),b=w.pending,w.pending!==w.pending_buf_size));)ae(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){b=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),z(r),b=w.pending,w.pending===w.pending_buf_size)){A=1;break}A=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,ae(w,A)}while(A!==0);w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),A===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){b=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),z(r),b=w.pending,w.pending===w.pending_buf_size)){A=1;break}A=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,ae(w,A)}while(A!==0);w.gzhead.hcrc&&w.pending>b&&(r.adler=u(r.adler,w.pending_buf,w.pending-b,b)),A===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&z(r),w.pending+2<=w.pending_buf_size&&(ae(w,255&r.adler),ae(w,r.adler>>8&255),r.adler=0,w.status=U)):w.status=U),w.pending!==0){if(z(r),r.avail_out===0)return w.last_flush=-1,o}else if(r.avail_in===0&&G(W)<=G(M)&&W!==g)return re(r,-5);if(w.status===666&&r.avail_in!==0)return re(r,-5);if(r.avail_in!==0||w.lookahead!==0||W!==h&&w.status!==666){var K=w.strategy===2?(function(D,Q){for(var oe;;){if(D.lookahead===0&&(ue(D),D.lookahead===0)){if(Q===h)return a;break}if(D.match_length=0,oe=s._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++,oe&&(T(D,!1),D.strm.avail_out===0))return a}return D.insert=0,Q===g?(T(D,!0),D.strm.avail_out===0?S:C):D.last_lit&&(T(D,!1),D.strm.avail_out===0)?a:_})(w,W):w.strategy===3?(function(D,Q){for(var oe,te,ce,O,J=D.window;;){if(D.lookahead<=R){if(ue(D),D.lookahead<=R&&Q===h)return a;if(D.lookahead===0)break}if(D.match_length=0,D.lookahead>=F&&0<D.strstart&&(te=J[ce=D.strstart-1])===J[++ce]&&te===J[++ce]&&te===J[++ce]){O=D.strstart+R;do;while(te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&te===J[++ce]&&ce<O);D.match_length=R-(O-ce),D.match_length>D.lookahead&&(D.match_length=D.lookahead)}if(D.match_length>=F?(oe=s._tr_tally(D,1,D.match_length-F),D.lookahead-=D.match_length,D.strstart+=D.match_length,D.match_length=0):(oe=s._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++),oe&&(T(D,!1),D.strm.avail_out===0))return a}return D.insert=0,Q===g?(T(D,!0),D.strm.avail_out===0?S:C):D.last_lit&&(T(D,!1),D.strm.avail_out===0)?a:_})(w,W):l[w.level].func(w,W);if(K!==S&&K!==C||(w.status=666),K===a||K===S)return r.avail_out===0&&(w.last_flush=-1),o;if(K===_&&(W===1?s._tr_align(w):W!==5&&(s._tr_stored_block(w,0,0,!1),W===3&&(q(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),z(r),r.avail_out===0))return w.last_flush=-1,o}return W!==g?o:w.wrap<=0?1:(w.wrap===2?(ae(w,255&r.adler),ae(w,r.adler>>8&255),ae(w,r.adler>>16&255),ae(w,r.adler>>24&255),ae(w,255&r.total_in),ae(w,r.total_in>>8&255),ae(w,r.total_in>>16&255),ae(w,r.total_in>>24&255)):(ne(w,r.adler>>>16),ne(w,65535&r.adler)),z(r),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?o:1)},y.deflateEnd=function(r){var W;return r&&r.state?(W=r.state.status)!==k&&W!==69&&W!==73&&W!==91&&W!==103&&W!==U&&W!==666?re(r,p):(r.state=null,W===U?re(r,-3):o):p},y.deflateSetDictionary=function(r,W){var M,w,b,A,V,K,D,Q,oe=W.length;if(!r||!r.state||(A=(M=r.state).wrap)===2||A===1&&M.status!==k||M.lookahead)return p;for(A===1&&(r.adler=i(r.adler,W,oe,0)),M.wrap=0,oe>=M.w_size&&(A===0&&(q(M.head),M.strstart=0,M.block_start=0,M.insert=0),Q=new n.Buf8(M.w_size),n.arraySet(Q,W,oe-M.w_size,M.w_size,0),W=Q,oe=M.w_size),V=r.avail_in,K=r.next_in,D=r.input,r.avail_in=oe,r.next_in=0,r.input=W,ue(M);M.lookahead>=F;){for(w=M.strstart,b=M.lookahead-(F-1);M.ins_h=(M.ins_h<<M.hash_shift^M.window[w+F-1])&M.hash_mask,M.prev[w&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=w,w++,--b;);M.strstart=w,M.lookahead=F-1,ue(M)}return M.strstart+=M.lookahead,M.block_start=M.strstart,M.insert=M.lookahead,M.lookahead=0,M.match_length=M.prev_length=F-1,M.match_available=0,r.next_in=K,r.input=D,r.avail_in=V,M.wrap=A,o},y.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,v,y){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,v,y){v.exports=function(l,n){var s,i,u,m,h,g,o,p,c,f,d,x,j,I,N,H,L,Z,F,R,X,k,U,a,_;s=l.state,i=l.next_in,a=l.input,u=i+(l.avail_in-5),m=l.next_out,_=l.output,h=m-(n-l.avail_out),g=m+(l.avail_out-257),o=s.dmax,p=s.wsize,c=s.whave,f=s.wnext,d=s.window,x=s.hold,j=s.bits,I=s.lencode,N=s.distcode,H=(1<<s.lenbits)-1,L=(1<<s.distbits)-1;e:do{j<15&&(x+=a[i++]<<j,j+=8,x+=a[i++]<<j,j+=8),Z=I[x&H];t:for(;;){if(x>>>=F=Z>>>24,j-=F,(F=Z>>>16&255)===0)_[m++]=65535&Z;else{if(!(16&F)){if((64&F)==0){Z=I[(65535&Z)+(x&(1<<F)-1)];continue t}if(32&F){s.mode=12;break e}l.msg="invalid literal/length code",s.mode=30;break e}R=65535&Z,(F&=15)&&(j<F&&(x+=a[i++]<<j,j+=8),R+=x&(1<<F)-1,x>>>=F,j-=F),j<15&&(x+=a[i++]<<j,j+=8,x+=a[i++]<<j,j+=8),Z=N[x&L];r:for(;;){if(x>>>=F=Z>>>24,j-=F,!(16&(F=Z>>>16&255))){if((64&F)==0){Z=N[(65535&Z)+(x&(1<<F)-1)];continue r}l.msg="invalid distance code",s.mode=30;break e}if(X=65535&Z,j<(F&=15)&&(x+=a[i++]<<j,(j+=8)<F&&(x+=a[i++]<<j,j+=8)),o<(X+=x&(1<<F)-1)){l.msg="invalid distance too far back",s.mode=30;break e}if(x>>>=F,j-=F,(F=m-h)<X){if(c<(F=X-F)&&s.sane){l.msg="invalid distance too far back",s.mode=30;break e}if(U=d,(k=0)===f){if(k+=p-F,F<R){for(R-=F;_[m++]=d[k++],--F;);k=m-X,U=_}}else if(f<F){if(k+=p+f-F,(F-=f)<R){for(R-=F;_[m++]=d[k++],--F;);if(k=0,f<R){for(R-=F=f;_[m++]=d[k++],--F;);k=m-X,U=_}}}else if(k+=f-F,F<R){for(R-=F;_[m++]=d[k++],--F;);k=m-X,U=_}for(;2<R;)_[m++]=U[k++],_[m++]=U[k++],_[m++]=U[k++],R-=3;R&&(_[m++]=U[k++],1<R&&(_[m++]=U[k++]))}else{for(k=m-X;_[m++]=_[k++],_[m++]=_[k++],_[m++]=_[k++],2<(R-=3););R&&(_[m++]=_[k++],1<R&&(_[m++]=_[k++]))}break}}break}}while(i<u&&m<g);i-=R=j>>3,x&=(1<<(j-=R<<3))-1,l.next_in=i,l.next_out=m,l.avail_in=i<u?u-i+5:5-(i-u),l.avail_out=m<g?g-m+257:257-(m-g),s.hold=x,s.bits=j}},{}],49:[function(t,v,y){var l=t("../utils/common"),n=t("./adler32"),s=t("./crc32"),i=t("./inffast"),u=t("./inftrees"),m=1,h=2,g=0,o=-2,p=1,c=852,f=592;function d(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(k){var U;return k&&k.state?(U=k.state,k.total_in=k.total_out=U.total=0,k.msg="",U.wrap&&(k.adler=1&U.wrap),U.mode=p,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new l.Buf32(c),U.distcode=U.distdyn=new l.Buf32(f),U.sane=1,U.back=-1,g):o}function I(k){var U;return k&&k.state?((U=k.state).wsize=0,U.whave=0,U.wnext=0,j(k)):o}function N(k,U){var a,_;return k&&k.state?(_=k.state,U<0?(a=0,U=-U):(a=1+(U>>4),U<48&&(U&=15)),U&&(U<8||15<U)?o:(_.window!==null&&_.wbits!==U&&(_.window=null),_.wrap=a,_.wbits=U,I(k))):o}function H(k,U){var a,_;return k?(_=new x,(k.state=_).window=null,(a=N(k,U))!==g&&(k.state=null),a):o}var L,Z,F=!0;function R(k){if(F){var U;for(L=new l.Buf32(512),Z=new l.Buf32(32),U=0;U<144;)k.lens[U++]=8;for(;U<256;)k.lens[U++]=9;for(;U<280;)k.lens[U++]=7;for(;U<288;)k.lens[U++]=8;for(u(m,k.lens,0,288,L,0,k.work,{bits:9}),U=0;U<32;)k.lens[U++]=5;u(h,k.lens,0,32,Z,0,k.work,{bits:5}),F=!1}k.lencode=L,k.lenbits=9,k.distcode=Z,k.distbits=5}function X(k,U,a,_){var S,C=k.state;return C.window===null&&(C.wsize=1<<C.wbits,C.wnext=0,C.whave=0,C.window=new l.Buf8(C.wsize)),_>=C.wsize?(l.arraySet(C.window,U,a-C.wsize,C.wsize,0),C.wnext=0,C.whave=C.wsize):(_<(S=C.wsize-C.wnext)&&(S=_),l.arraySet(C.window,U,a-_,S,C.wnext),(_-=S)?(l.arraySet(C.window,U,a-_,_,0),C.wnext=_,C.whave=C.wsize):(C.wnext+=S,C.wnext===C.wsize&&(C.wnext=0),C.whave<C.wsize&&(C.whave+=S))),0}y.inflateReset=I,y.inflateReset2=N,y.inflateResetKeep=j,y.inflateInit=function(k){return H(k,15)},y.inflateInit2=H,y.inflate=function(k,U){var a,_,S,C,re,G,q,z,T,ae,ne,ee,ue,Ce,he,ye,xe,Se,Te,Ae,r,W,M,w,b=0,A=new l.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return o;(a=k.state).mode===12&&(a.mode=13),re=k.next_out,S=k.output,q=k.avail_out,C=k.next_in,_=k.input,G=k.avail_in,z=a.hold,T=a.bits,ae=G,ne=q,W=g;e:for(;;)switch(a.mode){case p:if(a.wrap===0){a.mode=13;break}for(;T<16;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(2&a.wrap&&z===35615){A[a.check=0]=255&z,A[1]=z>>>8&255,a.check=s(a.check,A,2,0),T=z=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&z)<<8)+(z>>8))%31){k.msg="incorrect header check",a.mode=30;break}if((15&z)!=8){k.msg="unknown compression method",a.mode=30;break}if(T-=4,r=8+(15&(z>>>=4)),a.wbits===0)a.wbits=r;else if(r>a.wbits){k.msg="invalid window size",a.mode=30;break}a.dmax=1<<r,k.adler=a.check=1,a.mode=512&z?10:12,T=z=0;break;case 2:for(;T<16;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(a.flags=z,(255&a.flags)!=8){k.msg="unknown compression method",a.mode=30;break}if(57344&a.flags){k.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=z>>8&1),512&a.flags&&(A[0]=255&z,A[1]=z>>>8&255,a.check=s(a.check,A,2,0)),T=z=0,a.mode=3;case 3:for(;T<32;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.head&&(a.head.time=z),512&a.flags&&(A[0]=255&z,A[1]=z>>>8&255,A[2]=z>>>16&255,A[3]=z>>>24&255,a.check=s(a.check,A,4,0)),T=z=0,a.mode=4;case 4:for(;T<16;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.head&&(a.head.xflags=255&z,a.head.os=z>>8),512&a.flags&&(A[0]=255&z,A[1]=z>>>8&255,a.check=s(a.check,A,2,0)),T=z=0,a.mode=5;case 5:if(1024&a.flags){for(;T<16;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.length=z,a.head&&(a.head.extra_len=z),512&a.flags&&(A[0]=255&z,A[1]=z>>>8&255,a.check=s(a.check,A,2,0)),T=z=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&(G<(ee=a.length)&&(ee=G),ee&&(a.head&&(r=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),l.arraySet(a.head.extra,_,C,ee,r)),512&a.flags&&(a.check=s(a.check,_,ee,C)),G-=ee,C+=ee,a.length-=ee),a.length))break e;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(G===0)break e;for(ee=0;r=_[C+ee++],a.head&&r&&a.length<65536&&(a.head.name+=String.fromCharCode(r)),r&&ee<G;);if(512&a.flags&&(a.check=s(a.check,_,ee,C)),G-=ee,C+=ee,r)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(G===0)break e;for(ee=0;r=_[C+ee++],a.head&&r&&a.length<65536&&(a.head.comment+=String.fromCharCode(r)),r&&ee<G;);if(512&a.flags&&(a.check=s(a.check,_,ee,C)),G-=ee,C+=ee,r)break e}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;T<16;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(z!==(65535&a.check)){k.msg="header crc mismatch",a.mode=30;break}T=z=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),k.adler=a.check=0,a.mode=12;break;case 10:for(;T<32;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}k.adler=a.check=d(z),T=z=0,a.mode=11;case 11:if(a.havedict===0)return k.next_out=re,k.avail_out=q,k.next_in=C,k.avail_in=G,a.hold=z,a.bits=T,2;k.adler=a.check=1,a.mode=12;case 12:if(U===5||U===6)break e;case 13:if(a.last){z>>>=7&T,T-=7&T,a.mode=27;break}for(;T<3;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}switch(a.last=1&z,T-=1,3&(z>>>=1)){case 0:a.mode=14;break;case 1:if(R(a),a.mode=20,U!==6)break;z>>>=2,T-=2;break e;case 2:a.mode=17;break;case 3:k.msg="invalid block type",a.mode=30}z>>>=2,T-=2;break;case 14:for(z>>>=7&T,T-=7&T;T<32;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if((65535&z)!=(z>>>16^65535)){k.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&z,T=z=0,a.mode=15,U===6)break e;case 15:a.mode=16;case 16:if(ee=a.length){if(G<ee&&(ee=G),q<ee&&(ee=q),ee===0)break e;l.arraySet(S,_,C,ee,re),G-=ee,C+=ee,q-=ee,re+=ee,a.length-=ee;break}a.mode=12;break;case 17:for(;T<14;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(a.nlen=257+(31&z),z>>>=5,T-=5,a.ndist=1+(31&z),z>>>=5,T-=5,a.ncode=4+(15&z),z>>>=4,T-=4,286<a.nlen||30<a.ndist){k.msg="too many length or distance symbols",a.mode=30;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;T<3;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.lens[V[a.have++]]=7&z,z>>>=3,T-=3}for(;a.have<19;)a.lens[V[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,M={bits:a.lenbits},W=u(0,a.lens,0,19,a.lencode,0,a.work,M),a.lenbits=M.bits,W){k.msg="invalid code lengths set",a.mode=30;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;ye=(b=a.lencode[z&(1<<a.lenbits)-1])>>>16&255,xe=65535&b,!((he=b>>>24)<=T);){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(xe<16)z>>>=he,T-=he,a.lens[a.have++]=xe;else{if(xe===16){for(w=he+2;T<w;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(z>>>=he,T-=he,a.have===0){k.msg="invalid bit length repeat",a.mode=30;break}r=a.lens[a.have-1],ee=3+(3&z),z>>>=2,T-=2}else if(xe===17){for(w=he+3;T<w;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}T-=he,r=0,ee=3+(7&(z>>>=he)),z>>>=3,T-=3}else{for(w=he+7;T<w;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}T-=he,r=0,ee=11+(127&(z>>>=he)),z>>>=7,T-=7}if(a.have+ee>a.nlen+a.ndist){k.msg="invalid bit length repeat",a.mode=30;break}for(;ee--;)a.lens[a.have++]=r}}if(a.mode===30)break;if(a.lens[256]===0){k.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.lenbits=9,M={bits:a.lenbits},W=u(m,a.lens,0,a.nlen,a.lencode,0,a.work,M),a.lenbits=M.bits,W){k.msg="invalid literal/lengths set",a.mode=30;break}if(a.distbits=6,a.distcode=a.distdyn,M={bits:a.distbits},W=u(h,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,M),a.distbits=M.bits,W){k.msg="invalid distances set",a.mode=30;break}if(a.mode=20,U===6)break e;case 20:a.mode=21;case 21:if(6<=G&&258<=q){k.next_out=re,k.avail_out=q,k.next_in=C,k.avail_in=G,a.hold=z,a.bits=T,i(k,ne),re=k.next_out,S=k.output,q=k.avail_out,C=k.next_in,_=k.input,G=k.avail_in,z=a.hold,T=a.bits,a.mode===12&&(a.back=-1);break}for(a.back=0;ye=(b=a.lencode[z&(1<<a.lenbits)-1])>>>16&255,xe=65535&b,!((he=b>>>24)<=T);){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(ye&&(240&ye)==0){for(Se=he,Te=ye,Ae=xe;ye=(b=a.lencode[Ae+((z&(1<<Se+Te)-1)>>Se)])>>>16&255,xe=65535&b,!(Se+(he=b>>>24)<=T);){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}z>>>=Se,T-=Se,a.back+=Se}if(z>>>=he,T-=he,a.back+=he,a.length=xe,ye===0){a.mode=26;break}if(32&ye){a.back=-1,a.mode=12;break}if(64&ye){k.msg="invalid literal/length code",a.mode=30;break}a.extra=15&ye,a.mode=22;case 22:if(a.extra){for(w=a.extra;T<w;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.length+=z&(1<<a.extra)-1,z>>>=a.extra,T-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;ye=(b=a.distcode[z&(1<<a.distbits)-1])>>>16&255,xe=65535&b,!((he=b>>>24)<=T);){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if((240&ye)==0){for(Se=he,Te=ye,Ae=xe;ye=(b=a.distcode[Ae+((z&(1<<Se+Te)-1)>>Se)])>>>16&255,xe=65535&b,!(Se+(he=b>>>24)<=T);){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}z>>>=Se,T-=Se,a.back+=Se}if(z>>>=he,T-=he,a.back+=he,64&ye){k.msg="invalid distance code",a.mode=30;break}a.offset=xe,a.extra=15&ye,a.mode=24;case 24:if(a.extra){for(w=a.extra;T<w;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}a.offset+=z&(1<<a.extra)-1,z>>>=a.extra,T-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){k.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(q===0)break e;if(ee=ne-q,a.offset>ee){if((ee=a.offset-ee)>a.whave&&a.sane){k.msg="invalid distance too far back",a.mode=30;break}ue=ee>a.wnext?(ee-=a.wnext,a.wsize-ee):a.wnext-ee,ee>a.length&&(ee=a.length),Ce=a.window}else Ce=S,ue=re-a.offset,ee=a.length;for(q<ee&&(ee=q),q-=ee,a.length-=ee;S[re++]=Ce[ue++],--ee;);a.length===0&&(a.mode=21);break;case 26:if(q===0)break e;S[re++]=a.length,q--,a.mode=21;break;case 27:if(a.wrap){for(;T<32;){if(G===0)break e;G--,z|=_[C++]<<T,T+=8}if(ne-=q,k.total_out+=ne,a.total+=ne,ne&&(k.adler=a.check=a.flags?s(a.check,S,ne,re-ne):n(a.check,S,ne,re-ne)),ne=q,(a.flags?z:d(z))!==a.check){k.msg="incorrect data check",a.mode=30;break}T=z=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;T<32;){if(G===0)break e;G--,z+=_[C++]<<T,T+=8}if(z!==(4294967295&a.total)){k.msg="incorrect length check",a.mode=30;break}T=z=0}a.mode=29;case 29:W=1;break e;case 30:W=-3;break e;case 31:return-4;case 32:default:return o}return k.next_out=re,k.avail_out=q,k.next_in=C,k.avail_in=G,a.hold=z,a.bits=T,(a.wsize||ne!==k.avail_out&&a.mode<30&&(a.mode<27||U!==4))&&X(k,k.output,k.next_out,ne-k.avail_out)?(a.mode=31,-4):(ae-=k.avail_in,ne-=k.avail_out,k.total_in+=ae,k.total_out+=ne,a.total+=ne,a.wrap&&ne&&(k.adler=a.check=a.flags?s(a.check,S,ne,k.next_out-ne):n(a.check,S,ne,k.next_out-ne)),k.data_type=a.bits+(a.last?64:0)+(a.mode===12?128:0)+(a.mode===20||a.mode===15?256:0),(ae==0&&ne===0||U===4)&&W===g&&(W=-5),W)},y.inflateEnd=function(k){if(!k||!k.state)return o;var U=k.state;return U.window&&(U.window=null),k.state=null,g},y.inflateGetHeader=function(k,U){var a;return k&&k.state?(2&(a=k.state).wrap)==0?o:((a.head=U).done=!1,g):o},y.inflateSetDictionary=function(k,U){var a,_=U.length;return k&&k.state?(a=k.state).wrap!==0&&a.mode!==11?o:a.mode===11&&n(1,U,_,0)!==a.check?-3:X(k,U,_,_)?(a.mode=31,-4):(a.havedict=1,g):o},y.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,v,y){var l=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(m,h,g,o,p,c,f,d){var x,j,I,N,H,L,Z,F,R,X=d.bits,k=0,U=0,a=0,_=0,S=0,C=0,re=0,G=0,q=0,z=0,T=null,ae=0,ne=new l.Buf16(16),ee=new l.Buf16(16),ue=null,Ce=0;for(k=0;k<=15;k++)ne[k]=0;for(U=0;U<o;U++)ne[h[g+U]]++;for(S=X,_=15;1<=_&&ne[_]===0;_--);if(_<S&&(S=_),_===0)return p[c++]=20971520,p[c++]=20971520,d.bits=1,0;for(a=1;a<_&&ne[a]===0;a++);for(S<a&&(S=a),k=G=1;k<=15;k++)if(G<<=1,(G-=ne[k])<0)return-1;if(0<G&&(m===0||_!==1))return-1;for(ee[1]=0,k=1;k<15;k++)ee[k+1]=ee[k]+ne[k];for(U=0;U<o;U++)h[g+U]!==0&&(f[ee[h[g+U]]++]=U);if(L=m===0?(T=ue=f,19):m===1?(T=n,ae-=257,ue=s,Ce-=257,256):(T=i,ue=u,-1),k=a,H=c,re=U=z=0,I=-1,N=(q=1<<(C=S))-1,m===1&&852<q||m===2&&592<q)return 1;for(;;){for(Z=k-re,R=f[U]<L?(F=0,f[U]):f[U]>L?(F=ue[Ce+f[U]],T[ae+f[U]]):(F=96,0),x=1<<k-re,a=j=1<<C;p[H+(z>>re)+(j-=x)]=Z<<24|F<<16|R|0,j!==0;);for(x=1<<k-1;z&x;)x>>=1;if(x!==0?(z&=x-1,z+=x):z=0,U++,--ne[k]==0){if(k===_)break;k=h[g+f[U]]}if(S<k&&(z&N)!==I){for(re===0&&(re=S),H+=a,G=1<<(C=k-re);C+re<_&&!((G-=ne[C+re])<=0);)C++,G<<=1;if(q+=1<<C,m===1&&852<q||m===2&&592<q)return 1;p[I=z&N]=S<<24|C<<16|H-c|0}}return z!==0&&(p[H+z]=k-re<<24|64<<16|0),d.bits=S,0}},{"../utils/common":41}],51:[function(t,v,y){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,v,y){var l=t("../utils/common"),n=0,s=1;function i(b){for(var A=b.length;0<=--A;)b[A]=0}var u=0,m=29,h=256,g=h+1+m,o=30,p=19,c=2*g+1,f=15,d=16,x=7,j=256,I=16,N=17,H=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(2*(g+2));i(X);var k=new Array(2*o);i(k);var U=new Array(512);i(U);var a=new Array(256);i(a);var _=new Array(m);i(_);var S,C,re,G=new Array(o);function q(b,A,V,K,D){this.static_tree=b,this.extra_bits=A,this.extra_base=V,this.elems=K,this.max_length=D,this.has_stree=b&&b.length}function z(b,A){this.dyn_tree=b,this.max_code=0,this.stat_desc=A}function T(b){return b<256?U[b]:U[256+(b>>>7)]}function ae(b,A){b.pending_buf[b.pending++]=255&A,b.pending_buf[b.pending++]=A>>>8&255}function ne(b,A,V){b.bi_valid>d-V?(b.bi_buf|=A<<b.bi_valid&65535,ae(b,b.bi_buf),b.bi_buf=A>>d-b.bi_valid,b.bi_valid+=V-d):(b.bi_buf|=A<<b.bi_valid&65535,b.bi_valid+=V)}function ee(b,A,V){ne(b,V[2*A],V[2*A+1])}function ue(b,A){for(var V=0;V|=1&b,b>>>=1,V<<=1,0<--A;);return V>>>1}function Ce(b,A,V){var K,D,Q=new Array(f+1),oe=0;for(K=1;K<=f;K++)Q[K]=oe=oe+V[K-1]<<1;for(D=0;D<=A;D++){var te=b[2*D+1];te!==0&&(b[2*D]=ue(Q[te]++,te))}}function he(b){var A;for(A=0;A<g;A++)b.dyn_ltree[2*A]=0;for(A=0;A<o;A++)b.dyn_dtree[2*A]=0;for(A=0;A<p;A++)b.bl_tree[2*A]=0;b.dyn_ltree[2*j]=1,b.opt_len=b.static_len=0,b.last_lit=b.matches=0}function ye(b){8<b.bi_valid?ae(b,b.bi_buf):0<b.bi_valid&&(b.pending_buf[b.pending++]=b.bi_buf),b.bi_buf=0,b.bi_valid=0}function xe(b,A,V,K){var D=2*A,Q=2*V;return b[D]<b[Q]||b[D]===b[Q]&&K[A]<=K[V]}function Se(b,A,V){for(var K=b.heap[V],D=V<<1;D<=b.heap_len&&(D<b.heap_len&&xe(A,b.heap[D+1],b.heap[D],b.depth)&&D++,!xe(A,K,b.heap[D],b.depth));)b.heap[V]=b.heap[D],V=D,D<<=1;b.heap[V]=K}function Te(b,A,V){var K,D,Q,oe,te=0;if(b.last_lit!==0)for(;K=b.pending_buf[b.d_buf+2*te]<<8|b.pending_buf[b.d_buf+2*te+1],D=b.pending_buf[b.l_buf+te],te++,K===0?ee(b,D,A):(ee(b,(Q=a[D])+h+1,A),(oe=L[Q])!==0&&ne(b,D-=_[Q],oe),ee(b,Q=T(--K),V),(oe=Z[Q])!==0&&ne(b,K-=G[Q],oe)),te<b.last_lit;);ee(b,j,A)}function Ae(b,A){var V,K,D,Q=A.dyn_tree,oe=A.stat_desc.static_tree,te=A.stat_desc.has_stree,ce=A.stat_desc.elems,O=-1;for(b.heap_len=0,b.heap_max=c,V=0;V<ce;V++)Q[2*V]!==0?(b.heap[++b.heap_len]=O=V,b.depth[V]=0):Q[2*V+1]=0;for(;b.heap_len<2;)Q[2*(D=b.heap[++b.heap_len]=O<2?++O:0)]=1,b.depth[D]=0,b.opt_len--,te&&(b.static_len-=oe[2*D+1]);for(A.max_code=O,V=b.heap_len>>1;1<=V;V--)Se(b,Q,V);for(D=ce;V=b.heap[1],b.heap[1]=b.heap[b.heap_len--],Se(b,Q,1),K=b.heap[1],b.heap[--b.heap_max]=V,b.heap[--b.heap_max]=K,Q[2*D]=Q[2*V]+Q[2*K],b.depth[D]=(b.depth[V]>=b.depth[K]?b.depth[V]:b.depth[K])+1,Q[2*V+1]=Q[2*K+1]=D,b.heap[1]=D++,Se(b,Q,1),2<=b.heap_len;);b.heap[--b.heap_max]=b.heap[1],(function(J,be){var Ne,ze,Be,Ie,Oe,Je,Me=be.dyn_tree,nt=be.max_code,ht=be.stat_desc.static_tree,st=be.stat_desc.has_stree,Nt=be.stat_desc.extra_bits,ot=be.stat_desc.extra_base,Ke=be.stat_desc.max_length,qe=0;for(Ie=0;Ie<=f;Ie++)J.bl_count[Ie]=0;for(Me[2*J.heap[J.heap_max]+1]=0,Ne=J.heap_max+1;Ne<c;Ne++)Ke<(Ie=Me[2*Me[2*(ze=J.heap[Ne])+1]+1]+1)&&(Ie=Ke,qe++),Me[2*ze+1]=Ie,nt<ze||(J.bl_count[Ie]++,Oe=0,ot<=ze&&(Oe=Nt[ze-ot]),Je=Me[2*ze],J.opt_len+=Je*(Ie+Oe),st&&(J.static_len+=Je*(ht[2*ze+1]+Oe)));if(qe!==0){do{for(Ie=Ke-1;J.bl_count[Ie]===0;)Ie--;J.bl_count[Ie]--,J.bl_count[Ie+1]+=2,J.bl_count[Ke]--,qe-=2}while(0<qe);for(Ie=Ke;Ie!==0;Ie--)for(ze=J.bl_count[Ie];ze!==0;)nt<(Be=J.heap[--Ne])||(Me[2*Be+1]!==Ie&&(J.opt_len+=(Ie-Me[2*Be+1])*Me[2*Be],Me[2*Be+1]=Ie),ze--)}})(b,A),Ce(Q,O,b.bl_count)}function r(b,A,V){var K,D,Q=-1,oe=A[1],te=0,ce=7,O=4;for(oe===0&&(ce=138,O=3),A[2*(V+1)+1]=65535,K=0;K<=V;K++)D=oe,oe=A[2*(K+1)+1],++te<ce&&D===oe||(te<O?b.bl_tree[2*D]+=te:D!==0?(D!==Q&&b.bl_tree[2*D]++,b.bl_tree[2*I]++):te<=10?b.bl_tree[2*N]++:b.bl_tree[2*H]++,Q=D,O=(te=0)===oe?(ce=138,3):D===oe?(ce=6,3):(ce=7,4))}function W(b,A,V){var K,D,Q=-1,oe=A[1],te=0,ce=7,O=4;for(oe===0&&(ce=138,O=3),K=0;K<=V;K++)if(D=oe,oe=A[2*(K+1)+1],!(++te<ce&&D===oe)){if(te<O)for(;ee(b,D,b.bl_tree),--te!=0;);else D!==0?(D!==Q&&(ee(b,D,b.bl_tree),te--),ee(b,I,b.bl_tree),ne(b,te-3,2)):te<=10?(ee(b,N,b.bl_tree),ne(b,te-3,3)):(ee(b,H,b.bl_tree),ne(b,te-11,7));Q=D,O=(te=0)===oe?(ce=138,3):D===oe?(ce=6,3):(ce=7,4)}}i(G);var M=!1;function w(b,A,V,K){ne(b,(u<<1)+(K?1:0),3),(function(D,Q,oe,te){ye(D),ae(D,oe),ae(D,~oe),l.arraySet(D.pending_buf,D.window,Q,oe,D.pending),D.pending+=oe})(b,A,V)}y._tr_init=function(b){M||((function(){var A,V,K,D,Q,oe=new Array(f+1);for(D=K=0;D<m-1;D++)for(_[D]=K,A=0;A<1<<L[D];A++)a[K++]=D;for(a[K-1]=D,D=Q=0;D<16;D++)for(G[D]=Q,A=0;A<1<<Z[D];A++)U[Q++]=D;for(Q>>=7;D<o;D++)for(G[D]=Q<<7,A=0;A<1<<Z[D]-7;A++)U[256+Q++]=D;for(V=0;V<=f;V++)oe[V]=0;for(A=0;A<=143;)X[2*A+1]=8,A++,oe[8]++;for(;A<=255;)X[2*A+1]=9,A++,oe[9]++;for(;A<=279;)X[2*A+1]=7,A++,oe[7]++;for(;A<=287;)X[2*A+1]=8,A++,oe[8]++;for(Ce(X,g+1,oe),A=0;A<o;A++)k[2*A+1]=5,k[2*A]=ue(A,5);S=new q(X,L,h+1,g,f),C=new q(k,Z,0,o,f),re=new q(new Array(0),F,0,p,x)})(),M=!0),b.l_desc=new z(b.dyn_ltree,S),b.d_desc=new z(b.dyn_dtree,C),b.bl_desc=new z(b.bl_tree,re),b.bi_buf=0,b.bi_valid=0,he(b)},y._tr_stored_block=w,y._tr_flush_block=function(b,A,V,K){var D,Q,oe=0;0<b.level?(b.strm.data_type===2&&(b.strm.data_type=(function(te){var ce,O=4093624447;for(ce=0;ce<=31;ce++,O>>>=1)if(1&O&&te.dyn_ltree[2*ce]!==0)return n;if(te.dyn_ltree[18]!==0||te.dyn_ltree[20]!==0||te.dyn_ltree[26]!==0)return s;for(ce=32;ce<h;ce++)if(te.dyn_ltree[2*ce]!==0)return s;return n})(b)),Ae(b,b.l_desc),Ae(b,b.d_desc),oe=(function(te){var ce;for(r(te,te.dyn_ltree,te.l_desc.max_code),r(te,te.dyn_dtree,te.d_desc.max_code),Ae(te,te.bl_desc),ce=p-1;3<=ce&&te.bl_tree[2*R[ce]+1]===0;ce--);return te.opt_len+=3*(ce+1)+5+5+4,ce})(b),D=b.opt_len+3+7>>>3,(Q=b.static_len+3+7>>>3)<=D&&(D=Q)):D=Q=V+5,V+4<=D&&A!==-1?w(b,A,V,K):b.strategy===4||Q===D?(ne(b,2+(K?1:0),3),Te(b,X,k)):(ne(b,4+(K?1:0),3),(function(te,ce,O,J){var be;for(ne(te,ce-257,5),ne(te,O-1,5),ne(te,J-4,4),be=0;be<J;be++)ne(te,te.bl_tree[2*R[be]+1],3);W(te,te.dyn_ltree,ce-1),W(te,te.dyn_dtree,O-1)})(b,b.l_desc.max_code+1,b.d_desc.max_code+1,oe+1),Te(b,b.dyn_ltree,b.dyn_dtree)),he(b),K&&ye(b)},y._tr_tally=function(b,A,V){return b.pending_buf[b.d_buf+2*b.last_lit]=A>>>8&255,b.pending_buf[b.d_buf+2*b.last_lit+1]=255&A,b.pending_buf[b.l_buf+b.last_lit]=255&V,b.last_lit++,A===0?b.dyn_ltree[2*V]++:(b.matches++,A--,b.dyn_ltree[2*(a[V]+h+1)]++,b.dyn_dtree[2*T(A)]++),b.last_lit===b.lit_bufsize-1},y._tr_align=function(b){ne(b,2,3),ee(b,j,X),(function(A){A.bi_valid===16?(ae(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):8<=A.bi_valid&&(A.pending_buf[A.pending++]=255&A.bi_buf,A.bi_buf>>=8,A.bi_valid-=8)})(b)}},{"../utils/common":41}],53:[function(t,v,y){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,v,y){(function(l){(function(n,s){if(!n.setImmediate){var i,u,m,h,g=1,o={},p=!1,c=n.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(n);f=f&&f.setTimeout?f:n,i={}.toString.call(n.process)==="[object process]"?function(I){process.nextTick(function(){x(I)})}:(function(){if(n.postMessage&&!n.importScripts){var I=!0,N=n.onmessage;return n.onmessage=function(){I=!1},n.postMessage("","*"),n.onmessage=N,I}})()?(h="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",j,!1):n.attachEvent("onmessage",j),function(I){n.postMessage(h+I,"*")}):n.MessageChannel?((m=new MessageChannel).port1.onmessage=function(I){x(I.data)},function(I){m.port2.postMessage(I)}):c&&"onreadystatechange"in c.createElement("script")?(u=c.documentElement,function(I){var N=c.createElement("script");N.onreadystatechange=function(){x(I),N.onreadystatechange=null,u.removeChild(N),N=null},u.appendChild(N)}):function(I){setTimeout(x,0,I)},f.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var N=new Array(arguments.length-1),H=0;H<N.length;H++)N[H]=arguments[H+1];var L={callback:I,args:N};return o[g]=L,i(g),g++},f.clearImmediate=d}function d(I){delete o[I]}function x(I){if(p)setTimeout(x,0,I);else{var N=o[I];if(N){p=!0;try{(function(H){var L=H.callback,Z=H.args;switch(Z.length){case 0:L();break;case 1:L(Z[0]);break;case 2:L(Z[0],Z[1]);break;case 3:L(Z[0],Z[1],Z[2]);break;default:L.apply(s,Z)}})(N)}finally{d(I),p=!1}}}}function j(I){I.source===n&&typeof I.data=="string"&&I.data.indexOf(h)===0&&x(+I.data.slice(h.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof Ve<"u"?Ve:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ut)),Ut.exports}var Pn=Mn();const Fn=Ir(Pn);var vt={exports:{}},$n=vt.exports,jr;function Bn(){return jr||(jr=1,(function($,B){(function(t,v){v()})($n,function(){function t(u,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function v(u,m,h){var g=new XMLHttpRequest;g.open("GET",u),g.responseType="blob",g.onload=function(){i(g.response,m,h)},g.onerror=function(){console.error("could not download file")},g.send()}function y(u){var m=new XMLHttpRequest;m.open("HEAD",u,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function l(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(m)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ve=="object"&&Ve.global===Ve?Ve:void 0,s=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,m,h){var g=n.URL||n.webkitURL,o=document.createElement("a");m=m||u.name||"download",o.download=m,o.rel="noopener",typeof u=="string"?(o.href=u,o.origin===location.origin?l(o):y(o.href)?v(u,m,h):l(o,o.target="_blank")):(o.href=g.createObjectURL(u),setTimeout(function(){g.revokeObjectURL(o.href)},4e4),setTimeout(function(){l(o)},0))}:"msSaveOrOpenBlob"in navigator?function(u,m,h){if(m=m||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(t(u,h),m);else if(y(u))v(u,m,h);else{var g=document.createElement("a");g.href=u,g.target="_blank",setTimeout(function(){l(g)})}}:function(u,m,h,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),typeof u=="string")return v(u,m,h);var o=u.type==="application/octet-stream",p=/constructor/i.test(n.HTMLElement)||n.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&p||s)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var j=f.result;j=c?j:j.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=j:location=j,g=null},f.readAsDataURL(u)}else{var d=n.URL||n.webkitURL,x=d.createObjectURL(u);g?g.location=x:location.href=x,g=null,setTimeout(function(){d.revokeObjectURL(x)},4e4)}});n.saveAs=i.saveAs=i,$.exports=i})})(vt)),vt.exports}var Hn=Bn();const Gn=Ir(Hn),Wn=$=>{const B=$.replace(/[^a-z0-9-]/gi,"-").toLowerCase();return JSON.stringify({name:B||"my-bento",private:!0,version:"1.0.0",type:"module",scripts:{dev:"vite",build:"vite build",preview:"vite preview"},dependencies:{react:"^18.3.1","react-dom":"^18.3.1","lucide-react":"^0.460.0","react-icons":"^5.3.0"},devDependencies:{"@types/react":"^18.3.12","@types/react-dom":"^18.3.1","@vitejs/plugin-react":"^4.3.3",autoprefixer:"^10.4.20",postcss:"^8.4.49",tailwindcss:"^3.4.15",typescript:"^5.6.3",vite:"^5.4.11"}},null,2)},Yn=()=>`import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  base: './',
})
`,Vn=()=>`/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      fontFamily: {
        sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
`,Zn=()=>`export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
`,Kn=()=>JSON.stringify({compilerOptions:{target:"ES2020",useDefineForClassFields:!0,lib:["ES2020","DOM","DOM.Iterable"],module:"ESNext",skipLibCheck:!0,moduleResolution:"bundler",allowImportingTsExtensions:!0,resolveJsonModule:!0,isolatedModules:!0,noEmit:!0,jsx:"react-jsx",strict:!0,noUnusedLocals:!0,noUnusedParameters:!0,noFallthroughCasesInSwitch:!0},include:["src"]},null,2);function Sr($){try{const B=$.split(","),t=B[0].match(/:(.*?);/);if(!t)return null;const v=t[1],y=atob(B[1]);let l=y.length;const n=new Uint8Array(l);for(;l--;)n[l]=y.charCodeAt(l);return new Blob([n],{type:v})}catch{return null}}const Xn=$=>$?String($).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"):"",Jn=$=>`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <title>${Xn($)}</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"><\/script>
  </body>
</html>
`,qn=()=>`import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)
`,Qn=()=>`@tailwind base;
@tailwind components;
@tailwind utilities;

.full-img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.media-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 0.75rem;
  background: linear-gradient(to top, rgba(0,0,0,0.6), transparent);
}

.media-title {
  font-weight: 600;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.media-subtext {
  font-size: 0.75rem;
  color: rgba(255,255,255,0.8);
  margin-top: 0.25rem;
}

.bento-item {
  transform-style: preserve-3d;
  will-change: transform;
}

/* Hide scrollbar */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
`,es=()=>`import { useState, useEffect, useRef, useCallback } from 'react'
import { Youtube, Play, Loader2 } from 'lucide-react'
import {
  SiX, SiInstagram, SiTiktok, SiYoutube, SiGithub, SiGitlab, SiLinkedin,
  SiFacebook, SiTwitch, SiDribbble, SiMedium, SiDevdotto, SiReddit,
  SiPinterest, SiThreads, SiBluesky, SiMastodon, SiSubstack, SiPatreon,
  SiKofi, SiBuymeacoffee, SiSnapchat, SiDiscord, SiTelegram, SiWhatsapp,
} from 'react-icons/si'
import { Globe, Link as LinkIcon } from 'lucide-react'
import type { IconType } from 'react-icons'
import type { LucideIcon } from 'lucide-react'
`,ts=()=>`
// Types
enum BlockType {
  LINK = 'LINK',
  TEXT = 'TEXT',
  MEDIA = 'MEDIA',
  SOCIAL = 'SOCIAL',
  SOCIAL_ICON = 'SOCIAL_ICON',
  MAP = 'MAP',
  SPACER = 'SPACER'
}

type SocialPlatform = 'x' | 'instagram' | 'tiktok' | 'youtube' | 'github' | 'gitlab' | 'linkedin' | 'facebook' | 'twitch' | 'dribbble' | 'medium' | 'devto' | 'reddit' | 'pinterest' | 'threads' | 'bluesky' | 'mastodon' | 'substack' | 'patreon' | 'kofi' | 'buymeacoffee' | 'website' | 'snapchat' | 'discord' | 'telegram' | 'whatsapp' | 'custom'

interface BlockData {
  id: string
  type: BlockType
  title?: string
  content?: string
  subtext?: string
  imageUrl?: string
  mediaPosition?: { x: number; y: number }
  colSpan: number
  rowSpan: number
  color?: string
  customBackground?: string
  textColor?: string
  gridColumn?: number
  gridRow?: number
  channelId?: string
  youtubeVideoId?: string
  channelTitle?: string
  youtubeMode?: 'single' | 'grid' | 'list'
  youtubeVideos?: Array<{ id: string; title: string; thumbnail: string }>
  socialPlatform?: SocialPlatform
  socialHandle?: string
  zIndex?: number
}
`,rs=()=>"\n// Social platforms config\nconst SOCIAL_PLATFORMS: Record<string, { icon: IconType | LucideIcon; brandColor: string; buildUrl: (h: string) => string }> = {\n  x: { icon: SiX, brandColor: '#000000', buildUrl: (h) => `https://x.com/${h}` },\n  instagram: { icon: SiInstagram, brandColor: '#E4405F', buildUrl: (h) => `https://instagram.com/${h}` },\n  tiktok: { icon: SiTiktok, brandColor: '#000000', buildUrl: (h) => `https://tiktok.com/@${h}` },\n  youtube: { icon: SiYoutube, brandColor: '#FF0000', buildUrl: (h) => `https://youtube.com/@${h}` },\n  github: { icon: SiGithub, brandColor: '#181717', buildUrl: (h) => `https://github.com/${h}` },\n  gitlab: { icon: SiGitlab, brandColor: '#FC6D26', buildUrl: (h) => `https://gitlab.com/${h}` },\n  linkedin: { icon: SiLinkedin, brandColor: '#0A66C2', buildUrl: (h) => `https://linkedin.com/in/${h}` },\n  facebook: { icon: SiFacebook, brandColor: '#1877F2', buildUrl: (h) => `https://facebook.com/${h}` },\n  twitch: { icon: SiTwitch, brandColor: '#9146FF', buildUrl: (h) => `https://twitch.tv/${h}` },\n  dribbble: { icon: SiDribbble, brandColor: '#EA4C89', buildUrl: (h) => `https://dribbble.com/${h}` },\n  medium: { icon: SiMedium, brandColor: '#000000', buildUrl: (h) => `https://medium.com/@${h}` },\n  devto: { icon: SiDevdotto, brandColor: '#0A0A0A', buildUrl: (h) => `https://dev.to/${h}` },\n  reddit: { icon: SiReddit, brandColor: '#FF4500', buildUrl: (h) => `https://reddit.com/user/${h}` },\n  pinterest: { icon: SiPinterest, brandColor: '#BD081C', buildUrl: (h) => `https://pinterest.com/${h}` },\n  threads: { icon: SiThreads, brandColor: '#000000', buildUrl: (h) => `https://threads.net/@${h}` },\n  bluesky: { icon: SiBluesky, brandColor: '#0085FF', buildUrl: (h) => `https://bsky.app/profile/${h}` },\n  mastodon: { icon: SiMastodon, brandColor: '#6364FF', buildUrl: (h) => h },\n  substack: { icon: SiSubstack, brandColor: '#FF6719', buildUrl: (h) => `https://${h}.substack.com` },\n  patreon: { icon: SiPatreon, brandColor: '#FF424D', buildUrl: (h) => `https://patreon.com/${h}` },\n  kofi: { icon: SiKofi, brandColor: '#FF5E5B', buildUrl: (h) => `https://ko-fi.com/${h}` },\n  buymeacoffee: { icon: SiBuymeacoffee, brandColor: '#FFDD00', buildUrl: (h) => `https://buymeacoffee.com/${h}` },\n  snapchat: { icon: SiSnapchat, brandColor: '#FFFC00', buildUrl: (h) => `https://snapchat.com/add/${h}` },\n  discord: { icon: SiDiscord, brandColor: '#5865F2', buildUrl: (h) => h },\n  telegram: { icon: SiTelegram, brandColor: '#26A5E4', buildUrl: (h) => `https://t.me/${h}` },\n  whatsapp: { icon: SiWhatsapp, brandColor: '#25D366', buildUrl: (h) => `https://wa.me/${h}` },\n  website: { icon: Globe, brandColor: '#6B7280', buildUrl: (h) => h.startsWith('http') ? h : `https://${h}` },\n  custom: { icon: LinkIcon, brandColor: '#6B7280', buildUrl: (h) => h },\n}\n\n// Format follower count: 220430 → \"220k\", 1500000 → \"1.5M\"\nconst formatFollowerCount = (count: number | undefined): string => {\n  if (count === undefined || count === null) return ''\n  if (count < 1000) return String(count)\n  if (count < 1000000) {\n    const k = count / 1000\n    return k >= 100 ? `${Math.round(k)}k` : `${k.toFixed(k % 1 === 0 ? 0 : 1)}k`\n  }\n  const m = count / 1000000\n  return m >= 100 ? `${Math.round(m)}M` : `${m.toFixed(m % 1 === 0 ? 0 : 1)}M`\n}\n",as=()=>`
// Tilt effect hook
const useTiltEffect = (isEnabled = true) => {
  const [tiltStyle, setTiltStyle] = useState<React.CSSProperties>({})
  const elementRef = useRef<HTMLDivElement>(null)

  const handleMouseMove = useCallback((e: React.MouseEvent<HTMLDivElement>) => {
    if (!isEnabled || !elementRef.current) return
    const rect = elementRef.current.getBoundingClientRect()
    const x = e.clientX - rect.left
    const y = e.clientY - rect.top
    const centerX = rect.width / 2
    const centerY = rect.height / 2
    const rotateX = ((y - centerY) / centerY) * -10
    const rotateY = ((x - centerX) / centerX) * 10
    const glareX = (x / rect.width) * 100
    const glareY = (y / rect.height) * 100
    const shadowX = rotateY * 1.5
    const shadowY = rotateX * -1.5
    setTiltStyle({
      transform: \`perspective(800px) rotateX(\${rotateX}deg) rotateY(\${rotateY}deg) scale3d(1.02, 1.02, 1.02)\`,
      boxShadow: \`\${shadowX}px \${shadowY}px 25px rgba(0,0,0,0.15), 0 8px 30px rgba(0,0,0,0.1)\`,
      transition: 'transform 0.1s ease-out, box-shadow 0.1s ease-out',
      '--glare-x': \`\${glareX}%\`,
      '--glare-y': \`\${glareY}%\`,
    } as React.CSSProperties)
  }, [isEnabled])

  const handleMouseLeave = useCallback(() => {
    if (!isEnabled) return
    setTiltStyle({
      transform: 'perspective(800px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)',
      boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
      transition: 'transform 0.5s ease-out, box-shadow 0.5s ease-out',
    })
  }, [isEnabled])

  return { elementRef, tiltStyle, handleMouseMove, handleMouseLeave }
}
`,ns=$=>`
// Analytics hook (uses Edge Function - no API keys exposed)
const useAnalytics = () => {
  const sessionStart = useRef(Date.now())
  const maxScroll = useRef(0)

  useEffect(() => {
    const handleScroll = () => {
      const scrollTop = window.scrollY || document.documentElement.scrollTop
      const docHeight = document.documentElement.scrollHeight - window.innerHeight
      const scrollPercent = docHeight > 0 ? Math.round((scrollTop / docHeight) * 100) : 0
      maxScroll.current = Math.max(maxScroll.current, scrollPercent)
    }
    window.addEventListener('scroll', handleScroll, { passive: true })
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  useEffect(() => {
    const config = profile.analytics
    if (!config?.enabled || !config?.supabaseUrl) return

    const track = async (eventType: 'page_view' | 'click', extra: { blockId?: string; destinationUrl?: string } = {}) => {
      const utm = new URLSearchParams(window.location.search)
      const payload = {
        siteId: '${$}',
        event: eventType,
        blockId: extra.blockId,
        destinationUrl: extra.destinationUrl,
        pageUrl: window.location.href,
        referrer: document.referrer || undefined,
        utm: {
          source: utm.get('utm_source') || undefined,
          medium: utm.get('utm_medium') || undefined,
          campaign: utm.get('utm_campaign') || undefined,
          term: utm.get('utm_term') || undefined,
          content: utm.get('utm_content') || undefined,
        },
        language: navigator.language,
        screenW: window.screen?.width,
        screenH: window.screen?.height,
      }
      // Use Edge Function endpoint (secure - no API keys needed)
      const endpoint = config.supabaseUrl.replace(/\\/+$/, '') + '/functions/v1/openbento-analytics-track'
      fetch(endpoint, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
        keepalive: true,
      }).catch(() => {})
    }

    track('page_view')

    // Note: session_end is not supported by the Edge Function, only page_view and click
    // If you need session tracking, extend the Edge Function
  }, [])
}
`,ss=()=>`
// Block component
const Block = ({ block }: { block: BlockData }) => {
  const { elementRef, tiltStyle, handleMouseMove, handleMouseLeave } = useTiltEffect(true)
  const [videos, setVideos] = useState(block.youtubeVideos || [])
  const [loading, setLoading] = useState(false)
  const mediaPos = block.mediaPosition || { x: 50, y: 50 }

  useEffect(() => {
    if (block.type === BlockType.SOCIAL && block.channelId && !block.youtubeVideos?.length) {
      setLoading(true)
      const rssUrl = \`https://www.youtube.com/feeds/videos.xml?channel_id=\${block.channelId}\`
      const proxyUrl = \`https://api.allorigins.win/raw?url=\${encodeURIComponent(rssUrl)}\`
      fetch(proxyUrl).then(r => r.text()).then(text => {
        const parser = new DOMParser()
        const xml = parser.parseFromString(text, 'text/xml')
        const entries = Array.from(xml.querySelectorAll('entry'))
        const vids = entries.slice(0, 4).map(e => {
          const id = e.getElementsByTagName('yt:videoId')[0]?.textContent || ''
          const title = e.getElementsByTagName('title')[0]?.textContent || ''
          return { id, title, thumbnail: \`https://img.youtube.com/vi/\${id}/mqdefault.jpg\` }
        })
        if (vids.length) setVideos(vids)
      }).catch(() => {}).finally(() => setLoading(false))
    }
  }, [block.channelId, block.youtubeVideos, block.type])

  const getBorderRadius = () => {
    const minDim = Math.min(block.colSpan, block.rowSpan)
    if (minDim <= 1) return '0.5rem'
    if (minDim <= 2) return '0.625rem'
    if (minDim <= 3) return '0.75rem'
    return '0.875rem'
  }
  const borderRadius = getBorderRadius()

  const gridStyle: React.CSSProperties = {}
  if (block.gridColumn !== undefined) {
    gridStyle.gridColumnStart = block.gridColumn
    gridStyle.gridColumnEnd = block.gridColumn + block.colSpan
  }
  if (block.gridRow !== undefined) {
    gridStyle.gridRowStart = block.gridRow
    gridStyle.gridRowEnd = block.gridRow + block.rowSpan
  }

  const handleClick = () => {
    let url = block.content
    if (block.type === BlockType.SOCIAL && block.socialPlatform && block.socialHandle) {
      url = SOCIAL_PLATFORMS[block.socialPlatform]?.buildUrl(block.socialHandle)
    } else if (block.channelId) {
      url = \`https://youtube.com/channel/\${block.channelId}\`
    }
    if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
      window.open(url, '_blank', 'noopener,noreferrer')
    }
  }

  const isYoutube = block.type === BlockType.SOCIAL && block.channelId
  const activeVideoId = block.youtubeVideoId || videos[0]?.id
  const isRichYT = isYoutube && activeVideoId && block.youtubeMode !== 'grid' && block.youtubeMode !== 'list'
  const isYTGrid = isYoutube && (block.youtubeMode === 'grid' || block.youtubeMode === 'list')
  const isLinkImg = block.type === BlockType.LINK && block.imageUrl

  if (block.type === BlockType.SPACER) return <div style={{ borderRadius, ...gridStyle }} className="h-full" />

  if (block.type === BlockType.SOCIAL_ICON) {
    const platform = SOCIAL_PLATFORMS[block.socialPlatform || 'custom']
    const Icon = platform?.icon
    const url = block.socialHandle ? platform?.buildUrl(block.socialHandle) : ''
    return (
      <a href={url || undefined} target="_blank" rel="noopener noreferrer" onClick={handleClick}
        className={\`bento-item relative h-full \${block.color || 'bg-white'} flex items-center justify-center shadow-sm border border-gray-100 hover:shadow-md transition-all\`}
        style={{ borderRadius, ...gridStyle, ...(block.customBackground ? { background: block.customBackground } : {}) }}>
        {Icon && <span style={{ color: platform.brandColor }}><Icon size={24} /></span>}
      </a>
    )
  }

  if (isYTGrid) {
    return (
      <div onClick={handleClick} style={{ borderRadius, ...gridStyle, ...(block.customBackground ? { background: block.customBackground } : {}) }}
        className={\`bento-item group cursor-pointer h-full \${block.color || 'bg-white'} ring-1 ring-black/5 shadow-sm hover:shadow-xl transition-all\`}>
        <div className="w-full h-full flex flex-col p-2 md:p-3">
          <div className="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
            <div className="w-6 h-6 rounded-lg bg-red-600 text-white flex items-center justify-center"><Youtube size={12} /></div>
            <div className="flex-1 min-w-0">
              <h3 className="text-[10px] md:text-xs font-bold text-gray-900 truncate">{block.channelTitle || 'YouTube'}</h3>
              <span className="text-[8px] text-gray-400">Latest videos</span>
            </div>
          </div>
          {loading ? <div className="flex-1 flex items-center justify-center"><Loader2 className="animate-spin text-gray-300" size={16} /></div> : (
            <div className="flex-1 grid grid-cols-2 gap-1 overflow-hidden">
              {videos.slice(0, 4).map((v, i) => (
                <a key={i} href={\`https://youtube.com/watch?v=\${v.id}\`} target="_blank" rel="noopener noreferrer" onClick={e => e.stopPropagation()} className="relative overflow-hidden rounded bg-gray-100 group/vid">
                  <img src={v.thumbnail} alt={v.title} className="w-full h-full object-cover" />
                  <div className="absolute inset-0 bg-black/20 group-hover/vid:bg-black/40 transition-colors flex items-center justify-center">
                    <div className="w-6 h-6 rounded-full bg-red-500 flex items-center justify-center opacity-0 group-hover/vid:opacity-100 transition-opacity">
                      <Play size={10} className="text-white ml-0.5" fill="white" />
                    </div>
                  </div>
                </a>
              ))}
            </div>
          )}
        </div>
      </div>
    )
  }

  let bgStyle: React.CSSProperties = block.customBackground ? { background: block.customBackground } : {}
  if (isRichYT) bgStyle = { backgroundImage: \`url(https://img.youtube.com/vi/\${activeVideoId}/maxresdefault.jpg)\`, backgroundSize: 'cover', backgroundPosition: 'center' }
  else if (isLinkImg && block.imageUrl) bgStyle = { backgroundImage: \`url(\${block.imageUrl})\`, backgroundSize: 'cover', backgroundPosition: \`\${mediaPos.x}% \${mediaPos.y}%\` }

  return (
    <div onClick={handleClick} style={{ ...gridStyle }} className="cursor-pointer h-full transform-gpu">
      <div ref={elementRef} onMouseMove={handleMouseMove} onMouseLeave={handleMouseLeave}
        style={{ ...bgStyle, borderRadius, ...tiltStyle, width: '100%', height: '100%', transformStyle: 'preserve-3d' }}
        className={\`bento-item group relative overflow-hidden w-full h-full \${!block.customBackground && !isLinkImg && !isRichYT ? (block.color || 'bg-white') : ''} \${block.textColor || 'text-gray-900'} ring-1 ring-black/5 shadow-sm transition-all\`}>
        <div className="absolute inset-0 pointer-events-none z-30 opacity-0 group-hover:opacity-100 transition-opacity"
          style={{ background: 'radial-gradient(circle at var(--glare-x, 50%) var(--glare-y, 50%), rgba(255,255,255,0.25) 0%, transparent 60%)' }} />
        {(isRichYT || isLinkImg) && (block.title || block.subtext) && (
          <div className="absolute inset-x-0 bottom-0 h-2/3 bg-gradient-to-t from-black/70 via-black/30 to-transparent z-0" />
        )}
        <div className="w-full h-full relative z-10">
          {block.type === BlockType.MEDIA && block.imageUrl ? (
            <div className="w-full h-full relative overflow-hidden">
              {/\\.(mp4|webm|ogg|mov)$/i.test(block.imageUrl) ? (
                <video src={block.imageUrl} className="full-img" style={{ objectPosition: \`\${mediaPos.x}% \${mediaPos.y}%\` }} autoPlay loop muted playsInline />
              ) : (
                <img src={block.imageUrl} alt={block.title || ''} className="full-img" style={{ objectPosition: \`\${mediaPos.x}% \${mediaPos.y}%\` }} />
              )}
              {block.title && <div className="media-overlay"><p className="media-title text-sm">{block.title}</p>{block.subtext && <p className="media-subtext">{block.subtext}</p>}</div>}
            </div>
          ) : block.type === BlockType.MAP ? (
            <div className="w-full h-full relative bg-gray-100 overflow-hidden">
              <iframe width="100%" height="100%" className="opacity-95 grayscale-[20%] group-hover:grayscale-0 transition-all"
                src={\`https://maps.google.com/maps?q=\${encodeURIComponent(block.content || 'Paris')}&t=&z=13&ie=UTF8&iwloc=&output=embed\`} loading="lazy" sandbox="allow-scripts allow-same-origin" />
              {block.title && <div className="absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/60 to-transparent"><p className="font-semibold text-white text-sm">{block.title}</p></div>}
            </div>
          ) : isRichYT ? (
            <div className="w-full h-full relative">
              <div className="absolute inset-0 flex items-center justify-center">
                <div className="w-10 h-10 rounded-full bg-red-500 flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform">
                  <Play size={16} className="text-white ml-0.5" fill="white" />
                </div>
              </div>
              {(block.channelTitle || block.title) && <div className="absolute bottom-0 left-0 right-0 p-3"><h3 className="font-semibold text-white text-sm drop-shadow-lg">{block.channelTitle || block.title}</h3></div>}
            </div>
          ) : (
            <div className="p-3 h-full flex flex-col justify-between">
              {block.type === BlockType.SOCIAL && block.socialPlatform && (() => {
                const platform = SOCIAL_PLATFORMS[block.socialPlatform]
                const Icon = platform?.icon
                return Icon ? (
                  <div className={\`w-7 h-7 rounded-lg flex items-center justify-center \${block.textColor === 'text-white' || isLinkImg ? 'bg-white/20 backdrop-blur-sm' : 'bg-gray-100'}\`}
                    style={{ color: block.textColor === 'text-brand' ? platform.brandColor : undefined }}>
                    <Icon size={14} />
                  </div>
                ) : null
              })()}
              <div className={block.type === BlockType.TEXT ? 'flex flex-col justify-center h-full' : 'mt-auto'}>
                <h3 className={\`font-bold leading-tight \${isLinkImg ? 'text-white drop-shadow-lg' : ''}\`}>{block.title}</h3>
                {block.subtext && <p className={\`text-xs mt-1 \${isLinkImg ? 'text-white/80' : 'opacity-60'}\`}>{block.subtext}</p>}
                {block.type === BlockType.TEXT && block.content && <p className="opacity-70 mt-2 text-sm whitespace-pre-wrap">{block.content}</p>}
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  )
}
`,os=$=>`
        {/* Desktop Layout */}
        <div className="hidden lg:flex">
          <div className="fixed left-0 top-0 w-[420px] h-screen flex flex-col justify-center items-start px-12">
            <div className="w-40 h-40 overflow-hidden bg-gray-100 mb-8" style={avatarStyle}>
              <img src={profile.avatarUrl} alt={profile.name} className="w-full h-full object-cover" />
            </div>
            <h1 className="text-4xl font-bold tracking-tight text-gray-900 mb-3">{profile.name}</h1>
            <p className="text-base text-gray-500 font-medium whitespace-pre-wrap max-w-xs">{profile.bio}</p>
            ${$.showSocialInHeader&&$.hasSocialAccounts?`
            <div className="flex flex-wrap gap-3 mt-4">
              {profile.socialAccounts?.map((acc: any) => {
                const platform = SOCIAL_PLATFORMS[acc.platform]
                const Icon = platform?.icon
                const url = platform?.buildUrl(acc.handle)
                const showCount = profile.showFollowerCount && acc.followerCount
                return (
                  <a key={acc.platform} href={url} target="_blank" rel="noopener noreferrer"
                    className={\`\${showCount ? 'px-3 py-2' : 'w-10 h-10'} bg-white rounded-full shadow-md flex items-center justify-center gap-2 hover:scale-105 hover:shadow-lg transition-all\`}
                    style={{ color: platform?.brandColor }}>
                    {Icon && <Icon size={20} />}
                    {showCount && (
                      <span className="text-sm font-semibold text-gray-700">
                        {formatFollowerCount(acc.followerCount)}
                      </span>
                    )}
                  </a>
                )
              })}
            </div>`:""}
          </div>
          <div className="ml-[420px] flex-1 p-12">
            <div className="grid gap-2" style={{ gridTemplateColumns: 'repeat(9, 1fr)', gridAutoRows: '64px' }}>
              {blocks.map(block => <Block key={block.id} block={block} />)}
            </div>
          </div>
        </div>`,Mt={columns:2,rowHeight:80,gap:12},is=()=>`
// Mobile layout helper - calculates responsive grid spans
const getMobileLayout = (block: BlockData) => ({
  colSpan: block.colSpan >= 5 ? 2 : 1,
  rowSpan: block.colSpan >= 3 && block.colSpan < 5 ? Math.max(block.rowSpan, 2) : block.rowSpan
})
`,ls=$=>`
        {/* Mobile Layout - 2 columns adaptive */}
        <div className="lg:hidden">
          <div className="p-4 pt-8 flex flex-col items-center text-center">
            <div className="w-24 h-24 mb-4 overflow-hidden bg-gray-100" style={avatarStyle}>
              <img src={profile.avatarUrl} alt={profile.name} className="w-full h-full object-cover" />
            </div>
            <h1 className="text-2xl font-extrabold tracking-tight text-gray-900 mb-2">{profile.name}</h1>
            <p className="text-sm text-gray-500 font-medium whitespace-pre-wrap max-w-xs">{profile.bio}</p>
            ${$.showSocialInHeader&&$.hasSocialAccounts?`
            <div className="flex flex-wrap justify-center gap-3 mt-4">
              {profile.socialAccounts?.map((acc: any) => {
                const platform = SOCIAL_PLATFORMS[acc.platform]
                const Icon = platform?.icon
                const url = platform?.buildUrl(acc.handle)
                const showCount = profile.showFollowerCount && acc.followerCount
                return (
                  <a key={acc.platform} href={url} target="_blank" rel="noopener noreferrer"
                      className={\`\${showCount ? 'px-3 py-2' : 'w-10 h-10'} bg-white rounded-full shadow-md flex items-center justify-center gap-2 hover:-translate-y-0.5 transition-transform\`}
                    style={{ color: platform?.brandColor }}>
                    {Icon && <Icon size={20} />}
                    {showCount && (
                      <span className="text-sm font-semibold text-gray-900">
                        {formatFollowerCount(acc.followerCount)}
                      </span>
                    )}
                  </a>
                )
              })}
            </div>`:""}
          </div>
          <div className="p-4">
            <div className="grid" style={{ gridTemplateColumns: 'repeat(${Mt.columns}, 1fr)', gridAutoRows: '${Mt.rowHeight}px', gap: '${Mt.gap}px' }}>
              {sortedBlocks.map(block => {
                const mobile = getMobileLayout(block)
                return (
                  <div key={block.id} style={{ gridColumn: \`span \${mobile.colSpan}\`, gridRow: \`span \${mobile.rowSpan}\` }}>
                    <Block block={{ ...block, gridColumn: undefined, gridRow: undefined }} />
                  </div>
                )
              })}
            </div>
          </div>
        </div>`,cs=$=>$?`
        <footer className="w-full py-10 text-center">
          <p className="text-sm text-gray-400 font-medium">
            Made with <span className="text-red-400">♥</span> using{' '}
            <a href="https://github.com/yoanbernabeu/openbento" target="_blank" rel="noopener noreferrer" className="font-semibold hover:text-violet-500 transition-colors">OpenBento</a>
          </p>
        </footer>`:"",ds=($,B)=>$&&B&&B>0?`<div className="fixed inset-0 z-0 pointer-events-none" style={{ backdropFilter: 'blur(${B}px)', WebkitBackdropFilter: 'blur(${B}px)' }} />`:"",us=($,B,t)=>{var c;const{profile:v,blocks:y}=$,l=B.profile_avatar||v.avatarUrl,n=v.avatarStyle||{shape:"rounded",shadow:!0,border:!0,borderColor:"#ffffff",borderWidth:4},s=n.shape==="circle"?"9999px":n.shape==="square"?"0":"1.5rem",i=n.shadow!==!1?"0 25px 50px -12px rgba(0,0,0,0.15)":"none",u=n.border!==!1?`${n.borderWidth||4}px solid ${n.borderColor||"#ffffff"}`:"none",m=v.backgroundImage?`{ backgroundImage: "url('${v.backgroundImage}')", backgroundSize: 'cover', backgroundPosition: 'center', backgroundAttachment: 'fixed' }`:`{ backgroundColor: '${v.backgroundColor||"#f8fafc"}' }`,h=JSON.stringify(y.map(f=>({...f,imageUrl:f.imageUrl&&B[`block_${f.id}`]?B[`block_${f.id}`]:f.imageUrl}))),g=JSON.stringify({...v,avatarUrl:l}),o={showSocialInHeader:!!v.showSocialInHeader,hasSocialAccounts:!!(v.socialAccounts&&v.socialAccounts.length>0),showBranding:v.showBranding!==!1,backgroundBlur:v.backgroundBlur,backgroundImage:v.backgroundImage},p=(c=$.profile.analytics)!=null&&c.enabled?t||"default":"";return`${es()}
${ts()}
${rs()}
${as()}
${ss()}

// Profile data
const profile = ${g}
const blocks: BlockData[] = ${h}
${ns(p)}
${is()}
// Sort blocks for mobile
const sortedBlocks = [...blocks].sort((a, b) => {
  const aRow = a.gridRow ?? 999
  const bRow = b.gridRow ?? 999
  const aCol = a.gridColumn ?? 999
  const bCol = b.gridColumn ?? 999
  if (aRow !== bRow) return aRow - bRow
  return aCol - bCol
})

export default function App() {
  useAnalytics()

  const avatarStyle = { borderRadius: '${s}', boxShadow: '${i}', border: '${u}' }
  const bgStyle: React.CSSProperties = ${m}

  return (
    <div className="min-h-screen font-sans" style={bgStyle}>
      ${ds(v.backgroundImage,v.backgroundBlur)}
      <div className="relative z-10">
${os(o)}

${ls(o)}

${cs(o.showBranding)}
      </div>
    </div>
  )
}
`};function hs($,B){var v,y;const t={};if((v=$.profile.avatarUrl)!=null&&v.startsWith("data:image")){const l=Sr($.profile.avatarUrl);l&&B&&(B.file("avatar.png",l),t.profile_avatar="/assets/avatar.png")}for(const l of $.blocks)if((y=l.imageUrl)!=null&&y.startsWith("data:image")){const n=Sr(l.imageUrl);if(n&&B){const s=`block-${l.id}.png`;B.file(s,n),t[`block_${l.id}`]=`/assets/${s}`}}return t}const fs=`{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "installCommand": "npm install"
}
`,ps=`[build]
  command = "npm run build"
  publish = "dist"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
`,ms=`name: Deploy to GitHub Pages

on:
  push:
    branches: ["main"]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  deploy:
    environment:
      name: github-pages
      url: \${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          
      - name: Install dependencies
        run: npm install
        
      - name: Build
        run: npm run build
        
      - name: Setup Pages
        uses: actions/configure-pages@v5
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: 'dist'
          
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
`,Lr=`server {
  listen 80;
  server_name _;

  root /usr/share/nginx/html;
  index index.html;

  location / {
    try_files $uri $uri/ /index.html;
  }
}
`,gs=`FROM node:20-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=build /app/dist /usr/share/nginx/html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
`,bs=`.git
node_modules
dist
`,xs=()=>Lr.replace("/usr/share/nginx/html","/var/www/bento/dist"),ys=`{
  "root": "dist/",
  "clean_urls": true,
  "routes": {
    "/**": "index.html"
  }
}
`,vs=$=>`# Deploy ${$.name}

This is a React/Vite/Tailwind project exported from OpenBento.

## Quick Start

\`\`\`bash
npm install
npm run dev     # Development server
npm run build   # Production build
npm run preview # Preview production build
\`\`\`

## Deployment

### ${$.target.charAt(0).toUpperCase()+$.target.slice(1)}

${$.target==="vercel"?`1. Push to GitHub
2. Import in Vercel
3. Deploy (auto-detected)`:""}
${$.target==="netlify"?`1. Push to GitHub
2. Import in Netlify
3. Deploy (auto-detected)`:""}
${$.target==="github-pages"?`1. Push to GitHub
2. Go to Settings → Pages → Source: GitHub Actions
3. The included workflow will auto-deploy`:""}
${$.target==="docker"?"```bash\ndocker build -t my-bento .\ndocker run -p 8080:80 my-bento\n```":""}
${$.target==="vps"?"1. Copy files to your server\n2. Run `npm install && npm run build`\n3. Configure nginx with the provided config\n4. Point nginx root to the `dist` folder":""}
${$.target==="heroku"?"1. Create Heroku app\n2. Add buildpack: `heroku/nodejs`\n3. Push to Heroku":""}

## Files

- \`src/App.tsx\` - Main component with all data embedded
- \`src/index.css\` - Tailwind styles
- \`public/assets/\` - Images (if any)
`,ws=async($,B)=>{const t=new Fn,v=t.folder("public/assets"),y=t.folder("src"),l=hs($,v),n=(B==null?void 0:B.deploymentTarget)??"vercel";switch(t.file("package.json",Wn($.profile.name)),t.file("vite.config.ts",Yn()),t.file("tailwind.config.js",Vn()),t.file("postcss.config.js",Zn()),t.file("tsconfig.json",Kn()),t.file("index.html",Jn($.profile.name)),t.file("DEPLOY.md",vs({name:$.profile.name,target:n})),y==null||y.file("main.tsx",qn()),y==null||y.file("index.css",Qn()),y==null||y.file("App.tsx",us($,l,B==null?void 0:B.siteId)),n){case"vercel":t.file("vercel.json",fs);break;case"netlify":t.file("netlify.toml",ps);break;case"github-pages":t.file(".github/workflows/deploy.yml",ms);break;case"docker":t.file("Dockerfile",gs),t.file("nginx.conf",Lr),t.file(".dockerignore",bs);break;case"vps":t.file("nginx.conf",xs());break;case"heroku":t.file("static.json",ys);break}const s=await t.generateAsync({type:"blob"});Gn(s,`${$.profile.name.replace(/\s+/g,"-").toLowerCase()}-bento-${n}.zip`)},je=9,jt=200,St=50,Ge=($,B,t)=>Math.min(t,Math.max(B,$)),Pt=$=>$.some(t=>t.type===de.SOCIAL_ICON||t.type===de.SPACER&&t.colSpan===9?!1:t.colSpan<=3&&t.rowSpan<=3)?$.map(t=>{if(t.type===de.SOCIAL_ICON||t.type===de.SPACER&&t.colSpan===9)return t;const v=Math.min(t.colSpan*3,9),y=Math.min(t.rowSpan*3,St),l=t.gridColumn!==void 0?(t.gridColumn-1)*3+1:void 0,n=t.gridRow!==void 0?(t.gridRow-1)*3+1:void 0;return{...t,colSpan:v,rowSpan:y,gridColumn:l,gridRow:n}}):$,ks=($,B)=>{if($.gridColumn===void 0||$.gridRow===void 0||B.gridColumn===void 0||B.gridRow===void 0)return!1;const t=Math.min($.colSpan,je),v=Math.min(B.colSpan,je),y=$.gridColumn+t,l=$.gridRow+$.rowSpan,n=B.gridColumn+v,s=B.gridRow+B.rowSpan;return!(y<=B.gridColumn||$.gridColumn>=n||l<=B.gridRow||$.gridRow>=s)},_r=($,B=[])=>{const t=new Set;for(const v of $){if(B.includes(v.id)||v.gridColumn===void 0||v.gridRow===void 0)continue;const y=Math.min(v.colSpan,je);for(let l=v.gridColumn;l<v.gridColumn+y;l++)for(let n=v.gridRow;n<v.gridRow+v.rowSpan;n++)t.add(`${l}-${n}`)}return t},Bt=($,B,t=1)=>{const v=Math.min($.colSpan,je),y=Math.max(1,t),l=(i,u)=>{for(let m=i;m<=u;m++)for(let h=1;h<=je-v+1;h++){let g=!0;for(let o=h;o<h+v&&g;o++)for(let p=m;p<m+$.rowSpan&&g;p++)B.has(`${o}-${p}`)&&(g=!1);if(g)return{col:h,row:m}}return null},n=l(y,jt);if(n)return n;const s=l(1,y-1);return s||{col:1,row:jt+1}},dt=$=>{let B=!1;const t=$.some(i=>i.gridColumn===void 0||i.gridRow===void 0),v=$.some(i=>{if(i.gridColumn===void 0)return!1;const u=Ge(i.gridColumn,1,je),m=Ge(i.colSpan,1,je);return u!==i.gridColumn||m!==i.colSpan||u+m-1>je});if(!t&&!v)return $;const y=new Set,l=i=>{if(i.gridColumn===void 0||i.gridRow===void 0)return;const u=Math.min(i.colSpan,je);for(let m=i.gridColumn;m<i.gridColumn+u;m++)for(let h=i.gridRow;h<i.gridRow+i.rowSpan;h++)y.add(`${m}-${h}`)},s=$.map(i=>{if(i.gridColumn===void 0||i.gridRow===void 0)return i;const u=Ge(i.gridColumn,1,je),m=Math.max(1,i.gridRow),h=Ge(i.colSpan,1,je),g=Math.min(h,je-u+1),o=Ge(i.rowSpan,1,St),p=u!==i.gridColumn||m!==i.gridRow||g!==i.colSpan||o!==i.rowSpan,c=p?{...i,gridColumn:u,gridRow:m,colSpan:g,rowSpan:o}:i;return p&&(B=!0),l(c),c}).map(i=>{if(i.gridColumn!==void 0&&i.gridRow!==void 0)return i;const m=Ge(i.colSpan,1,je),h=Ge(i.rowSpan,1,St),g=Math.min(m,je);let o=null;for(let f=1;f<=jt&&!o;f++)for(let d=1;d<=je-g+1&&!o;d++){let x=!0;for(let j=d;j<d+g&&x;j++)for(let I=f;I<f+h&&x;I++)y.has(`${j}-${I}`)&&(x=!1);x&&(o={col:d,row:f})}const p=o??{col:1,row:jt+1},c={...i,gridColumn:p.col,gridRow:p.row,colSpan:m,rowSpan:h};return l(c),B=!0,c});return B?s:$},js=($,B,t,v)=>{const y=$.find(u=>u.id===B);if(!y||y.gridColumn===void 0||y.gridRow===void 0)return $;const l=Ge(t,1,Math.min(je-y.gridColumn+1,je)),n=Ge(v,1,St);if(l===y.colSpan&&n===y.rowSpan)return $;const s={...y,colSpan:l,rowSpan:n};return[...$.filter(u=>u.id!==B),s]},Nr=$=>{if($.length===0)return $;const t=[...$].sort((v,y)=>{const l=v.gridRow??999,n=y.gridRow??999;if(l!==n)return l-n;const s=v.gridColumn??999,i=y.gridColumn??999;return s-i}).map(v=>({...v,gridColumn:void 0,gridRow:void 0}));return dt(t)},Ss=$=>{if($.length===0)return $;const B=[...$].sort((n,s)=>{const i=n.gridRow??999,u=s.gridRow??999;if(i!==u)return i-u;const m=n.gridColumn??999,h=s.gridColumn??999;return m-h}),t=[],v=new Set,y=n=>{if(n.gridColumn===void 0||n.gridRow===void 0)return;const s=Math.min(n.colSpan,je);for(let i=n.gridColumn;i<n.gridColumn+s;i++)for(let u=n.gridRow;u<n.gridRow+n.rowSpan;u++)v.add(`${i}-${u}`)},l=n=>{if(n.gridColumn===void 0||n.gridRow===void 0)return!1;const s=Math.min(n.colSpan,je);for(let i=n.gridColumn;i<n.gridColumn+s;i++)for(let u=n.gridRow;u<n.gridRow+n.rowSpan;u++)if(v.has(`${i}-${u}`))return!0;return!1};for(const n of B)if(n.gridColumn===void 0||n.gridRow===void 0||l(n)){const s=Bt(n,v,1),i={...n,gridColumn:s.col,gridRow:s.row};y(i),t.push(i)}else y(n),t.push(n);return t},Ns=({onBack:$})=>{var sr,or,ir,lr,cr,dr,ur,hr;const[B,t]=P.useState(null),[v,y]=P.useState(Fe),[l,n]=P.useState(null),[s,i]=P.useState(!0),[u,m]=P.useState(!1),[h,g]=P.useState(!1),[o,p]=P.useState(!1),[c,f]=P.useState(!1),[d,x]=P.useState(!1),[j,I]=P.useState(!1),[N,H]=P.useState(null),[L,Z]=P.useState("desktop"),[F,R]=P.useState(!0),{state:X,set:k,undo:U,redo:a,reset:_}=zn({profile:null,blocks:[]}),S=X.profile,C=X.blocks,[re,G]=P.useState(()=>{try{const E=localStorage.getItem("openbento_deploy_target");if(E==="vercel"||E==="netlify"||E==="github-pages"||E==="docker"||E==="vps"||E==="heroku")return E}catch{}return"vercel"}),[q,z]=P.useState(!1),[T,ae]=P.useState(!1),[ne,ee]=P.useState(null),[ue,Ce]=P.useState(30),[he,ye]=P.useState(()=>{try{return sessionStorage.getItem("openbento_analytics_admin_token")||""}catch{return""}}),[xe,Se]=P.useState(null),[Te,Ae]=P.useState(null),[r,W]=P.useState(!1),[M,w]=P.useState("existing"),[b,A]=P.useState(""),[V,K]=P.useState(""),[D,Q]=P.useState(""),[oe,te]=P.useState("eu-west-1"),[ce,O]=P.useState(!1),[J,be]=P.useState(!1),[Ne,ze]=P.useState(null),[Be,Ie]=P.useState(null),[Oe,Je]=P.useState(null),[Me,nt]=P.useState(null),[ht,st]=P.useState(null),[Nt,ot]=P.useState(null),[Ke,qe]=P.useState(0),{status:ft,lastSavedAt:Ur,timeAgo:Mr,setSaving:Gt,setSaved:Wt,setError:Yt}=On(),Vt=P.useRef(null),Ct=P.useRef(null),[Zt,Qe]=P.useState(null),[It,Kt]=P.useState(""),[Xt,Jt]=P.useState(""),qt=P.useRef(null),Qt=P.useRef(null),er=P.useRef(null);P.useEffect(()=>{(async()=>{try{const Y=await za(),se=(Y.data.gridVersion??Fe)<Fe?Pt(Y.data.blocks):Y.data.blocks,me=dt(se),fe=Fe;t({...Y,data:{...Y.data,blocks:me,gridVersion:fe}}),_({profile:Y.data.profile,blocks:me}),y(fe),(me!==Y.data.blocks||fe!==Y.data.gridVersion)&&lt(Y.id,{profile:Y.data.profile,blocks:me,gridVersion:fe})}catch(Y){console.error("Failed to load bento:",Y)}finally{R(!1)}})()},[_]);const et=P.useCallback((E,Y)=>{if(B){Gt();try{lt(B.id,{profile:E,blocks:Y,gridVersion:v}),setTimeout(()=>{Wt()},300)}catch{Yt()}}},[B,v,Gt,Wt,Yt]),At=P.useCallback(()=>{!B||!S||et(S,C)},[B,S,C,et]);P.useEffect(()=>{const E=Y=>{(Y.ctrlKey||Y.metaKey)&&Y.key==="s"&&(Y.preventDefault(),At())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[At]);const We=P.useCallback(E=>{const Y=typeof E=="function"?E(S):E;k({profile:Y,blocks:C}),et(Y,C)},[S,C,k,et]),Ue=P.useCallback(E=>{const Y=typeof E=="function"?E(C):E,ie=dt(Y),se=Ss(ie);k({profile:S,blocks:se}),S&&et(S,se)},[S,C,k,et]),Pr=P.useCallback(E=>{B&&S&&lt(B.id,{profile:S,blocks:C,gridVersion:v});const ie=(E.data.gridVersion??Fe)<Fe?Pt(E.data.blocks):E.data.blocks,se=dt(ie),me=Fe;y(me),Sa(E.id),t({...E,data:{...E.data,blocks:se,gridVersion:me}}),_({profile:E.data.profile,blocks:se}),n(null),(se!==E.data.blocks||me!==E.data.gridVersion)&&lt(E.id,{profile:E.data.profile,blocks:se,gridVersion:me})},[B,S,C,v,_]),Fr=E=>{let Y={};const ie=sessionStorage.getItem("pendingBlockPosition");if(ie){try{const{col:we,row:ve}=JSON.parse(ie);Y={col:we,row:ve}}catch{}sessionStorage.removeItem("pendingBlockPosition")}const se=()=>E===de.SOCIAL_ICON?{colSpan:1,rowSpan:1}:E===de.SPACER?{colSpan:9,rowSpan:1}:{colSpan:3,rowSpan:3},{colSpan:me,rowSpan:fe}=se(),ge={id:Math.random().toString(36).substr(2,9),type:E,title:E===de.SOCIAL?"X":E===de.SOCIAL_ICON?"":E===de.MAP?"Location":E===de.SPACER?"Spacer":"New Block",content:"",colSpan:me,rowSpan:fe,color:E===de.SPACER?"bg-transparent":E===de.SOCIAL_ICON?"bg-gray-100":"bg-white",textColor:"text-gray-900",gridColumn:Y.col,gridRow:Y.row,...E===de.SOCIAL?{socialPlatform:"x",socialHandle:""}:{},...E===de.SOCIAL_ICON?{socialPlatform:"instagram",socialHandle:""}:{}};Ue([...C,ge]),n(ge.id),s||i(!0)},tr=E=>{const Y=C.find(me=>me.id===E.id),ie=Y&&(Y.colSpan!==E.colSpan||Y.rowSpan!==E.rowSpan),se=C.map(me=>me.id===E.id?E:me);Ue(ie?Nr(se):se)},rr=E=>{const Y=C.filter(ie=>ie.id!==E);Ue(Nr(Y)),l===E&&n(null)},Et=P.useCallback(E=>{let Y=null;Ue(ie=>{const se=ie.find(Re=>Re.id===E);if(!se)return ie;const fe={...se,id:typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():Math.random().toString(36).slice(2,11),gridColumn:void 0,gridRow:void 0,zIndex:void 0,mediaPosition:se.mediaPosition?{...se.mediaPosition}:void 0,youtubeVideos:se.youtubeVideos?se.youtubeVideos.map(Re=>({...Re})):void 0},ge=_r(ie),we=se.gridRow??1,ve=Bt(fe,ge,we);return fe.gridColumn=ve.col,fe.gridRow=ve.row,Y=fe,[...ie,fe]}),Y&&(n(Y.id),s||i(!0))},[Ue,s]);P.useEffect(()=>{const E=Y=>{if(Y.defaultPrevented||!(Y.metaKey||Y.ctrlKey)||Y.key.toLowerCase()!=="d"||!l)return;const ie=document.activeElement||null,se=Y.target||null;ie&&(ie.tagName==="INPUT"||ie.tagName==="TEXTAREA"||ie.isContentEditable)||se&&(se.tagName==="INPUT"||se.tagName==="TEXTAREA"||se.isContentEditable)||(Y.preventDefault(),Et(l))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[Et,l]);const $r=()=>{z(!1),ee(null),m(!0)},Br=()=>{if(!B)return;const E={...B,data:{profile:S,blocks:C,gridVersion:v}};Ta(E)},Hr=async E=>{var ie;const Y=(ie=E.target.files)==null?void 0:ie[0];if(Y){try{const se=await Oa(Y),fe=(se.data.gridVersion??Fe)<Fe?Pt(se.data.blocks):se.data.blocks,ge=dt(fe),we=Fe;y(we),t({...se,data:{...se.data,blocks:ge,gridVersion:we}}),_({profile:se.data.profile,blocks:ge}),n(null),lt(se.id,{profile:se.data.profile,blocks:ge,gridVersion:we})}catch(se){console.error("Failed to import bento:",se),alert("Failed to import bento. Please check the JSON file.")}E.target.value=""}},Gr=E=>{var se;const Y=(se=E.target.files)==null?void 0:se[0];if(!Y)return;const ie=new FileReader;ie.onload=me=>{var ge;const fe=(ge=me.target)==null?void 0:ge.result;H(fe),f(!0)},ie.readAsDataURL(Y),E.target.value=""},Wr=E=>["w-full","h-full","object-cover","transition-transform","duration-500","group-hover:scale-110"].join(" "),Yr=E=>{const Y=E||{shape:"rounded",shadow:!0},ie=["w-40","h-40","overflow-hidden","relative","z-10","bg-gray-100"];return Y.shape==="circle"?ie.push("rounded-full"):Y.shape==="square"?ie.push("rounded-none"):ie.push("rounded-3xl"),Y.shadow&&ie.push("shadow-2xl"),ie.join(" ")},Vr=E=>{const Y=E||{border:!0,borderColor:"#ffffff",borderWidth:4},ie={};return Y.border&&(ie.border=`${Y.borderWidth||4}px solid ${Y.borderColor||"#ffffff"}`),ie},Zr=E=>{We(Y=>({...Y,avatarStyle:E}))},Kr=()=>{Kt(S.name),Qe("name"),setTimeout(()=>{var E;return(E=Qt.current)==null?void 0:E.focus()},10)},Xr=()=>{Jt(S.bio),Qe("bio"),setTimeout(()=>{var E;return(E=er.current)==null?void 0:E.focus()},10)},ar=()=>{It.trim()&&We(E=>({...E,name:It.trim()})),Qe(null)},Jr=()=>{We(E=>({...E,bio:Xt})),Qe(null)},qr=E=>{E.key==="Enter"?(E.preventDefault(),ar()):E.key==="Escape"&&Qe(null)},Qr=E=>{E.key==="Escape"&&Qe(null)};P.useEffect(()=>{try{localStorage.setItem("openbento_deploy_target",re)}catch{}},[re]);const ea=P.useCallback(async()=>{if(S){ae(!0),ee(null);try{await ws({profile:S,blocks:C},{siteId:B==null?void 0:B.id,deploymentTarget:re}),z(!0)}catch(E){const Y=E instanceof Error?E.message:"Export failed.";ee(Y),z(!1)}finally{ae(!1)}}},[S,C,B==null?void 0:B.id,re]),ta=P.useCallback(async()=>{var Y,ie;if(!S)return;const E=((ie=(Y=S.analytics)==null?void 0:Y.supabaseUrl)==null?void 0:ie.trim().replace(/\/+$/,""))||"";if(!E){Ae("Set your Supabase URL in Analytics settings.");return}if(!(B!=null&&B.id)){Ae("Missing siteId (active bento).");return}if(!he.trim()){Ae("Enter your admin token to view analytics.");return}W(!0),Ae(null);try{const se=`${E}/functions/v1/openbento-analytics-admin?siteId=${encodeURIComponent(B.id)}&days=${encodeURIComponent(String(ue))}`,me=await fetch(se,{headers:{"x-openbento-admin-token":he.trim()}}),fe=await me.json().catch(()=>({}));if(!me.ok){const ge=typeof(fe==null?void 0:fe.error)=="string"?fe.error:"Failed to load analytics.";throw new Error(ge)}Se(fe)}catch(se){const me=se instanceof Error?se.message:"Failed to load analytics.";Ae(me),Se(null)}finally{W(!1)}},[S,B==null?void 0:B.id,he,ue]),Rt=P.useCallback(E=>{try{const ie=new URL(E).hostname.toLowerCase();return ie.endsWith(".supabase.co")&&ie.split(".")[0]||""}catch{return""}},[]);P.useEffect(()=>{const E=Y=>{Y.target instanceof HTMLInputElement||Y.target instanceof HTMLTextAreaElement||((Y.metaKey||Y.ctrlKey)&&Y.key.toLowerCase()==="z"?Y.shiftKey?a():U():(Y.metaKey||Y.ctrlKey)&&Y.key.toLowerCase()==="y"&&a())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[U,a]),P.useEffect(()=>{var ie,se;if(!h)return;const E=((se=(ie=S==null?void 0:S.analytics)==null?void 0:ie.supabaseUrl)==null?void 0:se.trim())||"",Y=E?Rt(E):"";Y&&A(me=>me||Y)},[Rt,(sr=S==null?void 0:S.analytics)==null?void 0:sr.supabaseUrl,h]),P.useCallback(async()=>{},[he,We,S,V,M,D,b,oe]),P.useCallback(async()=>{},[he,Rt,S,b]),P.useEffect(()=>{try{sessionStorage.setItem("openbento_analytics_admin_token",he)}catch{}},[he]);const ra=()=>{n(null),i(!1)},aa=E=>{Je(E)},na=E=>{Oe&&Oe!==E&&(nt(E),st(null))},tt=()=>{Je(null),nt(null),st(null)},sa=E=>{if(!Oe||Oe===E){tt();return}const Y=C.findIndex(ve=>ve.id===Oe),ie=C.findIndex(ve=>ve.id===E);if(Y===-1||ie===-1){tt();return}const se=C[Y],me=C[ie];let fe=C.map(ve=>ve.id===se.id?{...ve,gridColumn:me.gridColumn,gridRow:me.gridRow}:ve);const ge=fe.find(ve=>ve.id===se.id),we=fe.filter(ve=>ve.id!==ge.id&&ks(ge,ve));we.length>0&&we.forEach(ve=>{const Re=_r(fe,[ve.id]),le=Bt(ve,Re);fe=fe.map(pe=>pe.id===ve.id?{...pe,gridColumn:le.col,gridRow:le.row}:pe)}),Ue(fe),tt()},nr=P.useCallback((E,Y)=>{const ie=Vt.current;if(!ie)return null;const se=ie.getBoundingClientRect(),me=window.getComputedStyle(ie),fe=parseFloat(me.columnGap||"0")||0,ge=parseFloat(me.rowGap||"0")||0,we=64,Re=Math.max(0,se.width-fe*(je-1))/je||1,le=E-se.left,pe=Y-se.top,_e=Ge(Math.ceil(le/(Re+fe)),1,je),De=Math.max(1,Math.ceil(pe/(we+ge)));return{col:_e,row:De}},[]),oa=P.useCallback((E,Y)=>{var we,ve;if(L!=="desktop"||!E.gridColumn||!E.gridRow)return;ot(E.id),tt(),Ct.current={blockId:E.id,startCol:E.gridColumn,startRow:E.gridRow,lastColSpan:E.colSpan,lastRowSpan:E.rowSpan};const ie=Y.currentTarget.closest("[data-block-id]");ie&&ie.setAttribute("draggable","false");const se=document.body.style.cursor,me=document.body.style.userSelect;document.body.style.cursor="nwse-resize",document.body.style.userSelect="none";const fe=Re=>{const le=Ct.current;if(!le)return;Re.preventDefault();const pe=nr(Re.clientX,Re.clientY);if(!pe)return;const _e=pe.col-le.startCol+1,De=pe.row-le.startRow+1;_e===le.lastColSpan&&De===le.lastRowSpan||(le.lastColSpan=_e,le.lastRowSpan=De,Ue(Pe=>js(Pe,le.blockId,_e,De)))},ge=()=>{window.removeEventListener("pointermove",fe),window.removeEventListener("pointerup",ge),window.removeEventListener("pointercancel",ge),Ct.current=null,ot(null),document.body.style.cursor=se,document.body.style.userSelect=me};window.addEventListener("pointermove",fe,{passive:!1}),window.addEventListener("pointerup",ge,{passive:!0}),window.addEventListener("pointercancel",ge,{passive:!0});try{(ve=(we=Y.currentTarget).setPointerCapture)==null||ve.call(we,Y.pointerId)}catch{}},[nr,Ue,L]),ia=C.find(E=>E.id===l)||null;if(F||!S)return e.jsx("div",{className:"min-h-screen bg-[#F7F7F7] flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading..."})});if(!S)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."});const la=S.backgroundImage?{backgroundImage:`url(${S.backgroundImage})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"}:S.backgroundColor?{backgroundColor:S.backgroundColor}:{backgroundColor:"#f9fafb"};return e.jsxs("div",{className:"min-h-screen flex font-sans overflow-x-hidden relative",style:la,children:[S.backgroundImage&&S.backgroundBlur&&S.backgroundBlur>0&&e.jsx("div",{className:"absolute inset-0 z-0",style:{backdropFilter:`blur(${S.backgroundBlur}px)`,WebkitBackdropFilter:`blur(${S.backgroundBlur}px)`}}),e.jsxs("div",{className:"flex-1 relative min-h-screen z-10",children:[e.jsx("nav",{className:"fixed top-4 left-4 right-4 z-40 pointer-events-none",children:e.jsxs("div",{className:"max-w-[1800px] mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"bg-white px-2 py-2 rounded-2xl shadow-sm border border-gray-200 flex gap-2 items-center pointer-events-auto select-none",children:[$&&e.jsx("button",{type:"button","aria-label":"Back to home",onClick:$,className:"w-9 h-9 bg-gray-900 text-white rounded-xl flex items-center justify-center hover:bg-black transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Back to Home",children:e.jsx(_a,{size:16})}),e.jsx("span",{className:"font-bold text-gray-800 tracking-tight px-1",children:"OpenBento"}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),B&&e.jsx(En,{activeBentoId:B.id,activeBentoName:B.name,onBentoChange:Pr}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),e.jsx("button",{type:"button","aria-label":"Save (Ctrl+S)",onClick:At,disabled:ft==="saving",className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 hover:bg-gray-100 disabled:opacity-50",title:"Save (Ctrl+S)",children:ft==="saving"?e.jsxs(e.Fragment,{children:[e.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-violet-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-600",children:"Saving..."})]}):ft==="saved"?e.jsxs(e.Fragment,{children:[e.jsx(kt,{size:16,className:"text-green-500"}),e.jsx("span",{className:"text-green-600",children:"Saved!"})]}):ft==="error"?e.jsxs(e.Fragment,{children:[e.jsx(Ht,{size:16,className:"text-red-500"}),e.jsx("span",{className:"text-red-600",children:"Error"})]}):e.jsxs(e.Fragment,{children:[e.jsx(gn,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"text-gray-500",children:Ur?Mr:"Not saved"})]})}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),e.jsxs("div",{className:"flex bg-gray-100/80 p-1 rounded-xl gap-0.5",children:[e.jsx("button",{type:"button","aria-label":"Desktop view","aria-pressed":L==="desktop",onClick:()=>Z("desktop"),className:`p-2 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 ${L==="desktop"?"bg-white shadow-sm text-gray-900":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(Na,{size:16})}),e.jsx("button",{type:"button","aria-label":"Mobile view","aria-pressed":L==="mobile",onClick:()=>Z("mobile"),className:`p-2 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 ${L==="mobile"?"bg-white shadow-sm text-gray-900":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(Ca,{size:16})})]})]}),e.jsxs("div",{className:"flex gap-2 pointer-events-auto",children:[e.jsxs("button",{type:"button","aria-label":s?"Switch to preview mode":"Switch to edit mode",onClick:()=>i(!s),className:"bg-white px-3.5 py-2 rounded-lg shadow-sm border border-gray-200 text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s?e.jsx(Ia,{size:16}):e.jsx(un,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:s?"Preview":"Edit"})]}),e.jsxs("button",{type:"button","aria-label":"Open settings",onClick:()=>p(!0),className:"bg-white px-3.5 py-2 rounded-lg shadow-sm border border-gray-200 text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Open settings",children:[e.jsx(Rr,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]}),!1,((or=S==null?void 0:S.analytics)==null?void 0:or.enabled)&&e.jsxs("a",{href:"/analytics","aria-label":"View analytics dashboard",className:"bg-white px-3.5 py-2 rounded-lg shadow-sm border border-gray-200 text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"View analytics dashboard",children:[e.jsx($t,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]}),e.jsxs("button",{onClick:()=>I(!0),className:"bg-gradient-to-r from-violet-500 to-purple-600 text-white px-3.5 py-2 rounded-lg shadow-sm hover:from-violet-600 hover:to-purple-700 transition-all text-xs font-semibold flex items-center gap-2",title:"Generate with AI",children:[e.jsx(yt,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"AI"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-200 pr-3 mr-1",children:[e.jsx("button",{type:"button","aria-label":"Export as JSON",onClick:Br,className:"p-2 rounded-lg text-gray-500 hover:text-gray-900 hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Export as JSON",children:e.jsx(Xa,{size:16})}),e.jsxs("label",{"aria-label":"Import JSON file",className:"p-2 rounded-lg text-gray-500 hover:text-gray-900 hover:bg-gray-100 transition-colors cursor-pointer focus-within:ring-2 focus-within:ring-blue-500",title:"Import JSON",children:[e.jsx(ut,{size:16}),e.jsx("input",{type:"file",accept:".json,application/json","aria-label":"Import JSON file",onChange:Hr,className:"hidden"})]})]}),e.jsxs("button",{type:"button","aria-label":"Deploy project",onClick:$r,className:"bg-gray-900 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-black transition-colors text-xs font-semibold flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(Dt,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Deploy"})]})]})]})}),L==="desktop"&&e.jsx("div",{className:"hidden lg:flex fixed left-0 top-0 w-[420px] h-screen flex-col justify-center items-start px-12 z-10",children:e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col items-start text-left",children:[e.jsxs("div",{className:"relative group mb-8",children:[e.jsxs(Ee.div,{whileHover:{scale:1.02},className:Yr(S.avatarStyle),style:Vr(S.avatarStyle),children:[S.avatarUrl?e.jsx("img",{src:S.avatarUrl,alt:S.name,className:Wr(S.avatarStyle)}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-4xl font-bold",children:S.name.charAt(0)}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[e.jsx("button",{type:"button","aria-label":"Change avatar image",onClick:E=>{var Y;E.stopPropagation(),(Y=qt.current)==null||Y.click()},className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-colors focus:outline-none focus:ring-2 focus:ring-white",title:"Change image",children:e.jsx(Aa,{size:22,className:"text-white"})}),e.jsx("button",{type:"button","aria-label":"Edit avatar style",onClick:E=>{E.stopPropagation(),x(!0)},className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-colors focus:outline-none focus:ring-2 focus:ring-white",title:"Edit style",children:e.jsx(Er,{size:22,className:"text-white"})})]})]}),e.jsx("input",{ref:qt,type:"file",accept:"image/*",onChange:Gr,className:"hidden"})]}),e.jsxs("div",{className:"space-y-3 w-full max-w-xs",children:[Zt==="name"?e.jsx("input",{ref:Qt,type:"text","aria-label":"Edit your name",value:It,onChange:E=>Kt(E.target.value),onBlur:ar,onKeyDown:qr,className:"text-4xl font-bold tracking-tight text-gray-900 bg-transparent border-b-2 border-violet-500 outline-none w-full leading-[1.1]",placeholder:"Your name"}):e.jsxs("div",{className:"group cursor-pointer flex items-center gap-2",onClick:Kr,children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight text-gray-900 group-hover:text-violet-600 transition-colors leading-[1.1]",children:S.name}),e.jsx(yr,{size:16,className:"text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity"})]}),Zt==="bio"?e.jsx("textarea",{ref:er,"aria-label":"Edit your bio",value:Xt,onChange:E=>Jt(E.target.value),onBlur:Jr,onKeyDown:Qr,className:"text-base text-gray-600 font-medium leading-relaxed bg-transparent border-b-2 border-violet-500 outline-none w-full resize-none",rows:3,placeholder:"Write something about yourself..."}):e.jsxs("p",{className:"group text-base text-gray-500 font-medium leading-relaxed whitespace-pre-wrap cursor-pointer hover:text-gray-700 transition-colors flex items-start gap-2",onClick:Xr,children:[e.jsx("span",{className:"flex-1",children:S.bio||"Click to add bio..."}),e.jsx(yr,{size:14,className:"text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity mt-1 shrink-0"})]}),S.showSocialInHeader&&S.socialAccounts&&S.socialAccounts.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 mt-4",children:S.socialAccounts.map(E=>{const Y=Le(E.platform);if(!Y)return null;const ie=Y.brandIcon,se=Y.icon,me=$e(E.platform,E.handle),fe=S.showFollowerCount&&E.followerCount;return e.jsxs("a",{href:me,target:"_blank",rel:"noopener noreferrer",className:`${fe?"px-3 py-2 rounded-full":"w-10 h-10 rounded-full"} bg-white shadow-md flex items-center justify-center gap-2 hover:scale-105 hover:shadow-lg transition-all`,title:Y.label,children:[ie?e.jsx("span",{style:{color:Y.brandColor},children:e.jsx(ie,{size:20})}):e.jsx("span",{className:"text-gray-600",children:e.jsx(se,{size:20})}),fe&&e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:Ft(E.followerCount)})]},E.platform)})})]})]})}),e.jsx("div",{className:"w-full min-h-screen",children:e.jsx("div",{className:"max-w-[1600px] mx-auto",children:e.jsx("div",{className:`p-4 lg:p-12 pt-24 lg:pt-24 transition-all duration-300 ${L==="desktop"?"lg:ml-[420px]":""} ${L==="mobile"?"flex justify-center items-start min-h-screen bg-gray-100/50":""}`,children:L==="mobile"?(()=>{const E=[...C].sort((ge,we)=>{const ve=ge.gridRow??999,Re=we.gridRow??999,le=ge.gridColumn??999,pe=we.gridColumn??999;return ve!==Re?ve-Re:le-pe}),Y=S.avatarStyle||{shape:"rounded",shadow:!0,border:!0,borderColor:"#ffffff",borderWidth:4},ie=Y.shape==="circle"?"9999px":Y.shape==="square"?"0":"1.5rem",se=Y.shadow!==!1?"0 25px 50px -12px rgba(0,0,0,0.15)":"none",me=Y.border!==!1?`${Y.borderWidth||4}px solid ${Y.borderColor||"#ffffff"}`:"none",fe=S.backgroundImage?{backgroundImage:`url('${S.backgroundImage}')`,backgroundSize:"cover",backgroundPosition:"center"}:{background:S.backgroundColor||"#f8fafc"};return e.jsxs("div",{className:"mockup-phone border-gray-800 border-[14px] rounded-[3rem] h-[800px] w-[375px] shadow-2xl bg-white overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-32 h-6 bg-gray-800 rounded-b-xl z-20"}),e.jsxs("div",{className:"h-full w-full overflow-y-auto no-scrollbar relative",style:fe,children:[S.backgroundImage&&S.backgroundBlur&&S.backgroundBlur>0&&e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backdropFilter:`blur(${S.backgroundBlur}px)`,WebkitBackdropFilter:`blur(${S.backgroundBlur}px)`}}),e.jsxs("div",{className:"p-4 pt-8 flex flex-col items-center text-center relative z-10",children:[e.jsx("div",{className:"w-24 h-24 mb-4 overflow-hidden bg-gray-100 transition-all duration-300",style:{borderRadius:ie,boxShadow:se,border:me},children:e.jsx("img",{src:S.avatarUrl,alt:"Avatar",className:"w-full h-full object-cover"})}),e.jsx("h1",{className:"text-2xl font-extrabold tracking-tight text-gray-900 leading-none mb-2",children:S.name}),e.jsx("p",{className:"text-sm text-gray-500 font-medium whitespace-pre-wrap max-w-xs leading-relaxed",children:S.bio}),S.showSocialInHeader&&S.socialAccounts&&S.socialAccounts.length>0&&e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-4",children:S.socialAccounts.map(ge=>{const we=Le(ge.platform);if(!we)return null;const ve=we.brandIcon,Re=we.icon,le=$e(ge.platform,ge.handle),pe=S.showFollowerCount&&ge.followerCount;return e.jsxs("a",{href:le,target:"_blank",rel:"noopener noreferrer",className:`${pe?"px-3 py-2":"w-10 h-10"} bg-white rounded-full shadow-md flex items-center justify-center gap-2 font-semibold text-gray-900 transition-transform hover:-translate-y-0.5`,title:we.label,children:[ve?e.jsx("span",{style:{color:we.brandColor},children:e.jsx(ve,{size:20})}):e.jsx("span",{className:"text-gray-600",children:e.jsx(Re,{size:20})}),pe&&e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Ft(ge.followerCount)})]},ge.platform)})})]}),e.jsx("div",{className:"p-4 relative z-10",children:e.jsx("div",{className:"grid pb-8",style:{gridTemplateColumns:`repeat(${Ot.columns}, 1fr)`,gridAutoRows:`${Ot.rowHeight}px`,gap:`${Ot.gap}px`},children:E.map(ge=>{const we=Ea(ge);return e.jsx("div",{className:"pointer-events-none",style:{gridColumn:`span ${we.colSpan}`,gridRow:`span ${we.rowSpan}`},children:e.jsx(vr,{block:ge,isSelected:!1,onEdit:()=>{},onDelete:()=>{},onDragStart:()=>{},onDragEnter:()=>{},onDragEnd:()=>{},onDrop:()=>{},enableTiltEffect:!0})},ge.id)})})}),S.showBranding!==!1&&e.jsx("div",{className:"w-full py-6 text-center text-sm text-gray-500 font-medium",children:e.jsxs("p",{className:"inline-flex items-center gap-1",children:["Made with ",e.jsx("span",{className:"text-red-400",children:"♥"})," using"," ",e.jsx("span",{className:"font-semibold",children:"OpenBento"})]})})]})]})})():e.jsx(e.Fragment,{children:(()=>{const E=new Set,Y=C.map(le=>{if(le.gridColumn!==void 0&&le.gridRow!==void 0){for(let pe=le.gridColumn;pe<le.gridColumn+Math.min(le.colSpan,je-le.gridColumn+1);pe++)for(let _e=le.gridRow;_e<le.gridRow+le.rowSpan;_e++)E.add(`${pe}-${_e}`);return le}return le});let ie=1,se=1;const me=Y.map(le=>{if(le.gridColumn===void 0||le.gridRow===void 0)for(;;){let pe=!0;const _e=Math.min(le.colSpan,je);for(let De=se;De<se+_e&&pe;De++)for(let Pe=ie;Pe<ie+le.rowSpan&&pe;Pe++)(De>je||E.has(`${De}-${Pe}`))&&(pe=!1);if(pe){for(let Pe=se;Pe<se+_e;Pe++)for(let it=ie;it<ie+le.rowSpan;it++)E.add(`${Pe}-${it}`);const De={...le,gridColumn:se,gridRow:ie};return se+=_e,se>je&&(se=1,ie++),De}else se++,se>je&&(se=1,ie++)}return le});let fe=3;me.forEach(le=>{le.gridRow!==void 0&&(fe=Math.max(fe,le.gridRow+le.rowSpan-1))});const ge=fe+3+Ke,we=[];for(let le=1;le<=ge;le++)for(let pe=1;pe<=je;pe++)E.has(`${pe}-${le}`)||we.push({col:pe,row:le});const ve=(le,pe)=>{if(!Oe)return;const _e=C.findIndex(zt=>zt.id===Oe);if(_e===-1)return;const De=C[_e],Pe=Math.max(1,Math.min(le,je-De.colSpan+1)),it=Math.max(1,pe),ca={...De,gridColumn:Pe,gridRow:it},da=[...C.filter(zt=>zt.id!==De.id),ca];Ue(da),tt()},Re=(le,pe)=>{Oe||(n(null),i(!0),sessionStorage.setItem("pendingBlockPosition",JSON.stringify({col:le,row:pe})))};return e.jsxs(Ee.main,{ref:Vt,role:"main","aria-label":"Bento grid editor",layout:!0,className:"grid gap-2",style:{gridTemplateColumns:"repeat(9, 1fr)",gridAutoRows:"64px"},children:[e.jsx(Ze,{children:me.map((le,pe)=>e.jsx(vr,{block:{...le,zIndex:pe+1},isSelected:l===le.id,isDragTarget:Me===le.id,isDragging:Oe===le.id,enableResize:L==="desktop",isResizing:Nt===le.id,onResizeStart:oa,onEdit:_e=>{n(_e.id),i(!0)},onDelete:rr,onDragStart:aa,onDragEnter:na,onDragEnd:tt,onDrop:sa,onDuplicate:Et,onInlineUpdate:tr},le.id))}),we.map(({col:le,row:pe})=>e.jsx(Ee.div,{role:"button",tabIndex:0,"aria-label":`Add block at column ${le}, row ${pe}`,initial:{opacity:0},animate:{opacity:1},style:{gridColumnStart:le,gridRowStart:pe},onDragEnter:()=>st(le*100+pe),onDragOver:_e=>_e.preventDefault(),onDrop:_e=>{_e.preventDefault(),ve(le,pe)},onClick:()=>Re(le,pe),onKeyDown:_e=>{(_e.key==="Enter"||_e.key===" ")&&(_e.preventDefault(),Re(le,pe))},className:`border border-dashed rounded-md flex items-center justify-center transition-all duration-200 group cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${Oe?ht===le*100+pe?"border-violet-500 bg-violet-100 scale-[1.02]":"border-gray-300 bg-gray-50/50 hover:border-violet-400 hover:bg-violet-50":"border-gray-200 bg-gray-50/30 hover:border-gray-300 hover:bg-gray-100/50"}`,children:Oe?e.jsx(Xe,{size:14,className:ht===le*100+pe?"text-violet-500":"text-gray-400"}):e.jsx(Xe,{size:12,className:"text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity"})},`empty-${le}-${pe}`)),e.jsxs(Ee.button,{type:"button","aria-label":"Add more rows to grid",onClick:()=>qe(le=>le+3),style:{gridColumn:"1 / -1",gridRow:ge+1},className:"h-12 border-2 border-dashed border-gray-200 rounded-xl flex items-center justify-center gap-2 text-gray-400 hover:border-violet-400 hover:text-violet-500 hover:bg-violet-50/50 transition-all group focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx(Xe,{size:18,className:"group-hover:rotate-90 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Add more rows"})]})]})})()})})})}),L==="desktop"&&S.showBranding!==!1&&e.jsx("footer",{className:"w-full py-10 text-center",children:e.jsxs("p",{className:"text-sm text-gray-400 font-medium",children:["Made with ",e.jsx("span",{className:"text-red-400",children:"♥"})," using"," ",e.jsx("a",{href:"https://github.com/yoanbernabeu/openbento",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 font-semibold hover:text-violet-500 transition-colors",children:"OpenBento"})]})})]}),e.jsx(An,{isOpen:s,profile:S,addBlock:Fr,editingBlock:ia,updateBlock:tr,onDelete:rr,closeEdit:ra}),e.jsx(Rn,{isOpen:o,onClose:()=>p(!1),profile:S,setProfile:We,bentoName:B==null?void 0:B.name,onBentoNameChange:E=>{B&&(t({...B,name:E}),Ra(B.id,E))},blocks:C,setBlocks:Ue}),e.jsx(Dr,{isOpen:c&&!!N,src:N||"",title:"Crop profile photo",onCancel:()=>{f(!1),H(null)},onConfirm:E=>{We(Y=>({...Y,avatarUrl:E})),f(!1),H(null)}}),e.jsx(Ln,{isOpen:d,onClose:()=>x(!1),avatarUrl:S.avatarUrl,style:S.avatarStyle||{shape:"rounded",shadow:!0,border:!0,borderColor:"#ffffff",borderWidth:4},onStyleChange:Zr}),e.jsx(Un,{isOpen:j,onClose:()=>I(!1),onBentoImported:E=>{t(E),We(E.data.profile),Ue(E.data.blocks),y(E.data.gridVersion??Fe)}}),e.jsx(Ze,{children:u&&e.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs(Ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white rounded-2xl shadow-2xl max-w-xl w-full overflow-hidden ring-1 ring-gray-900/5",children:[e.jsxs("div",{className:"p-6 pb-4 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-9 h-9 bg-green-100 rounded-full flex items-center justify-center text-green-700 mb-3",children:e.jsx(zr,{size:18})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Deploy"}),e.jsxs("p",{className:"text-gray-500 mt-1 text-sm",children:["Download the package, then follow ",e.jsx("code",{children:"DEPLOY.md"})," inside."]})]}),e.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors",children:e.jsx(Ye,{size:20})})]}),e.jsxs("div",{className:"px-6 space-y-4 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-3 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Deployment target"}),e.jsxs("select",{value:re,onChange:E=>{G(E.target.value),z(!1),ee(null)},className:"w-full bg-white border border-gray-200 rounded-xl px-3 py-2.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-semibold text-gray-800",children:[e.jsx("option",{value:"vercel",children:"Vercel"}),e.jsx("option",{value:"netlify",children:"Netlify"}),e.jsx("option",{value:"docker",children:"Docker (nginx)"}),e.jsx("option",{value:"vps",children:"VPS (nginx)"}),e.jsx("option",{value:"heroku",children:"Heroku"}),e.jsx("option",{value:"github-pages",children:"GitHub Pages"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-100 flex gap-3 items-center",children:[e.jsx("div",{className:"bg-white p-2 rounded-full shadow-sm border border-gray-100 text-gray-700",children:T?e.jsx(bt,{size:20,className:"animate-spin"}):q?e.jsx(kt,{size:20,className:"text-green-600"}):e.jsx(Dt,{size:20})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm leading-tight",children:T?"Packaging…":q?"Package downloaded":"Download package"}),e.jsx("p",{className:"text-gray-500 text-xs break-all",children:e.jsx("code",{children:`${S.name.replace(/\s+/g,"-").toLowerCase()}-bento-${re}.zip`})})]})]})]}),ne&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-xl p-3 text-sm text-red-700 font-semibold",children:ne})]}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:ea,disabled:T,className:"w-full sm:flex-1 py-3 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[T?e.jsx(bt,{size:16,className:"animate-spin"}):e.jsx(Dt,{size:16}),q?"Download again":"Download package"]}),e.jsx("button",{onClick:()=>m(!1),className:"w-full sm:flex-1 py-3 bg-white text-gray-900 rounded-xl font-bold border border-gray-200 hover:bg-gray-50 transition-colors",children:"Close"})]})})]})})}),e.jsx(Ze,{children:h&&e.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs(Ee.div,{initial:{scale:.95,opacity:0,y:16},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:16},className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden ring-1 ring-gray-900/5",children:[e.jsxs("div",{className:"p-6 pb-4 flex justify-between items-start border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-9 h-9 bg-violet-100 rounded-full flex items-center justify-center text-violet-700 mb-3",children:e.jsx($t,{size:18})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Analytics"}),e.jsxs("p",{className:"text-gray-500 mt-1 text-sm",children:["Site ID: ",e.jsx("span",{className:"font-mono text-xs",children:(B==null?void 0:B.id)||"—"})]})]}),e.jsx("button",{type:"button","aria-label":"Close analytics modal",onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-full text-gray-500 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.jsx(Ye,{size:20})})]}),e.jsxs("div",{className:"p-6 pt-4 space-y-5 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Supabase"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL is used for tracking + dashboard. Analytics is enabled on export when the URL is set."})]}),e.jsx("button",{type:"button",onClick:()=>We(E=>{var Y;return{...E,analytics:{...E.analytics??{},enabled:!(((Y=E.analytics)==null?void 0:Y.enabled)??!1)}}}),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors ${(ir=S.analytics)!=null&&ir.enabled?"bg-gray-900":"bg-gray-200"}`,"aria-pressed":!!((lr=S.analytics)!=null&&lr.enabled),"aria-label":"Toggle analytics",children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${(cr=S.analytics)!=null&&cr.enabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("input",{type:"text","aria-label":"Supabase project URL",value:((dr=S.analytics)==null?void 0:dr.supabaseUrl)||"",onChange:E=>We(Y=>({...Y,analytics:{...Y.analytics??{},supabaseUrl:E.target.value}})),className:"flex-1 bg-white border border-gray-200 rounded-xl p-2.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium text-gray-700",placeholder:"https://xxxx.supabase.co"}),!1]}),!1]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 border border-gray-100 rounded-xl p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Admin Token"}),e.jsxs("button",{onClick:ta,disabled:r,className:"px-3 py-2 rounded-xl bg-gray-900 text-white text-xs font-bold hover:bg-black disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(bt,{size:14,className:r?"animate-spin":""}),"Refresh"]})]}),e.jsx("input",{type:"password",value:he,onChange:E=>ye(E.target.value),placeholder:"OPENBENTO_ANALYTICS_ADMIN_TOKEN",className:"w-full bg-white border border-gray-200 rounded-xl p-2.5 focus:ring-2 focus:ring-black/5 focus:border-black focus:outline-none transition-all font-medium text-gray-700"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Range"}),e.jsxs("select",{value:ue,onChange:E=>Ce(Number(E.target.value)),className:"bg-white border border-gray-200 rounded-xl px-3 py-2 text-sm font-semibold text-gray-700",children:[e.jsx("option",{value:7,children:"Last 7 days"}),e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:90,children:"Last 90 days"})]}),(xe==null?void 0:xe.sampled)&&e.jsxs("span",{className:"ml-auto inline-flex items-center gap-2 text-xs font-semibold text-amber-700 bg-amber-50 border border-amber-200 rounded-full px-3 py-1",children:[e.jsx(Or,{size:14}),"Sampled"]})]}),e.jsxs("p",{className:"text-[11px] text-gray-400",children:["This dashboard reads from the ",e.jsx("code",{children:"openbento-analytics-admin"})," Edge Function using your admin token."]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Totals"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Page views"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:((ur=xe==null?void 0:xe.totals)==null?void 0:ur.pageViews)??"—"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Clicks"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:((hr=xe==null?void 0:xe.totals)==null?void 0:hr.clicks)??"—"})]})]})]})]}),Te&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-xl p-3 text-sm text-red-700 font-semibold",children:Te}),xe&&!Te&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Top destinations"}),e.jsx("div",{className:"space-y-2",children:(xe.topDestinations||[]).length===0?e.jsx("p",{className:"text-sm text-gray-400",children:"No clicks yet."}):xe.topDestinations.map(E=>e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("p",{className:"text-xs font-mono text-gray-700 break-all",children:E.key}),e.jsx("span",{className:"text-xs font-bold text-gray-900 shrink-0",children:E.clicks})]},E.key))})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Top referrers"}),e.jsx("div",{className:"space-y-2",children:(xe.topReferrers||[]).length===0?e.jsx("p",{className:"text-sm text-gray-400",children:"No referrers yet."}):xe.topReferrers.map(E=>e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("p",{className:"text-xs font-mono text-gray-700 break-all",children:E.host}),e.jsx("span",{className:"text-xs font-bold text-gray-900 shrink-0",children:E.pageViews})]},E.host))})]})]})]}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>g(!1),className:"w-full py-3 bg-gray-900 text-white rounded-xl font-bold hover:bg-black transition-colors",children:"Close"})})]})})})]})};export{Ns as default};
